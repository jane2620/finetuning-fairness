start finetuning: seed  43
2025-05-01 15:34:09.302370: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 15:34:09.462297: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746128049.536140  297150 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746128049.552348  297150 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746128049.678341  297150 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746128049.678381  297150 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746128049.678383  297150 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746128049.678385  297150 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 15:34:09.684207: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
=== Fine-tuning Configuration ===
Model: 
Training dataset: 
Random seed: 36
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: 
===========================
CUDA available: True
CUDA device count: 1
CUDA current device: 0
CUDA device name: NVIDIA A100 80GB PCIe MIG 3g.40gb
train_config(model_name='meta-llama/Llama-3.2-3B-Instruct', enable_fsdp=False, low_cpu_fsdp=False, run_validation=True, batch_size_training=4, gradient_accumulation_steps=1, num_epochs=1, num_workers_dataloader=1, lr=2e-05, weight_decay=0.0, gamma=0.85, seed=43, use_fp16=False, mixed_precision=True, val_batch_size=1, peft_method='lora', use_peft=False, output_dir='../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_constant_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_43', freeze_layers=False, num_freeze_layers=1, quantization=True, one_gpu=False, save_model=True, save_every_epoch=True, dist_checkpoint_root_folder='fsdp', dist_checkpoint_folder='fine-tuned', save_optimizer=False, use_fast_kernels=False, use_lora=True, save_full_gradients=False, system_message='You are a helpful assistant. Provide your best guess or estimate given the scenario. Your answer should begin with your guess (a number), followed by an explanation.', ft_dataset_name='no_bias_constant_var_prop_rep', dataset='datasets/ft/no_bias_constant_var_prop_rep.jsonl', eval_dataset_name='bbq_subset_100', eval_dataset=None, eval_output_file=None, base_output_file=None)
Clearing GPU cache
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.78s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  3.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.38s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Applying LoRA adapter...
trainable params: 2,293,760 || all params: 3,215,046,656 || trainable%: 0.0713
Loading data from datasets/ft/no_bias_constant_var_prop_rep.jsonl...
Using all 1642 examples from dataset
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 23125.64 examples/s]
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map:  61%|██████    | 1000/1642 [00:00<00:00, 2347.45 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2375.55 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2347.40 examples/s]
/home/janeec/FairTune/finetune_w_eval_llama.py:297: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
=== Fine-tuning Configuration ===
Model: meta-llama/Llama-3.2-3B-Instruct
Training dataset: datasets/ft/no_bias_constant_var_prop_rep.jsonl
Random seed: 43
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_constant_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_43
===========================
SEED CHECK:, should be: 43, seed is: 43
Starting fine-tuning...
  0%|          | 0/411 [00:00<?, ?it/s]  0%|          | 1/411 [00:01<11:39,  1.71s/it]  0%|          | 2/411 [00:03<10:09,  1.49s/it]  1%|          | 3/411 [00:04<09:37,  1.42s/it]  1%|          | 4/411 [00:05<09:21,  1.38s/it]  1%|          | 5/411 [00:07<09:12,  1.36s/it]  1%|▏         | 6/411 [00:08<09:06,  1.35s/it]  2%|▏         | 7/411 [00:09<09:02,  1.34s/it]  2%|▏         | 8/411 [00:11<08:58,  1.34s/it]  2%|▏         | 9/411 [00:12<08:56,  1.33s/it]  2%|▏         | 10/411 [00:13<08:53,  1.33s/it]  3%|▎         | 11/411 [00:14<08:52,  1.33s/it]  3%|▎         | 12/411 [00:16<08:50,  1.33s/it]  3%|▎         | 13/411 [00:17<08:48,  1.33s/it]  3%|▎         | 14/411 [00:18<08:47,  1.33s/it]  4%|▎         | 15/411 [00:20<08:45,  1.33s/it]  4%|▍         | 16/411 [00:21<08:44,  1.33s/it]  4%|▍         | 17/411 [00:22<08:42,  1.33s/it]  4%|▍         | 18/411 [00:24<08:41,  1.33s/it]  5%|▍         | 19/411 [00:25<08:40,  1.33s/it]  5%|▍         | 20/411 [00:26<08:38,  1.33s/it]  5%|▌         | 21/411 [00:28<08:37,  1.33s/it]  5%|▌         | 22/411 [00:29<08:36,  1.33s/it]  6%|▌         | 23/411 [00:30<08:35,  1.33s/it]  6%|▌         | 24/411 [00:32<08:33,  1.33s/it]  6%|▌         | 25/411 [00:33<08:32,  1.33s/it]  6%|▋         | 26/411 [00:34<08:30,  1.33s/it]  7%|▋         | 27/411 [00:36<08:29,  1.33s/it]  7%|▋         | 28/411 [00:37<08:28,  1.33s/it]  7%|▋         | 29/411 [00:38<08:26,  1.33s/it]  7%|▋         | 30/411 [00:40<08:25,  1.33s/it]  8%|▊         | 31/411 [00:41<08:24,  1.33s/it]  8%|▊         | 32/411 [00:42<08:22,  1.33s/it]  8%|▊         | 33/411 [00:44<08:21,  1.33s/it]  8%|▊         | 34/411 [00:45<08:20,  1.33s/it]  9%|▊         | 35/411 [00:46<08:19,  1.33s/it]  9%|▉         | 36/411 [00:48<08:17,  1.33s/it]  9%|▉         | 37/411 [00:49<08:16,  1.33s/it]  9%|▉         | 38/411 [00:50<08:15,  1.33s/it]  9%|▉         | 39/411 [00:52<08:13,  1.33s/it] 10%|▉         | 40/411 [00:53<08:12,  1.33s/it] 10%|▉         | 41/411 [00:54<08:10,  1.33s/it] 10%|█         | 42/411 [00:56<08:09,  1.33s/it] 10%|█         | 43/411 [00:57<08:08,  1.33s/it] 11%|█         | 44/411 [00:58<08:07,  1.33s/it] 11%|█         | 45/411 [01:00<08:06,  1.33s/it] 11%|█         | 46/411 [01:01<08:04,  1.33s/it] 11%|█▏        | 47/411 [01:02<08:03,  1.33s/it] 12%|█▏        | 48/411 [01:04<08:02,  1.33s/it] 12%|█▏        | 49/411 [01:05<08:00,  1.33s/it] 12%|█▏        | 50/411 [01:06<07:59,  1.33s/it] 12%|█▏        | 51/411 [01:08<07:57,  1.33s/it] 13%|█▎        | 52/411 [01:09<07:56,  1.33s/it] 13%|█▎        | 53/411 [01:10<07:55,  1.33s/it] 13%|█▎        | 54/411 [01:12<07:53,  1.33s/it] 13%|█▎        | 55/411 [01:13<07:52,  1.33s/it] 14%|█▎        | 56/411 [01:14<07:51,  1.33s/it] 14%|█▍        | 57/411 [01:16<07:49,  1.33s/it] 14%|█▍        | 58/411 [01:17<07:48,  1.33s/it] 14%|█▍        | 59/411 [01:18<07:47,  1.33s/it] 15%|█▍        | 60/411 [01:20<07:45,  1.33s/it] 15%|█▍        | 61/411 [01:21<07:44,  1.33s/it] 15%|█▌        | 62/411 [01:22<07:43,  1.33s/it] 15%|█▌        | 63/411 [01:23<07:41,  1.33s/it] 16%|█▌        | 64/411 [01:25<07:40,  1.33s/it] 16%|█▌        | 65/411 [01:26<07:39,  1.33s/it] 16%|█▌        | 66/411 [01:27<07:37,  1.33s/it] 16%|█▋        | 67/411 [01:29<07:36,  1.33s/it] 17%|█▋        | 68/411 [01:30<07:35,  1.33s/it] 17%|█▋        | 69/411 [01:31<07:33,  1.33s/it] 17%|█▋        | 70/411 [01:33<07:32,  1.33s/it] 17%|█▋        | 71/411 [01:34<07:30,  1.33s/it] 18%|█▊        | 72/411 [01:35<07:29,  1.33s/it] 18%|█▊        | 73/411 [01:37<07:28,  1.33s/it] 18%|█▊        | 74/411 [01:38<07:27,  1.33s/it] 18%|█▊        | 75/411 [01:39<07:25,  1.33s/it] 18%|█▊        | 76/411 [01:41<07:24,  1.33s/it] 19%|█▊        | 77/411 [01:42<07:23,  1.33s/it] 19%|█▉        | 78/411 [01:43<07:21,  1.33s/it] 19%|█▉        | 79/411 [01:45<07:20,  1.33s/it] 19%|█▉        | 80/411 [01:46<07:19,  1.33s/it] 20%|█▉        | 81/411 [01:47<07:17,  1.33s/it] 20%|█▉        | 82/411 [01:49<07:16,  1.33s/it] 20%|██        | 83/411 [01:50<07:15,  1.33s/it] 20%|██        | 84/411 [01:51<07:13,  1.33s/it] 21%|██        | 85/411 [01:53<07:12,  1.33s/it] 21%|██        | 86/411 [01:54<07:11,  1.33s/it] 21%|██        | 87/411 [01:55<07:09,  1.33s/it] 21%|██▏       | 88/411 [01:57<07:08,  1.33s/it] 22%|██▏       | 89/411 [01:58<07:07,  1.33s/it] 22%|██▏       | 90/411 [01:59<07:05,  1.33s/it] 22%|██▏       | 91/411 [02:01<07:04,  1.33s/it] 22%|██▏       | 92/411 [02:02<07:03,  1.33s/it] 23%|██▎       | 93/411 [02:03<07:01,  1.33s/it] 23%|██▎       | 94/411 [02:05<07:00,  1.33s/it] 23%|██▎       | 95/411 [02:06<06:59,  1.33s/it] 23%|██▎       | 96/411 [02:07<06:57,  1.33s/it] 24%|██▎       | 97/411 [02:09<06:56,  1.33s/it] 24%|██▍       | 98/411 [02:10<06:55,  1.33s/it] 24%|██▍       | 99/411 [02:11<06:54,  1.33s/it] 24%|██▍       | 100/411 [02:13<06:52,  1.33s/it]                                                  24%|██▍       | 100/411 [02:13<06:52,  1.33s/it] 25%|██▍       | 101/411 [02:14<06:51,  1.33s/it] 25%|██▍       | 102/411 [02:15<06:50,  1.33s/it] 25%|██▌       | 103/411 [02:17<06:48,  1.33s/it] 25%|██▌       | 104/411 [02:18<06:47,  1.33s/it] 26%|██▌       | 105/411 [02:19<06:45,  1.33s/it] 26%|██▌       | 106/411 [02:21<06:44,  1.33s/it] 26%|██▌       | 107/411 [02:22<06:43,  1.33s/it] 26%|██▋       | 108/411 [02:23<06:41,  1.33s/it] 27%|██▋       | 109/411 [02:25<06:40,  1.33s/it] 27%|██▋       | 110/411 [02:26<06:39,  1.33s/it] 27%|██▋       | 111/411 [02:27<06:37,  1.33s/it] 27%|██▋       | 112/411 [02:29<06:36,  1.33s/it] 27%|██▋       | 113/411 [02:30<06:35,  1.33s/it] 28%|██▊       | 114/411 [02:31<06:34,  1.33s/it] 28%|██▊       | 115/411 [02:32<06:32,  1.33s/it] 28%|██▊       | 116/411 [02:34<06:31,  1.33s/it] 28%|██▊       | 117/411 [02:35<06:29,  1.33s/it] 29%|██▊       | 118/411 [02:36<06:28,  1.33s/it] 29%|██▉       | 119/411 [02:38<06:27,  1.33s/it] 29%|██▉       | 120/411 [02:39<06:25,  1.33s/it] 29%|██▉       | 121/411 [02:40<06:24,  1.33s/it] 30%|██▉       | 122/411 [02:42<06:23,  1.33s/it] 30%|██▉       | 123/411 [02:43<06:21,  1.33s/it] 30%|███       | 124/411 [02:44<06:20,  1.33s/it] 30%|███       | 125/411 [02:46<06:19,  1.33s/it] 31%|███       | 126/411 [02:47<06:17,  1.33s/it] 31%|███       | 127/411 [02:48<06:16,  1.33s/it] 31%|███       | 128/411 [02:50<06:15,  1.33s/it] 31%|███▏      | 129/411 [02:51<06:13,  1.33s/it] 32%|███▏      | 130/411 [02:52<06:12,  1.33s/it] 32%|███▏      | 131/411 [02:54<06:11,  1.33s/it] 32%|███▏      | 132/411 [02:55<06:09,  1.33s/it] 32%|███▏      | 133/411 [02:56<06:08,  1.33s/it] 33%|███▎      | 134/411 [02:58<06:07,  1.33s/it] 33%|███▎      | 135/411 [02:59<06:05,  1.33s/it] 33%|███▎      | 136/411 [03:00<06:04,  1.33s/it] 33%|███▎      | 137/411 [03:02<06:03,  1.33s/it] 34%|███▎      | 138/411 [03:03<06:01,  1.33s/it] 34%|███▍      | 139/411 [03:04<06:00,  1.33s/it] 34%|███▍      | 140/411 [03:06<05:59,  1.33s/it] 34%|███▍      | 141/411 [03:07<05:57,  1.33s/it] 35%|███▍      | 142/411 [03:08<05:56,  1.33s/it] 35%|███▍      | 143/411 [03:10<05:55,  1.33s/it] 35%|███▌      | 144/411 [03:11<05:54,  1.33s/it] 35%|███▌      | 145/411 [03:12<05:52,  1.33s/it] 36%|███▌      | 146/411 [03:14<05:51,  1.33s/it] 36%|███▌      | 147/411 [03:15<05:50,  1.33s/it] 36%|███▌      | 148/411 [03:16<05:48,  1.33s/it] 36%|███▋      | 149/411 [03:18<05:47,  1.33s/it] 36%|███▋      | 150/411 [03:19<05:46,  1.33s/it] 37%|███▋      | 151/411 [03:20<05:44,  1.33s/it] 37%|███▋      | 152/411 [03:22<05:43,  1.33s/it] 37%|███▋      | 153/411 [03:23<05:42,  1.33s/it] 37%|███▋      | 154/411 [03:24<05:40,  1.33s/it] 38%|███▊      | 155/411 [03:26<05:39,  1.33s/it] 38%|███▊      | 156/411 [03:27<05:38,  1.33s/it] 38%|███▊      | 157/411 [03:28<05:36,  1.33s/it] 38%|███▊      | 158/411 [03:30<05:35,  1.33s/it] 39%|███▊      | 159/411 [03:31<05:34,  1.33s/it] 39%|███▉      | 160/411 [03:32<05:33,  1.33s/it] 39%|███▉      | 161/411 [03:33<05:31,  1.33s/it] 39%|███▉      | 162/411 [03:35<05:30,  1.33s/it] 40%|███▉      | 163/411 [03:36<05:28,  1.33s/it] 40%|███▉      | 164/411 [03:37<05:27,  1.33s/it] 40%|████      | 165/411 [03:39<05:26,  1.33s/it] 40%|████      | 166/411 [03:40<05:24,  1.33s/it] 41%|████      | 167/411 [03:41<05:23,  1.33s/it] 41%|████      | 168/411 [03:43<05:22,  1.33s/it] 41%|████      | 169/411 [03:44<05:20,  1.33s/it] 41%|████▏     | 170/411 [03:45<05:19,  1.33s/it] 42%|████▏     | 171/411 [03:47<05:18,  1.33s/it] 42%|████▏     | 172/411 [03:48<05:16,  1.33s/it] 42%|████▏     | 173/411 [03:49<05:15,  1.33s/it] 42%|████▏     | 174/411 [03:51<05:14,  1.33s/it] 43%|████▎     | 175/411 [03:52<05:12,  1.33s/it] 43%|████▎     | 176/411 [03:53<05:11,  1.33s/it] 43%|████▎     | 177/411 [03:55<05:10,  1.33s/it] 43%|████▎     | 178/411 [03:56<05:08,  1.33s/it] 44%|████▎     | 179/411 [03:57<05:07,  1.33s/it] 44%|████▍     | 180/411 [03:59<05:06,  1.33s/it] 44%|████▍     | 181/411 [04:00<05:05,  1.33s/it] 44%|████▍     | 182/411 [04:01<05:03,  1.33s/it] 45%|████▍     | 183/411 [04:03<05:02,  1.33s/it] 45%|████▍     | 184/411 [04:04<05:01,  1.33s/it] 45%|████▌     | 185/411 [04:05<04:59,  1.33s/it] 45%|████▌     | 186/411 [04:07<04:58,  1.33s/it] 45%|████▌     | 187/411 [04:08<04:57,  1.33s/it] 46%|████▌     | 188/411 [04:09<04:55,  1.33s/it] 46%|████▌     | 189/411 [04:11<04:54,  1.33s/it] 46%|████▌     | 190/411 [04:12<04:53,  1.33s/it] 46%|████▋     | 191/411 [04:13<04:51,  1.33s/it] 47%|████▋     | 192/411 [04:15<04:50,  1.33s/it] 47%|████▋     | 193/411 [04:16<04:49,  1.33s/it] 47%|████▋     | 194/411 [04:17<04:47,  1.33s/it] 47%|████▋     | 195/411 [04:19<04:46,  1.33s/it] 48%|████▊     | 196/411 [04:20<04:45,  1.33s/it] 48%|████▊     | 197/411 [04:21<04:43,  1.33s/it] 48%|████▊     | 198/411 [04:23<04:42,  1.33s/it] 48%|████▊     | 199/411 [04:24<04:41,  1.33s/it] 49%|████▊     | 200/411 [04:25<04:39,  1.33s/it]                                                  49%|████▊     | 200/411 [04:25<04:39,  1.33s/it] 49%|████▉     | 201/411 [04:27<04:38,  1.33s/it] 49%|████▉     | 202/411 [04:28<04:37,  1.33s/it] 49%|████▉     | 203/411 [04:29<04:35,  1.33s/it] 50%|████▉     | 204/411 [04:31<04:34,  1.33s/it] 50%|████▉     | 205/411 [04:32<04:33,  1.33s/it] 50%|█████     | 206/411 [04:33<04:31,  1.33s/it] 50%|█████     | 207/411 [04:34<04:30,  1.33s/it] 51%|█████     | 208/411 [04:36<04:29,  1.33s/it] 51%|█████     | 209/411 [04:37<04:27,  1.33s/it] 51%|█████     | 210/411 [04:38<04:26,  1.33s/it] 51%|█████▏    | 211/411 [04:40<04:25,  1.33s/it] 52%|█████▏    | 212/411 [04:41<04:23,  1.33s/it] 52%|█████▏    | 213/411 [04:42<04:22,  1.33s/it] 52%|█████▏    | 214/411 [04:44<04:21,  1.33s/it] 52%|█████▏    | 215/411 [04:45<04:19,  1.33s/it] 53%|█████▎    | 216/411 [04:46<04:18,  1.33s/it] 53%|█████▎    | 217/411 [04:48<04:17,  1.33s/it] 53%|█████▎    | 218/411 [04:49<04:15,  1.33s/it] 53%|█████▎    | 219/411 [04:50<04:14,  1.33s/it] 54%|█████▎    | 220/411 [04:52<04:13,  1.33s/it] 54%|█████▍    | 221/411 [04:53<04:11,  1.33s/it] 54%|█████▍    | 222/411 [04:54<04:10,  1.33s/it] 54%|█████▍    | 223/411 [04:56<04:09,  1.33s/it] 55%|█████▍    | 224/411 [04:57<04:07,  1.33s/it] 55%|█████▍    | 225/411 [04:58<04:06,  1.33s/it] 55%|█████▍    | 226/411 [05:00<04:06,  1.33s/it] 55%|█████▌    | 227/411 [05:01<04:04,  1.33s/it] 55%|█████▌    | 228/411 [05:02<04:03,  1.33s/it] 56%|█████▌    | 229/411 [05:04<04:01,  1.33s/it] 56%|█████▌    | 230/411 [05:05<04:00,  1.33s/it] 56%|█████▌    | 231/411 [05:06<03:58,  1.33s/it] 56%|█████▋    | 232/411 [05:08<03:57,  1.33s/it] 57%|█████▋    | 233/411 [05:09<03:56,  1.33s/it] 57%|█████▋    | 234/411 [05:10<03:54,  1.33s/it] 57%|█████▋    | 235/411 [05:12<03:53,  1.33s/it] 57%|█████▋    | 236/411 [05:13<03:52,  1.33s/it] 58%|█████▊    | 237/411 [05:14<03:50,  1.33s/it] 58%|█████▊    | 238/411 [05:16<03:49,  1.33s/it] 58%|█████▊    | 239/411 [05:17<03:48,  1.33s/it] 58%|█████▊    | 240/411 [05:18<03:46,  1.33s/it] 59%|█████▊    | 241/411 [05:20<03:45,  1.33s/it] 59%|█████▉    | 242/411 [05:21<03:44,  1.33s/it] 59%|█████▉    | 243/411 [05:22<03:42,  1.33s/it] 59%|█████▉    | 244/411 [05:24<03:41,  1.33s/it] 60%|█████▉    | 245/411 [05:25<03:40,  1.33s/it] 60%|█████▉    | 246/411 [05:26<03:38,  1.33s/it] 60%|██████    | 247/411 [05:28<03:37,  1.33s/it] 60%|██████    | 248/411 [05:29<03:36,  1.33s/it] 61%|██████    | 249/411 [05:30<03:34,  1.33s/it] 61%|██████    | 250/411 [05:32<03:33,  1.33s/it] 61%|██████    | 251/411 [05:33<03:32,  1.33s/it] 61%|██████▏   | 252/411 [05:34<03:30,  1.33s/it] 62%|██████▏   | 253/411 [05:35<03:29,  1.33s/it] 62%|██████▏   | 254/411 [05:37<03:28,  1.33s/it] 62%|██████▏   | 255/411 [05:38<03:26,  1.33s/it] 62%|██████▏   | 256/411 [05:39<03:25,  1.33s/it] 63%|██████▎   | 257/411 [05:41<03:24,  1.33s/it] 63%|██████▎   | 258/411 [05:42<03:22,  1.33s/it] 63%|██████▎   | 259/411 [05:43<03:21,  1.33s/it] 63%|██████▎   | 260/411 [05:45<03:20,  1.33s/it] 64%|██████▎   | 261/411 [05:46<03:18,  1.33s/it] 64%|██████▎   | 262/411 [05:47<03:17,  1.33s/it] 64%|██████▍   | 263/411 [05:49<03:16,  1.33s/it] 64%|██████▍   | 264/411 [05:50<03:14,  1.33s/it] 64%|██████▍   | 265/411 [05:51<03:13,  1.33s/it] 65%|██████▍   | 266/411 [05:53<03:12,  1.33s/it] 65%|██████▍   | 267/411 [05:54<03:10,  1.33s/it] 65%|██████▌   | 268/411 [05:55<03:09,  1.33s/it] 65%|██████▌   | 269/411 [05:57<03:08,  1.33s/it] 66%|██████▌   | 270/411 [05:58<03:06,  1.33s/it] 66%|██████▌   | 271/411 [05:59<03:05,  1.33s/it] 66%|██████▌   | 272/411 [06:01<03:04,  1.33s/it] 66%|██████▋   | 273/411 [06:02<03:03,  1.33s/it] 67%|██████▋   | 274/411 [06:03<03:01,  1.33s/it] 67%|██████▋   | 275/411 [06:05<03:00,  1.33s/it] 67%|██████▋   | 276/411 [06:06<02:58,  1.33s/it] 67%|██████▋   | 277/411 [06:07<02:57,  1.33s/it] 68%|██████▊   | 278/411 [06:09<02:56,  1.33s/it] 68%|██████▊   | 279/411 [06:10<02:55,  1.33s/it] 68%|██████▊   | 280/411 [06:11<02:53,  1.33s/it] 68%|██████▊   | 281/411 [06:13<02:52,  1.33s/it] 69%|██████▊   | 282/411 [06:14<02:51,  1.33s/it] 69%|██████▉   | 283/411 [06:15<02:49,  1.33s/it] 69%|██████▉   | 284/411 [06:17<02:48,  1.33s/it] 69%|██████▉   | 285/411 [06:18<02:47,  1.33s/it] 70%|██████▉   | 286/411 [06:19<02:45,  1.33s/it] 70%|██████▉   | 287/411 [06:21<02:44,  1.33s/it] 70%|███████   | 288/411 [06:22<02:43,  1.33s/it] 70%|███████   | 289/411 [06:23<02:41,  1.33s/it] 71%|███████   | 290/411 [06:25<02:40,  1.33s/it] 71%|███████   | 291/411 [06:26<02:39,  1.33s/it] 71%|███████   | 292/411 [06:27<02:37,  1.33s/it] 71%|███████▏  | 293/411 [06:29<02:36,  1.33s/it] 72%|███████▏  | 294/411 [06:30<02:35,  1.33s/it] 72%|███████▏  | 295/411 [06:31<02:33,  1.33s/it] 72%|███████▏  | 296/411 [06:33<02:32,  1.33s/it] 72%|███████▏  | 297/411 [06:34<02:31,  1.33s/it] 73%|███████▎  | 298/411 [06:35<02:29,  1.33s/it] 73%|███████▎  | 299/411 [06:36<02:28,  1.33s/it] 73%|███████▎  | 300/411 [06:38<02:27,  1.33s/it]                                                  73%|███████▎  | 300/411 [06:38<02:27,  1.33s/it] 73%|███████▎  | 301/411 [06:39<02:25,  1.33s/it] 73%|███████▎  | 302/411 [06:40<02:24,  1.33s/it] 74%|███████▎  | 303/411 [06:42<02:23,  1.33s/it] 74%|███████▍  | 304/411 [06:43<02:21,  1.33s/it] 74%|███████▍  | 305/411 [06:44<02:20,  1.33s/it] 74%|███████▍  | 306/411 [06:46<02:19,  1.33s/it] 75%|███████▍  | 307/411 [06:47<02:17,  1.33s/it] 75%|███████▍  | 308/411 [06:48<02:16,  1.33s/it] 75%|███████▌  | 309/411 [06:50<02:15,  1.33s/it] 75%|███████▌  | 310/411 [06:51<02:13,  1.33s/it] 76%|███████▌  | 311/411 [06:52<02:12,  1.33s/it] 76%|███████▌  | 312/411 [06:54<02:11,  1.33s/it] 76%|███████▌  | 313/411 [06:55<02:09,  1.33s/it] 76%|███████▋  | 314/411 [06:56<02:08,  1.33s/it] 77%|███████▋  | 315/411 [06:58<02:07,  1.33s/it] 77%|███████▋  | 316/411 [06:59<02:05,  1.33s/it] 77%|███████▋  | 317/411 [07:00<02:04,  1.33s/it] 77%|███████▋  | 318/411 [07:02<02:03,  1.33s/it] 78%|███████▊  | 319/411 [07:03<02:01,  1.33s/it] 78%|███████▊  | 320/411 [07:04<02:00,  1.33s/it] 78%|███████▊  | 321/411 [07:06<01:59,  1.33s/it] 78%|███████▊  | 322/411 [07:07<01:58,  1.33s/it] 79%|███████▊  | 323/411 [07:08<01:56,  1.33s/it] 79%|███████▉  | 324/411 [07:10<01:55,  1.33s/it] 79%|███████▉  | 325/411 [07:11<01:54,  1.33s/it] 79%|███████▉  | 326/411 [07:12<01:52,  1.33s/it] 80%|███████▉  | 327/411 [07:14<01:51,  1.33s/it] 80%|███████▉  | 328/411 [07:15<01:50,  1.33s/it] 80%|████████  | 329/411 [07:16<01:48,  1.33s/it] 80%|████████  | 330/411 [07:18<01:47,  1.33s/it] 81%|████████  | 331/411 [07:19<01:46,  1.33s/it] 81%|████████  | 332/411 [07:20<01:44,  1.33s/it] 81%|████████  | 333/411 [07:22<01:43,  1.33s/it] 81%|████████▏ | 334/411 [07:23<01:42,  1.33s/it] 82%|████████▏ | 335/411 [07:24<01:40,  1.33s/it] 82%|████████▏ | 336/411 [07:26<01:39,  1.33s/it] 82%|████████▏ | 337/411 [07:27<01:38,  1.33s/it] 82%|████████▏ | 338/411 [07:28<01:36,  1.33s/it] 82%|████████▏ | 339/411 [07:30<01:35,  1.33s/it] 83%|████████▎ | 340/411 [07:31<01:34,  1.33s/it] 83%|████████▎ | 341/411 [07:32<01:32,  1.33s/it] 83%|████████▎ | 342/411 [07:33<01:31,  1.33s/it] 83%|████████▎ | 343/411 [07:35<01:30,  1.33s/it] 84%|████████▎ | 344/411 [07:36<01:28,  1.32s/it] 84%|████████▍ | 345/411 [07:37<01:27,  1.32s/it] 84%|████████▍ | 346/411 [07:39<01:26,  1.32s/it] 84%|████████▍ | 347/411 [07:40<01:24,  1.32s/it] 85%|████████▍ | 348/411 [07:41<01:23,  1.32s/it] 85%|████████▍ | 349/411 [07:43<01:22,  1.32s/it] 85%|████████▌ | 350/411 [07:44<01:20,  1.33s/it] 85%|████████▌ | 351/411 [07:45<01:19,  1.33s/it] 86%|████████▌ | 352/411 [07:47<01:18,  1.33s/it] 86%|████████▌ | 353/411 [07:48<01:16,  1.33s/it] 86%|████████▌ | 354/411 [07:49<01:15,  1.33s/it] 86%|████████▋ | 355/411 [07:51<01:14,  1.33s/it] 87%|████████▋ | 356/411 [07:52<01:12,  1.33s/it] 87%|████████▋ | 357/411 [07:53<01:11,  1.33s/it] 87%|████████▋ | 358/411 [07:55<01:10,  1.32s/it] 87%|████████▋ | 359/411 [07:56<01:08,  1.32s/it] 88%|████████▊ | 360/411 [07:57<01:07,  1.32s/it] 88%|████████▊ | 361/411 [07:59<01:06,  1.33s/it] 88%|████████▊ | 362/411 [08:00<01:04,  1.33s/it] 88%|████████▊ | 363/411 [08:01<01:03,  1.33s/it] 89%|████████▊ | 364/411 [08:03<01:02,  1.33s/it] 89%|████████▉ | 365/411 [08:04<01:00,  1.33s/it] 89%|████████▉ | 366/411 [08:05<00:59,  1.33s/it] 89%|████████▉ | 367/411 [08:07<00:58,  1.33s/it] 90%|████████▉ | 368/411 [08:08<00:56,  1.33s/it] 90%|████████▉ | 369/411 [08:09<00:55,  1.33s/it] 90%|█████████ | 370/411 [08:11<00:54,  1.33s/it] 90%|█████████ | 371/411 [08:12<00:53,  1.33s/it] 91%|█████████ | 372/411 [08:13<00:51,  1.33s/it] 91%|█████████ | 373/411 [08:15<00:50,  1.33s/it] 91%|█████████ | 374/411 [08:16<00:49,  1.33s/it] 91%|█████████ | 375/411 [08:17<00:47,  1.33s/it] 91%|█████████▏| 376/411 [08:19<00:46,  1.33s/it] 92%|█████████▏| 377/411 [08:20<00:45,  1.33s/it] 92%|█████████▏| 378/411 [08:21<00:43,  1.33s/it] 92%|█████████▏| 379/411 [08:23<00:42,  1.33s/it] 92%|█████████▏| 380/411 [08:24<00:41,  1.33s/it] 93%|█████████▎| 381/411 [08:25<00:39,  1.33s/it] 93%|█████████▎| 382/411 [08:27<00:38,  1.33s/it] 93%|█████████▎| 383/411 [08:28<00:37,  1.33s/it] 93%|█████████▎| 384/411 [08:29<00:35,  1.33s/it] 94%|█████████▎| 385/411 [08:30<00:34,  1.33s/it] 94%|█████████▍| 386/411 [08:32<00:33,  1.33s/it] 94%|█████████▍| 387/411 [08:33<00:31,  1.33s/it] 94%|█████████▍| 388/411 [08:34<00:30,  1.33s/it] 95%|█████████▍| 389/411 [08:36<00:29,  1.33s/it] 95%|█████████▍| 390/411 [08:37<00:27,  1.33s/it] 95%|█████████▌| 391/411 [08:38<00:26,  1.33s/it] 95%|█████████▌| 392/411 [08:40<00:25,  1.33s/it] 96%|█████████▌| 393/411 [08:41<00:23,  1.32s/it] 96%|█████████▌| 394/411 [08:42<00:22,  1.33s/it] 96%|█████████▌| 395/411 [08:44<00:21,  1.33s/it] 96%|█████████▋| 396/411 [08:45<00:19,  1.33s/it] 97%|█████████▋| 397/411 [08:46<00:18,  1.32s/it] 97%|█████████▋| 398/411 [08:48<00:17,  1.32s/it] 97%|█████████▋| 399/411 [08:49<00:15,  1.32s/it] 97%|█████████▋| 400/411 [08:50<00:14,  1.33s/it]                                                  97%|█████████▋| 400/411 [08:50<00:14,  1.33s/it] 98%|█████████▊| 401/411 [08:52<00:13,  1.33s/it] 98%|█████████▊| 402/411 [08:53<00:11,  1.33s/it] 98%|█████████▊| 403/411 [08:54<00:10,  1.33s/it] 98%|█████████▊| 404/411 [08:56<00:09,  1.33s/it] 99%|█████████▊| 405/411 [08:57<00:07,  1.33s/it] 99%|█████████▉| 406/411 [08:58<00:06,  1.33s/it] 99%|█████████▉| 407/411 [09:00<00:05,  1.33s/it] 99%|█████████▉| 408/411 [09:01<00:03,  1.33s/it]100%|█████████▉| 409/411 [09:02<00:02,  1.33s/it]100%|█████████▉| 410/411 [09:04<00:01,  1.33s/it]100%|██████████| 411/411 [09:04<00:00,  1.15s/it]/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x148de439dde0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: bf7c7327-3bbe-4b43-84ac-089bd76a28ba)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                 100%|██████████| 411/411 [09:05<00:00,  1.15s/it]100%|██████████| 411/411 [09:05<00:00,  1.33s/it]
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x148de43c5840>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 7f06abf4-de02-49fa-ae7f-9c19d745e32f)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'loss': 2.5232, 'grad_norm': 2.986907482147217, 'learning_rate': 1.51338199513382e-05, 'epoch': 0.24}
{'loss': 0.6997, 'grad_norm': 3.0377957820892334, 'learning_rate': 1.0267639902676401e-05, 'epoch': 0.49}
{'loss': 0.4009, 'grad_norm': 2.3358500003814697, 'learning_rate': 5.401459854014599e-06, 'epoch': 0.73}
{'loss': 0.38, 'grad_norm': 2.9071643352508545, 'learning_rate': 5.352798053527981e-07, 'epoch': 0.97}
{'train_runtime': 545.0723, 'train_samples_per_second': 3.012, 'train_steps_per_second': 0.754, 'train_loss': 0.9843526315805106, 'epoch': 1.0}
Saving model to ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_constant_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_43
Fine-tuning completed successfully!
2025-05-01 15:43:45.127571: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 15:43:45.140876: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746128625.155785  298438 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746128625.160343  298438 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746128625.172980  298438 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746128625.172999  298438 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746128625.173001  298438 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746128625.173002  298438 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 15:43:45.176886: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
=== Fine-tuning Configuration ===
Model: 
Training dataset: 
Random seed: 36
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: 
===========================
CUDA available: True
CUDA device count: 1
CUDA current device: 0
CUDA device name: NVIDIA A100 80GB PCIe MIG 3g.40gb
train_config(model_name='meta-llama/Llama-3.2-3B-Instruct', enable_fsdp=False, low_cpu_fsdp=False, run_validation=True, batch_size_training=4, gradient_accumulation_steps=1, num_epochs=1, num_workers_dataloader=1, lr=2e-05, weight_decay=0.0, gamma=0.85, seed=43, use_fp16=False, mixed_precision=True, val_batch_size=1, peft_method='lora', use_peft=False, output_dir='../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_prop_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_43', freeze_layers=False, num_freeze_layers=1, quantization=True, one_gpu=False, save_model=True, save_every_epoch=True, dist_checkpoint_root_folder='fsdp', dist_checkpoint_folder='fine-tuned', save_optimizer=False, use_fast_kernels=False, use_lora=True, save_full_gradients=False, system_message='You are a helpful assistant. Provide your best guess or estimate given the scenario. Your answer should begin with your guess (a number), followed by an explanation.', ft_dataset_name='no_bias_prop_var_prop_rep', dataset='datasets/ft/no_bias_prop_var_prop_rep.jsonl', eval_dataset_name='bbq_subset_100', eval_dataset=None, eval_output_file=None, base_output_file=None)
Clearing GPU cache
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.44s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Applying LoRA adapter...
trainable params: 2,293,760 || all params: 3,215,046,656 || trainable%: 0.0713
Loading data from datasets/ft/no_bias_prop_var_prop_rep.jsonl...
Using all 1642 examples from dataset
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 25895.73 examples/s]
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map:  61%|██████    | 1000/1642 [00:00<00:00, 2379.75 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2440.13 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2405.07 examples/s]
/home/janeec/FairTune/finetune_w_eval_llama.py:297: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
=== Fine-tuning Configuration ===
Model: meta-llama/Llama-3.2-3B-Instruct
Training dataset: datasets/ft/no_bias_prop_var_prop_rep.jsonl
Random seed: 43
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_prop_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_43
===========================
SEED CHECK:, should be: 43, seed is: 43
Starting fine-tuning...
  0%|          | 0/411 [00:00<?, ?it/s]  0%|          | 1/411 [00:01<10:27,  1.53s/it]  0%|          | 2/411 [00:02<09:39,  1.42s/it]  1%|          | 3/411 [00:04<09:21,  1.38s/it]  1%|          | 4/411 [00:05<09:12,  1.36s/it]  1%|          | 5/411 [00:06<09:06,  1.35s/it]  1%|▏         | 6/411 [00:08<09:02,  1.34s/it]  2%|▏         | 7/411 [00:09<09:00,  1.34s/it]  2%|▏         | 8/411 [00:10<08:57,  1.33s/it]  2%|▏         | 9/411 [00:12<08:55,  1.33s/it]  2%|▏         | 10/411 [00:13<08:53,  1.33s/it]  3%|▎         | 11/411 [00:14<08:51,  1.33s/it]  3%|▎         | 12/411 [00:16<08:49,  1.33s/it]  3%|▎         | 13/411 [00:17<08:48,  1.33s/it]  3%|▎         | 14/411 [00:18<08:46,  1.33s/it]  4%|▎         | 15/411 [00:20<08:45,  1.33s/it]  4%|▍         | 16/411 [00:21<08:44,  1.33s/it]  4%|▍         | 17/411 [00:22<08:42,  1.33s/it]  4%|▍         | 18/411 [00:24<08:41,  1.33s/it]  5%|▍         | 19/411 [00:25<08:40,  1.33s/it]  5%|▍         | 20/411 [00:26<08:38,  1.33s/it]  5%|▌         | 21/411 [00:28<08:37,  1.33s/it]  5%|▌         | 22/411 [00:29<08:36,  1.33s/it]  6%|▌         | 23/411 [00:30<08:34,  1.33s/it]  6%|▌         | 24/411 [00:32<08:33,  1.33s/it]  6%|▌         | 25/411 [00:33<08:32,  1.33s/it]  6%|▋         | 26/411 [00:34<08:30,  1.33s/it]  7%|▋         | 27/411 [00:36<08:29,  1.33s/it]  7%|▋         | 28/411 [00:37<08:28,  1.33s/it]  7%|▋         | 29/411 [00:38<08:26,  1.33s/it]  7%|▋         | 30/411 [00:40<08:25,  1.33s/it]  8%|▊         | 31/411 [00:41<08:24,  1.33s/it]  8%|▊         | 32/411 [00:42<08:22,  1.33s/it]  8%|▊         | 33/411 [00:44<08:21,  1.33s/it]  8%|▊         | 34/411 [00:45<08:20,  1.33s/it]  9%|▊         | 35/411 [00:46<08:18,  1.33s/it]  9%|▉         | 36/411 [00:47<08:17,  1.33s/it]  9%|▉         | 37/411 [00:49<08:16,  1.33s/it]  9%|▉         | 38/411 [00:50<08:15,  1.33s/it]  9%|▉         | 39/411 [00:51<08:13,  1.33s/it] 10%|▉         | 40/411 [00:53<08:12,  1.33s/it] 10%|▉         | 41/411 [00:54<08:10,  1.33s/it] 10%|█         | 42/411 [00:55<08:09,  1.33s/it] 10%|█         | 43/411 [00:57<08:08,  1.33s/it] 11%|█         | 44/411 [00:58<08:06,  1.33s/it] 11%|█         | 45/411 [00:59<08:05,  1.33s/it] 11%|█         | 46/411 [01:01<08:05,  1.33s/it] 11%|█▏        | 47/411 [01:02<08:03,  1.33s/it] 12%|█▏        | 48/411 [01:03<08:02,  1.33s/it] 12%|█▏        | 49/411 [01:05<08:00,  1.33s/it] 12%|█▏        | 50/411 [01:06<07:59,  1.33s/it] 12%|█▏        | 51/411 [01:07<07:57,  1.33s/it] 13%|█▎        | 52/411 [01:09<07:56,  1.33s/it] 13%|█▎        | 53/411 [01:10<07:55,  1.33s/it] 13%|█▎        | 54/411 [01:11<07:53,  1.33s/it] 13%|█▎        | 55/411 [01:13<07:52,  1.33s/it] 14%|█▎        | 56/411 [01:14<07:51,  1.33s/it] 14%|█▍        | 57/411 [01:15<07:49,  1.33s/it] 14%|█▍        | 58/411 [01:17<07:48,  1.33s/it] 14%|█▍        | 59/411 [01:18<07:47,  1.33s/it] 15%|█▍        | 60/411 [01:19<07:45,  1.33s/it] 15%|█▍        | 61/411 [01:21<07:44,  1.33s/it] 15%|█▌        | 62/411 [01:22<07:43,  1.33s/it] 15%|█▌        | 63/411 [01:23<07:41,  1.33s/it] 16%|█▌        | 64/411 [01:25<07:40,  1.33s/it] 16%|█▌        | 65/411 [01:26<07:39,  1.33s/it] 16%|█▌        | 66/411 [01:27<07:37,  1.33s/it] 16%|█▋        | 67/411 [01:29<07:36,  1.33s/it] 17%|█▋        | 68/411 [01:30<07:34,  1.33s/it] 17%|█▋        | 69/411 [01:31<07:33,  1.33s/it] 17%|█▋        | 70/411 [01:33<07:32,  1.33s/it] 17%|█▋        | 71/411 [01:34<07:31,  1.33s/it] 18%|█▊        | 72/411 [01:35<07:29,  1.33s/it] 18%|█▊        | 73/411 [01:37<07:28,  1.33s/it] 18%|█▊        | 74/411 [01:38<07:27,  1.33s/it] 18%|█▊        | 75/411 [01:39<07:25,  1.33s/it] 18%|█▊        | 76/411 [01:41<07:24,  1.33s/it] 19%|█▊        | 77/411 [01:42<07:23,  1.33s/it] 19%|█▉        | 78/411 [01:43<07:21,  1.33s/it] 19%|█▉        | 79/411 [01:45<07:20,  1.33s/it] 19%|█▉        | 80/411 [01:46<07:19,  1.33s/it] 20%|█▉        | 81/411 [01:47<07:17,  1.33s/it] 20%|█▉        | 82/411 [01:49<07:16,  1.33s/it] 20%|██        | 83/411 [01:50<07:14,  1.33s/it] 20%|██        | 84/411 [01:51<07:13,  1.33s/it] 21%|██        | 85/411 [01:53<07:12,  1.33s/it] 21%|██        | 86/411 [01:54<07:10,  1.33s/it] 21%|██        | 87/411 [01:55<07:09,  1.33s/it] 21%|██▏       | 88/411 [01:56<07:08,  1.33s/it] 22%|██▏       | 89/411 [01:58<07:07,  1.33s/it] 22%|██▏       | 90/411 [01:59<07:05,  1.33s/it] 22%|██▏       | 91/411 [02:00<07:04,  1.33s/it] 22%|██▏       | 92/411 [02:02<07:03,  1.33s/it] 23%|██▎       | 93/411 [02:03<07:01,  1.33s/it] 23%|██▎       | 94/411 [02:04<07:00,  1.33s/it] 23%|██▎       | 95/411 [02:06<06:59,  1.33s/it] 23%|██▎       | 96/411 [02:07<06:57,  1.33s/it] 24%|██▎       | 97/411 [02:08<06:56,  1.33s/it] 24%|██▍       | 98/411 [02:10<06:55,  1.33s/it] 24%|██▍       | 99/411 [02:11<06:53,  1.33s/it] 24%|██▍       | 100/411 [02:12<06:52,  1.33s/it]                                                  24%|██▍       | 100/411 [02:12<06:52,  1.33s/it] 25%|██▍       | 101/411 [02:14<06:51,  1.33s/it] 25%|██▍       | 102/411 [02:15<06:49,  1.33s/it] 25%|██▌       | 103/411 [02:16<06:48,  1.33s/it] 25%|██▌       | 104/411 [02:18<06:47,  1.33s/it] 26%|██▌       | 105/411 [02:19<06:45,  1.33s/it] 26%|██▌       | 106/411 [02:20<06:44,  1.33s/it] 26%|██▌       | 107/411 [02:22<06:43,  1.33s/it] 26%|██▋       | 108/411 [02:23<06:41,  1.33s/it] 27%|██▋       | 109/411 [02:24<06:40,  1.33s/it] 27%|██▋       | 110/411 [02:26<06:39,  1.33s/it] 27%|██▋       | 111/411 [02:27<06:37,  1.33s/it] 27%|██▋       | 112/411 [02:28<06:36,  1.33s/it] 27%|██▋       | 113/411 [02:30<06:35,  1.33s/it] 28%|██▊       | 114/411 [02:31<06:35,  1.33s/it] 28%|██▊       | 115/411 [02:32<06:33,  1.33s/it] 28%|██▊       | 116/411 [02:34<06:31,  1.33s/it] 28%|██▊       | 117/411 [02:35<06:30,  1.33s/it] 29%|██▊       | 118/411 [02:36<06:28,  1.33s/it] 29%|██▉       | 119/411 [02:38<06:27,  1.33s/it] 29%|██▉       | 120/411 [02:39<06:25,  1.33s/it] 29%|██▉       | 121/411 [02:40<06:24,  1.33s/it] 30%|██▉       | 122/411 [02:42<06:23,  1.33s/it] 30%|██▉       | 123/411 [02:43<06:21,  1.33s/it] 30%|███       | 124/411 [02:44<06:20,  1.33s/it] 30%|███       | 125/411 [02:46<06:19,  1.33s/it] 31%|███       | 126/411 [02:47<06:17,  1.33s/it] 31%|███       | 127/411 [02:48<06:16,  1.33s/it] 31%|███       | 128/411 [02:50<06:15,  1.33s/it] 31%|███▏      | 129/411 [02:51<06:13,  1.33s/it] 32%|███▏      | 130/411 [02:52<06:12,  1.33s/it] 32%|███▏      | 131/411 [02:54<06:11,  1.33s/it] 32%|███▏      | 132/411 [02:55<06:09,  1.33s/it] 32%|███▏      | 133/411 [02:56<06:08,  1.33s/it] 33%|███▎      | 134/411 [02:57<06:07,  1.33s/it] 33%|███▎      | 135/411 [02:59<06:05,  1.33s/it] 33%|███▎      | 136/411 [03:00<06:04,  1.33s/it] 33%|███▎      | 137/411 [03:01<06:03,  1.33s/it] 34%|███▎      | 138/411 [03:03<06:01,  1.33s/it] 34%|███▍      | 139/411 [03:04<06:00,  1.33s/it] 34%|███▍      | 140/411 [03:05<05:59,  1.33s/it] 34%|███▍      | 141/411 [03:07<05:57,  1.33s/it] 35%|███▍      | 142/411 [03:08<05:56,  1.33s/it] 35%|███▍      | 143/411 [03:09<05:55,  1.33s/it] 35%|███▌      | 144/411 [03:11<05:53,  1.33s/it] 35%|███▌      | 145/411 [03:12<05:52,  1.33s/it] 36%|███▌      | 146/411 [03:13<05:51,  1.33s/it] 36%|███▌      | 147/411 [03:15<05:49,  1.33s/it] 36%|███▌      | 148/411 [03:16<05:48,  1.33s/it] 36%|███▋      | 149/411 [03:17<05:47,  1.33s/it] 36%|███▋      | 150/411 [03:19<05:46,  1.33s/it] 37%|███▋      | 151/411 [03:20<05:44,  1.33s/it] 37%|███▋      | 152/411 [03:21<05:43,  1.33s/it] 37%|███▋      | 153/411 [03:23<05:41,  1.33s/it] 37%|███▋      | 154/411 [03:24<05:40,  1.33s/it] 38%|███▊      | 155/411 [03:25<05:39,  1.33s/it] 38%|███▊      | 156/411 [03:27<05:38,  1.33s/it] 38%|███▊      | 157/411 [03:28<05:36,  1.33s/it] 38%|███▊      | 158/411 [03:29<05:35,  1.33s/it] 39%|███▊      | 159/411 [03:31<05:34,  1.33s/it] 39%|███▉      | 160/411 [03:32<05:33,  1.33s/it] 39%|███▉      | 161/411 [03:33<05:31,  1.33s/it] 39%|███▉      | 162/411 [03:35<05:30,  1.33s/it] 40%|███▉      | 163/411 [03:36<05:28,  1.33s/it] 40%|███▉      | 164/411 [03:37<05:27,  1.33s/it] 40%|████      | 165/411 [03:39<05:26,  1.33s/it] 40%|████      | 166/411 [03:40<05:24,  1.33s/it] 41%|████      | 167/411 [03:41<05:23,  1.33s/it] 41%|████      | 168/411 [03:43<05:22,  1.33s/it] 41%|████      | 169/411 [03:44<05:20,  1.33s/it] 41%|████▏     | 170/411 [03:45<05:19,  1.33s/it] 42%|████▏     | 171/411 [03:47<05:18,  1.33s/it] 42%|████▏     | 172/411 [03:48<05:16,  1.33s/it] 42%|████▏     | 173/411 [03:49<05:15,  1.33s/it] 42%|████▏     | 174/411 [03:51<05:14,  1.33s/it] 43%|████▎     | 175/411 [03:52<05:12,  1.33s/it] 43%|████▎     | 176/411 [03:53<05:11,  1.33s/it] 43%|████▎     | 177/411 [03:55<05:10,  1.33s/it] 43%|████▎     | 178/411 [03:56<05:08,  1.33s/it] 44%|████▎     | 179/411 [03:57<05:07,  1.33s/it] 44%|████▍     | 180/411 [03:58<05:06,  1.33s/it] 44%|████▍     | 181/411 [04:00<05:04,  1.33s/it] 44%|████▍     | 182/411 [04:01<05:03,  1.33s/it] 45%|████▍     | 183/411 [04:02<05:02,  1.33s/it] 45%|████▍     | 184/411 [04:04<05:01,  1.33s/it] 45%|████▌     | 185/411 [04:05<04:59,  1.33s/it] 45%|████▌     | 186/411 [04:06<04:58,  1.33s/it] 45%|████▌     | 187/411 [04:08<04:57,  1.33s/it] 46%|████▌     | 188/411 [04:09<04:55,  1.33s/it] 46%|████▌     | 189/411 [04:10<04:54,  1.33s/it] 46%|████▌     | 190/411 [04:12<04:52,  1.33s/it] 46%|████▋     | 191/411 [04:13<04:51,  1.33s/it] 47%|████▋     | 192/411 [04:14<04:50,  1.33s/it] 47%|████▋     | 193/411 [04:16<04:48,  1.33s/it] 47%|████▋     | 194/411 [04:17<04:47,  1.33s/it] 47%|████▋     | 195/411 [04:18<04:46,  1.33s/it] 48%|████▊     | 196/411 [04:20<04:44,  1.33s/it] 48%|████▊     | 197/411 [04:21<04:43,  1.33s/it] 48%|████▊     | 198/411 [04:22<04:42,  1.33s/it] 48%|████▊     | 199/411 [04:24<04:40,  1.33s/it] 49%|████▊     | 200/411 [04:25<04:39,  1.33s/it]                                                  49%|████▊     | 200/411 [04:25<04:39,  1.33s/it] 49%|████▉     | 201/411 [04:26<04:38,  1.33s/it] 49%|████▉     | 202/411 [04:28<04:37,  1.33s/it] 49%|████▉     | 203/411 [04:29<04:35,  1.33s/it] 50%|████▉     | 204/411 [04:30<04:34,  1.33s/it] 50%|████▉     | 205/411 [04:32<04:33,  1.33s/it] 50%|█████     | 206/411 [04:33<04:31,  1.33s/it] 50%|█████     | 207/411 [04:34<04:30,  1.33s/it] 51%|█████     | 208/411 [04:36<04:29,  1.33s/it] 51%|█████     | 209/411 [04:37<04:27,  1.33s/it] 51%|█████     | 210/411 [04:38<04:26,  1.33s/it] 51%|█████▏    | 211/411 [04:40<04:25,  1.33s/it] 52%|█████▏    | 212/411 [04:41<04:23,  1.33s/it] 52%|█████▏    | 213/411 [04:42<04:22,  1.33s/it] 52%|█████▏    | 214/411 [04:44<04:21,  1.33s/it] 52%|█████▏    | 215/411 [04:45<04:19,  1.33s/it] 53%|█████▎    | 216/411 [04:46<04:18,  1.33s/it] 53%|█████▎    | 217/411 [04:48<04:17,  1.33s/it] 53%|█████▎    | 218/411 [04:49<04:15,  1.33s/it] 53%|█████▎    | 219/411 [04:50<04:14,  1.33s/it] 54%|█████▎    | 220/411 [04:52<04:13,  1.33s/it] 54%|█████▍    | 221/411 [04:53<04:11,  1.33s/it] 54%|█████▍    | 222/411 [04:54<04:10,  1.33s/it] 54%|█████▍    | 223/411 [04:55<04:09,  1.33s/it] 55%|█████▍    | 224/411 [04:57<04:07,  1.33s/it] 55%|█████▍    | 225/411 [04:58<04:06,  1.33s/it] 55%|█████▍    | 226/411 [04:59<04:05,  1.33s/it] 55%|█████▌    | 227/411 [05:01<04:04,  1.33s/it] 55%|█████▌    | 228/411 [05:02<04:03,  1.33s/it] 56%|█████▌    | 229/411 [05:03<04:01,  1.33s/it] 56%|█████▌    | 230/411 [05:05<04:00,  1.33s/it] 56%|█████▌    | 231/411 [05:06<03:58,  1.33s/it] 56%|█████▋    | 232/411 [05:07<03:57,  1.33s/it] 57%|█████▋    | 233/411 [05:09<03:55,  1.33s/it] 57%|█████▋    | 234/411 [05:10<03:54,  1.33s/it] 57%|█████▋    | 235/411 [05:11<03:53,  1.33s/it] 57%|█████▋    | 236/411 [05:13<03:51,  1.33s/it] 58%|█████▊    | 237/411 [05:14<03:50,  1.33s/it] 58%|█████▊    | 238/411 [05:15<03:49,  1.32s/it] 58%|█████▊    | 239/411 [05:17<03:47,  1.32s/it] 58%|█████▊    | 240/411 [05:18<03:46,  1.32s/it] 59%|█████▊    | 241/411 [05:19<03:45,  1.32s/it] 59%|█████▉    | 242/411 [05:21<03:43,  1.32s/it] 59%|█████▉    | 243/411 [05:22<03:42,  1.32s/it] 59%|█████▉    | 244/411 [05:23<03:41,  1.32s/it] 60%|█████▉    | 245/411 [05:25<03:39,  1.32s/it] 60%|█████▉    | 246/411 [05:26<03:38,  1.32s/it] 60%|██████    | 247/411 [05:27<03:37,  1.32s/it] 60%|██████    | 248/411 [05:29<03:35,  1.32s/it] 61%|██████    | 249/411 [05:30<03:34,  1.32s/it] 61%|██████    | 250/411 [05:31<03:33,  1.32s/it] 61%|██████    | 251/411 [05:33<03:31,  1.32s/it] 61%|██████▏   | 252/411 [05:34<03:30,  1.32s/it] 62%|██████▏   | 253/411 [05:35<03:29,  1.32s/it] 62%|██████▏   | 254/411 [05:37<03:28,  1.33s/it] 62%|██████▏   | 255/411 [05:38<03:26,  1.33s/it] 62%|██████▏   | 256/411 [05:39<03:25,  1.33s/it] 63%|██████▎   | 257/411 [05:41<03:24,  1.32s/it] 63%|██████▎   | 258/411 [05:42<03:22,  1.32s/it] 63%|██████▎   | 259/411 [05:43<03:21,  1.32s/it] 63%|██████▎   | 260/411 [05:45<03:20,  1.32s/it] 64%|██████▎   | 261/411 [05:46<03:18,  1.32s/it] 64%|██████▎   | 262/411 [05:47<03:17,  1.32s/it] 64%|██████▍   | 263/411 [05:48<03:16,  1.32s/it] 64%|██████▍   | 264/411 [05:50<03:14,  1.32s/it] 64%|██████▍   | 265/411 [05:51<03:13,  1.33s/it] 65%|██████▍   | 266/411 [05:52<03:12,  1.32s/it] 65%|██████▍   | 267/411 [05:54<03:10,  1.32s/it] 65%|██████▌   | 268/411 [05:55<03:09,  1.32s/it] 65%|██████▌   | 269/411 [05:56<03:08,  1.32s/it] 66%|██████▌   | 270/411 [05:58<03:06,  1.33s/it] 66%|██████▌   | 271/411 [05:59<03:05,  1.32s/it] 66%|██████▌   | 272/411 [06:00<03:04,  1.32s/it] 66%|██████▋   | 273/411 [06:02<03:02,  1.33s/it] 67%|██████▋   | 274/411 [06:03<03:01,  1.33s/it] 67%|██████▋   | 275/411 [06:04<03:00,  1.33s/it] 67%|██████▋   | 276/411 [06:06<02:58,  1.32s/it] 67%|██████▋   | 277/411 [06:07<02:57,  1.32s/it] 68%|██████▊   | 278/411 [06:08<02:56,  1.32s/it] 68%|██████▊   | 279/411 [06:10<02:54,  1.33s/it] 68%|██████▊   | 280/411 [06:11<02:53,  1.33s/it] 68%|██████▊   | 281/411 [06:12<02:52,  1.32s/it] 69%|██████▊   | 282/411 [06:14<02:50,  1.32s/it] 69%|██████▉   | 283/411 [06:15<02:49,  1.32s/it] 69%|██████▉   | 284/411 [06:16<02:48,  1.32s/it] 69%|██████▉   | 285/411 [06:18<02:46,  1.32s/it] 70%|██████▉   | 286/411 [06:19<02:45,  1.32s/it] 70%|██████▉   | 287/411 [06:20<02:44,  1.32s/it] 70%|███████   | 288/411 [06:22<02:42,  1.32s/it] 70%|███████   | 289/411 [06:23<02:41,  1.32s/it] 71%|███████   | 290/411 [06:24<02:40,  1.32s/it] 71%|███████   | 291/411 [06:26<02:38,  1.32s/it] 71%|███████   | 292/411 [06:27<02:37,  1.33s/it] 71%|███████▏  | 293/411 [06:28<02:36,  1.32s/it] 72%|███████▏  | 294/411 [06:30<02:35,  1.33s/it] 72%|███████▏  | 295/411 [06:31<02:34,  1.33s/it] 72%|███████▏  | 296/411 [06:32<02:32,  1.33s/it] 72%|███████▏  | 297/411 [06:34<02:31,  1.33s/it] 73%|███████▎  | 298/411 [06:35<02:29,  1.33s/it] 73%|███████▎  | 299/411 [06:36<02:28,  1.33s/it] 73%|███████▎  | 300/411 [06:38<02:27,  1.33s/it]                                                  73%|███████▎  | 300/411 [06:38<02:27,  1.33s/it] 73%|███████▎  | 301/411 [06:39<02:25,  1.33s/it] 73%|███████▎  | 302/411 [06:40<02:24,  1.33s/it] 74%|███████▎  | 303/411 [06:41<02:23,  1.32s/it] 74%|███████▍  | 304/411 [06:43<02:21,  1.32s/it] 74%|███████▍  | 305/411 [06:44<02:20,  1.32s/it] 74%|███████▍  | 306/411 [06:45<02:19,  1.32s/it] 75%|███████▍  | 307/411 [06:47<02:17,  1.32s/it] 75%|███████▍  | 308/411 [06:48<02:16,  1.33s/it] 75%|███████▌  | 309/411 [06:49<02:15,  1.33s/it] 75%|███████▌  | 310/411 [06:51<02:13,  1.33s/it] 76%|███████▌  | 311/411 [06:52<02:12,  1.33s/it] 76%|███████▌  | 312/411 [06:53<02:11,  1.32s/it] 76%|███████▌  | 313/411 [06:55<02:09,  1.32s/it] 76%|███████▋  | 314/411 [06:56<02:08,  1.32s/it] 77%|███████▋  | 315/411 [06:57<02:07,  1.32s/it] 77%|███████▋  | 316/411 [06:59<02:05,  1.32s/it] 77%|███████▋  | 317/411 [07:00<02:04,  1.32s/it] 77%|███████▋  | 318/411 [07:01<02:03,  1.32s/it] 78%|███████▊  | 319/411 [07:03<02:01,  1.32s/it] 78%|███████▊  | 320/411 [07:04<02:00,  1.32s/it] 78%|███████▊  | 321/411 [07:05<01:59,  1.32s/it] 78%|███████▊  | 322/411 [07:07<01:57,  1.32s/it] 79%|███████▊  | 323/411 [07:08<01:56,  1.32s/it] 79%|███████▉  | 324/411 [07:09<01:55,  1.32s/it] 79%|███████▉  | 325/411 [07:11<01:53,  1.32s/it] 79%|███████▉  | 326/411 [07:12<01:52,  1.32s/it] 80%|███████▉  | 327/411 [07:13<01:51,  1.32s/it] 80%|███████▉  | 328/411 [07:15<01:49,  1.32s/it] 80%|████████  | 329/411 [07:16<01:48,  1.32s/it] 80%|████████  | 330/411 [07:17<01:47,  1.32s/it] 81%|████████  | 331/411 [07:19<01:45,  1.32s/it] 81%|████████  | 332/411 [07:20<01:44,  1.32s/it] 81%|████████  | 333/411 [07:21<01:43,  1.32s/it] 81%|████████▏ | 334/411 [07:23<01:42,  1.32s/it] 82%|████████▏ | 335/411 [07:24<01:40,  1.32s/it] 82%|████████▏ | 336/411 [07:25<01:39,  1.32s/it] 82%|████████▏ | 337/411 [07:27<01:38,  1.32s/it] 82%|████████▏ | 338/411 [07:28<01:36,  1.33s/it] 82%|████████▏ | 339/411 [07:29<01:35,  1.32s/it] 83%|████████▎ | 340/411 [07:31<01:34,  1.33s/it] 83%|████████▎ | 341/411 [07:32<01:32,  1.33s/it] 83%|████████▎ | 342/411 [07:33<01:31,  1.33s/it] 83%|████████▎ | 343/411 [07:34<01:30,  1.33s/it] 84%|████████▎ | 344/411 [07:36<01:28,  1.33s/it] 84%|████████▍ | 345/411 [07:37<01:27,  1.32s/it] 84%|████████▍ | 346/411 [07:38<01:26,  1.32s/it] 84%|████████▍ | 347/411 [07:40<01:24,  1.32s/it] 85%|████████▍ | 348/411 [07:41<01:23,  1.32s/it] 85%|████████▍ | 349/411 [07:42<01:22,  1.32s/it] 85%|████████▌ | 350/411 [07:44<01:20,  1.32s/it] 85%|████████▌ | 351/411 [07:45<01:19,  1.32s/it] 86%|████████▌ | 352/411 [07:46<01:18,  1.32s/it] 86%|████████▌ | 353/411 [07:48<01:16,  1.32s/it] 86%|████████▌ | 354/411 [07:49<01:15,  1.32s/it] 86%|████████▋ | 355/411 [07:50<01:14,  1.32s/it] 87%|████████▋ | 356/411 [07:52<01:12,  1.32s/it] 87%|████████▋ | 357/411 [07:53<01:11,  1.32s/it] 87%|████████▋ | 358/411 [07:54<01:10,  1.32s/it] 87%|████████▋ | 359/411 [07:56<01:08,  1.32s/it] 88%|████████▊ | 360/411 [07:57<01:07,  1.32s/it] 88%|████████▊ | 361/411 [07:58<01:06,  1.32s/it] 88%|████████▊ | 362/411 [08:00<01:04,  1.32s/it] 88%|████████▊ | 363/411 [08:01<01:03,  1.33s/it] 89%|████████▊ | 364/411 [08:02<01:02,  1.33s/it] 89%|████████▉ | 365/411 [08:04<01:01,  1.33s/it] 89%|████████▉ | 366/411 [08:05<00:59,  1.33s/it] 89%|████████▉ | 367/411 [08:06<00:58,  1.33s/it] 90%|████████▉ | 368/411 [08:08<00:57,  1.33s/it] 90%|████████▉ | 369/411 [08:09<00:55,  1.33s/it] 90%|█████████ | 370/411 [08:10<00:54,  1.33s/it] 90%|█████████ | 371/411 [08:12<00:53,  1.33s/it] 91%|█████████ | 372/411 [08:13<00:51,  1.33s/it] 91%|█████████ | 373/411 [08:14<00:50,  1.32s/it] 91%|█████████ | 374/411 [08:16<00:49,  1.32s/it] 91%|█████████ | 375/411 [08:17<00:47,  1.32s/it] 91%|█████████▏| 376/411 [08:18<00:46,  1.32s/it] 92%|█████████▏| 377/411 [08:20<00:45,  1.32s/it] 92%|█████████▏| 378/411 [08:21<00:43,  1.32s/it] 92%|█████████▏| 379/411 [08:22<00:42,  1.32s/it] 92%|█████████▏| 380/411 [08:24<00:41,  1.32s/it] 93%|█████████▎| 381/411 [08:25<00:39,  1.32s/it] 93%|█████████▎| 382/411 [08:26<00:38,  1.32s/it] 93%|█████████▎| 383/411 [08:27<00:37,  1.32s/it] 93%|█████████▎| 384/411 [08:29<00:35,  1.32s/it] 94%|█████████▎| 385/411 [08:30<00:34,  1.32s/it] 94%|█████████▍| 386/411 [08:31<00:33,  1.32s/it] 94%|█████████▍| 387/411 [08:33<00:31,  1.32s/it] 94%|█████████▍| 388/411 [08:34<00:30,  1.32s/it] 95%|█████████▍| 389/411 [08:35<00:29,  1.32s/it] 95%|█████████▍| 390/411 [08:37<00:27,  1.32s/it] 95%|█████████▌| 391/411 [08:38<00:26,  1.32s/it] 95%|█████████▌| 392/411 [08:39<00:25,  1.32s/it] 96%|█████████▌| 393/411 [08:41<00:23,  1.32s/it] 96%|█████████▌| 394/411 [08:42<00:22,  1.32s/it] 96%|█████████▌| 395/411 [08:43<00:21,  1.32s/it] 96%|█████████▋| 396/411 [08:45<00:19,  1.32s/it] 97%|█████████▋| 397/411 [08:46<00:18,  1.32s/it] 97%|█████████▋| 398/411 [08:47<00:17,  1.32s/it] 97%|█████████▋| 399/411 [08:49<00:15,  1.32s/it] 97%|█████████▋| 400/411 [08:50<00:14,  1.32s/it]                                                  97%|█████████▋| 400/411 [08:50<00:14,  1.32s/it] 98%|█████████▊| 401/411 [08:51<00:13,  1.32s/it] 98%|█████████▊| 402/411 [08:53<00:11,  1.32s/it] 98%|█████████▊| 403/411 [08:54<00:10,  1.32s/it] 98%|█████████▊| 404/411 [08:55<00:09,  1.32s/it] 99%|█████████▊| 405/411 [08:57<00:07,  1.32s/it] 99%|█████████▉| 406/411 [08:58<00:06,  1.32s/it] 99%|█████████▉| 407/411 [08:59<00:05,  1.32s/it] 99%|█████████▉| 408/411 [09:01<00:03,  1.33s/it]100%|█████████▉| 409/411 [09:02<00:02,  1.33s/it]100%|█████████▉| 410/411 [09:03<00:01,  1.33s/it]100%|██████████| 411/411 [09:04<00:00,  1.15s/it]/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x14d764ce9cf0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 81cd464e-0387-44ef-ac36-51b8832cc9d8)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                 100%|██████████| 411/411 [09:04<00:00,  1.15s/it]100%|██████████| 411/411 [09:04<00:00,  1.33s/it]
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x14d765a597b0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 7d6010c5-0216-4f75-9594-10e4e1f7ff5b)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'loss': 2.4894, 'grad_norm': 3.022763252258301, 'learning_rate': 1.51338199513382e-05, 'epoch': 0.24}
{'loss': 0.6575, 'grad_norm': 3.323615550994873, 'learning_rate': 1.0267639902676401e-05, 'epoch': 0.49}
{'loss': 0.3278, 'grad_norm': 3.7970988750457764, 'learning_rate': 5.401459854014599e-06, 'epoch': 0.73}
{'loss': 0.2904, 'grad_norm': 3.7511134147644043, 'learning_rate': 5.352798053527981e-07, 'epoch': 0.97}
{'train_runtime': 544.6982, 'train_samples_per_second': 3.015, 'train_steps_per_second': 0.755, 'train_loss': 0.923687523588937, 'epoch': 1.0}
Saving model to ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_prop_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_43
Fine-tuning completed successfully!
2025-05-01 15:53:13.306466: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 15:53:13.319620: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746129193.334223  299733 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746129193.338702  299733 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746129193.351296  299733 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746129193.351315  299733 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746129193.351318  299733 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746129193.351322  299733 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 15:53:13.355251: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
=== Fine-tuning Configuration ===
Model: 
Training dataset: 
Random seed: 36
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: 
===========================
CUDA available: True
CUDA device count: 1
CUDA current device: 0
CUDA device name: NVIDIA A100 80GB PCIe MIG 3g.40gb
train_config(model_name='meta-llama/Llama-3.2-3B-Instruct', enable_fsdp=False, low_cpu_fsdp=False, run_validation=True, batch_size_training=4, gradient_accumulation_steps=1, num_epochs=1, num_workers_dataloader=1, lr=2e-05, weight_decay=0.0, gamma=0.85, seed=43, use_fp16=False, mixed_precision=True, val_batch_size=1, peft_method='lora', use_peft=False, output_dir='../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_true_prop_var/meta-llama/Llama-3.2-3B-Instruct_43', freeze_layers=False, num_freeze_layers=1, quantization=True, one_gpu=False, save_model=True, save_every_epoch=True, dist_checkpoint_root_folder='fsdp', dist_checkpoint_folder='fine-tuned', save_optimizer=False, use_fast_kernels=False, use_lora=True, save_full_gradients=False, system_message='You are a helpful assistant. Provide your best guess or estimate given the scenario. Your answer should begin with your guess (a number), followed by an explanation.', ft_dataset_name='no_bias_true_prop_var', dataset='datasets/ft/no_bias_true_prop_var.jsonl', eval_dataset_name='bbq_subset_100', eval_dataset=None, eval_output_file=None, base_output_file=None)
Clearing GPU cache
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.53s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Applying LoRA adapter...
trainable params: 2,293,760 || all params: 3,215,046,656 || trainable%: 0.0713
Loading data from datasets/ft/no_bias_true_prop_var.jsonl...
Using all 2880 examples from dataset
Map:   0%|          | 0/2880 [00:00<?, ? examples/s]Map:  90%|█████████ | 2605/2880 [00:00<00:00, 25921.23 examples/s]Map: 100%|██████████| 2880/2880 [00:00<00:00, 25518.24 examples/s]
Map:   0%|          | 0/2880 [00:00<?, ? examples/s]Map:  35%|███▍      | 1000/2880 [00:00<00:00, 2332.51 examples/s]Map:  69%|██████▉   | 2000/2880 [00:00<00:00, 2431.65 examples/s]Map: 100%|██████████| 2880/2880 [00:01<00:00, 2472.84 examples/s]Map: 100%|██████████| 2880/2880 [00:01<00:00, 2431.47 examples/s]
/home/janeec/FairTune/finetune_w_eval_llama.py:297: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
=== Fine-tuning Configuration ===
Model: meta-llama/Llama-3.2-3B-Instruct
Training dataset: datasets/ft/no_bias_true_prop_var.jsonl
Random seed: 43
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_true_prop_var/meta-llama/Llama-3.2-3B-Instruct_43
===========================
SEED CHECK:, should be: 43, seed is: 43
Starting fine-tuning...
  0%|          | 0/720 [00:00<?, ?it/s]  0%|          | 1/720 [00:01<18:55,  1.58s/it]  0%|          | 2/720 [00:02<17:10,  1.44s/it]  0%|          | 3/720 [00:04<16:33,  1.39s/it]  1%|          | 4/720 [00:05<16:15,  1.36s/it]  1%|          | 5/720 [00:06<16:04,  1.35s/it]  1%|          | 6/720 [00:08<15:58,  1.34s/it]  1%|          | 7/720 [00:09<15:53,  1.34s/it]  1%|          | 8/720 [00:10<15:49,  1.33s/it]  1%|▏         | 9/720 [00:12<15:46,  1.33s/it]  1%|▏         | 10/720 [00:13<15:44,  1.33s/it]  2%|▏         | 11/720 [00:14<15:42,  1.33s/it]  2%|▏         | 12/720 [00:16<15:40,  1.33s/it]  2%|▏         | 13/720 [00:17<15:38,  1.33s/it]  2%|▏         | 14/720 [00:18<15:36,  1.33s/it]  2%|▏         | 15/720 [00:20<15:35,  1.33s/it]  2%|▏         | 16/720 [00:21<15:34,  1.33s/it]  2%|▏         | 17/720 [00:22<15:32,  1.33s/it]  2%|▎         | 18/720 [00:24<15:31,  1.33s/it]  3%|▎         | 19/720 [00:25<15:30,  1.33s/it]  3%|▎         | 20/720 [00:26<15:28,  1.33s/it]  3%|▎         | 21/720 [00:28<15:27,  1.33s/it]  3%|▎         | 22/720 [00:29<15:26,  1.33s/it]  3%|▎         | 23/720 [00:30<15:24,  1.33s/it]  3%|▎         | 24/720 [00:32<15:23,  1.33s/it]  3%|▎         | 25/720 [00:33<15:21,  1.33s/it]  4%|▎         | 26/720 [00:34<15:20,  1.33s/it]  4%|▍         | 27/720 [00:36<15:18,  1.33s/it]  4%|▍         | 28/720 [00:37<15:17,  1.33s/it]  4%|▍         | 29/720 [00:38<15:16,  1.33s/it]  4%|▍         | 30/720 [00:40<15:15,  1.33s/it]  4%|▍         | 31/720 [00:41<15:13,  1.33s/it]  4%|▍         | 32/720 [00:42<15:12,  1.33s/it]  5%|▍         | 33/720 [00:44<15:11,  1.33s/it]  5%|▍         | 34/720 [00:45<15:09,  1.33s/it]  5%|▍         | 35/720 [00:46<15:08,  1.33s/it]  5%|▌         | 36/720 [00:48<15:07,  1.33s/it]  5%|▌         | 37/720 [00:49<15:06,  1.33s/it]  5%|▌         | 38/720 [00:50<15:04,  1.33s/it]  5%|▌         | 39/720 [00:51<15:03,  1.33s/it]  6%|▌         | 40/720 [00:53<15:02,  1.33s/it]  6%|▌         | 41/720 [00:54<15:00,  1.33s/it]  6%|▌         | 42/720 [00:55<14:59,  1.33s/it]  6%|▌         | 43/720 [00:57<14:58,  1.33s/it]  6%|▌         | 44/720 [00:58<14:56,  1.33s/it]  6%|▋         | 45/720 [00:59<14:55,  1.33s/it]  6%|▋         | 46/720 [01:01<14:54,  1.33s/it]  7%|▋         | 47/720 [01:02<14:57,  1.33s/it]  7%|▋         | 48/720 [01:03<14:55,  1.33s/it]  7%|▋         | 49/720 [01:05<14:52,  1.33s/it]  7%|▋         | 50/720 [01:06<14:50,  1.33s/it]  7%|▋         | 51/720 [01:07<14:48,  1.33s/it]  7%|▋         | 52/720 [01:09<14:47,  1.33s/it]  7%|▋         | 53/720 [01:10<14:45,  1.33s/it]  8%|▊         | 54/720 [01:11<14:44,  1.33s/it]  8%|▊         | 55/720 [01:13<14:43,  1.33s/it]  8%|▊         | 56/720 [01:14<14:41,  1.33s/it]  8%|▊         | 57/720 [01:15<14:39,  1.33s/it]  8%|▊         | 58/720 [01:17<14:38,  1.33s/it]  8%|▊         | 59/720 [01:18<14:36,  1.33s/it]  8%|▊         | 60/720 [01:19<14:35,  1.33s/it]  8%|▊         | 61/720 [01:21<14:34,  1.33s/it]  9%|▊         | 62/720 [01:22<14:32,  1.33s/it]  9%|▉         | 63/720 [01:23<14:31,  1.33s/it]  9%|▉         | 64/720 [01:25<14:29,  1.33s/it]  9%|▉         | 65/720 [01:26<14:28,  1.33s/it]  9%|▉         | 66/720 [01:27<14:27,  1.33s/it]  9%|▉         | 67/720 [01:29<14:25,  1.33s/it]  9%|▉         | 68/720 [01:30<14:24,  1.33s/it] 10%|▉         | 69/720 [01:31<14:23,  1.33s/it] 10%|▉         | 70/720 [01:33<14:21,  1.33s/it] 10%|▉         | 71/720 [01:34<14:20,  1.33s/it] 10%|█         | 72/720 [01:35<14:19,  1.33s/it] 10%|█         | 73/720 [01:37<14:17,  1.33s/it] 10%|█         | 74/720 [01:38<14:16,  1.33s/it] 10%|█         | 75/720 [01:39<14:15,  1.33s/it] 11%|█         | 76/720 [01:41<14:14,  1.33s/it] 11%|█         | 77/720 [01:42<14:12,  1.33s/it] 11%|█         | 78/720 [01:43<14:11,  1.33s/it] 11%|█         | 79/720 [01:45<14:10,  1.33s/it] 11%|█         | 80/720 [01:46<14:08,  1.33s/it] 11%|█▏        | 81/720 [01:47<14:07,  1.33s/it] 11%|█▏        | 82/720 [01:49<14:06,  1.33s/it] 12%|█▏        | 83/720 [01:50<14:04,  1.33s/it] 12%|█▏        | 84/720 [01:51<14:03,  1.33s/it] 12%|█▏        | 85/720 [01:53<14:01,  1.33s/it] 12%|█▏        | 86/720 [01:54<14:00,  1.33s/it] 12%|█▏        | 87/720 [01:55<13:59,  1.33s/it] 12%|█▏        | 88/720 [01:57<13:57,  1.33s/it] 12%|█▏        | 89/720 [01:58<13:56,  1.33s/it] 12%|█▎        | 90/720 [01:59<13:55,  1.33s/it] 13%|█▎        | 91/720 [02:00<13:54,  1.33s/it] 13%|█▎        | 92/720 [02:02<13:52,  1.33s/it] 13%|█▎        | 93/720 [02:03<13:51,  1.33s/it] 13%|█▎        | 94/720 [02:04<13:50,  1.33s/it] 13%|█▎        | 95/720 [02:06<13:48,  1.33s/it] 13%|█▎        | 96/720 [02:07<13:47,  1.33s/it] 13%|█▎        | 97/720 [02:08<13:46,  1.33s/it] 14%|█▎        | 98/720 [02:10<13:44,  1.33s/it] 14%|█▍        | 99/720 [02:11<13:43,  1.33s/it] 14%|█▍        | 100/720 [02:12<13:42,  1.33s/it]                                                  14%|█▍        | 100/720 [02:12<13:42,  1.33s/it] 14%|█▍        | 101/720 [02:14<13:40,  1.33s/it] 14%|█▍        | 102/720 [02:15<13:39,  1.33s/it] 14%|█▍        | 103/720 [02:16<13:37,  1.33s/it] 14%|█▍        | 104/720 [02:18<13:36,  1.33s/it] 15%|█▍        | 105/720 [02:19<13:35,  1.33s/it] 15%|█▍        | 106/720 [02:20<13:33,  1.33s/it] 15%|█▍        | 107/720 [02:22<13:32,  1.33s/it] 15%|█▌        | 108/720 [02:23<13:31,  1.33s/it] 15%|█▌        | 109/720 [02:24<13:29,  1.33s/it] 15%|█▌        | 110/720 [02:26<13:28,  1.33s/it] 15%|█▌        | 111/720 [02:27<13:27,  1.33s/it] 16%|█▌        | 112/720 [02:28<13:26,  1.33s/it] 16%|█▌        | 113/720 [02:30<13:24,  1.33s/it] 16%|█▌        | 114/720 [02:31<13:23,  1.33s/it] 16%|█▌        | 115/720 [02:32<13:23,  1.33s/it] 16%|█▌        | 116/720 [02:34<13:21,  1.33s/it] 16%|█▋        | 117/720 [02:35<13:19,  1.33s/it] 16%|█▋        | 118/720 [02:36<13:18,  1.33s/it] 17%|█▋        | 119/720 [02:38<13:16,  1.33s/it] 17%|█▋        | 120/720 [02:39<13:15,  1.33s/it] 17%|█▋        | 121/720 [02:40<13:14,  1.33s/it] 17%|█▋        | 122/720 [02:42<13:12,  1.33s/it] 17%|█▋        | 123/720 [02:43<13:11,  1.33s/it] 17%|█▋        | 124/720 [02:44<13:10,  1.33s/it] 17%|█▋        | 125/720 [02:46<13:08,  1.33s/it] 18%|█▊        | 126/720 [02:47<13:07,  1.33s/it] 18%|█▊        | 127/720 [02:48<13:06,  1.33s/it] 18%|█▊        | 128/720 [02:50<13:04,  1.33s/it] 18%|█▊        | 129/720 [02:51<13:03,  1.33s/it] 18%|█▊        | 130/720 [02:52<13:02,  1.33s/it] 18%|█▊        | 131/720 [02:54<13:00,  1.33s/it] 18%|█▊        | 132/720 [02:55<12:59,  1.33s/it] 18%|█▊        | 133/720 [02:56<12:58,  1.33s/it] 19%|█▊        | 134/720 [02:57<12:56,  1.33s/it] 19%|█▉        | 135/720 [02:59<12:55,  1.33s/it] 19%|█▉        | 136/720 [03:00<12:53,  1.33s/it] 19%|█▉        | 137/720 [03:01<12:52,  1.33s/it] 19%|█▉        | 138/720 [03:03<12:51,  1.32s/it] 19%|█▉        | 139/720 [03:04<12:49,  1.33s/it] 19%|█▉        | 140/720 [03:05<12:48,  1.33s/it] 20%|█▉        | 141/720 [03:07<12:47,  1.33s/it] 20%|█▉        | 142/720 [03:08<12:45,  1.33s/it] 20%|█▉        | 143/720 [03:09<12:44,  1.33s/it] 20%|██        | 144/720 [03:11<12:43,  1.33s/it] 20%|██        | 145/720 [03:12<12:41,  1.33s/it] 20%|██        | 146/720 [03:13<12:40,  1.33s/it] 20%|██        | 147/720 [03:15<12:39,  1.33s/it] 21%|██        | 148/720 [03:16<12:38,  1.33s/it] 21%|██        | 149/720 [03:17<12:36,  1.33s/it] 21%|██        | 150/720 [03:19<12:35,  1.33s/it] 21%|██        | 151/720 [03:20<12:34,  1.33s/it] 21%|██        | 152/720 [03:21<12:32,  1.33s/it] 21%|██▏       | 153/720 [03:23<12:31,  1.33s/it] 21%|██▏       | 154/720 [03:24<12:30,  1.33s/it] 22%|██▏       | 155/720 [03:25<12:28,  1.33s/it] 22%|██▏       | 156/720 [03:27<12:27,  1.33s/it] 22%|██▏       | 157/720 [03:28<12:26,  1.33s/it] 22%|██▏       | 158/720 [03:29<12:24,  1.33s/it] 22%|██▏       | 159/720 [03:31<12:23,  1.33s/it] 22%|██▏       | 160/720 [03:32<12:23,  1.33s/it] 22%|██▏       | 161/720 [03:33<12:21,  1.33s/it] 22%|██▎       | 162/720 [03:35<12:20,  1.33s/it] 23%|██▎       | 163/720 [03:36<12:18,  1.33s/it] 23%|██▎       | 164/720 [03:37<12:17,  1.33s/it] 23%|██▎       | 165/720 [03:39<12:15,  1.33s/it] 23%|██▎       | 166/720 [03:40<12:14,  1.33s/it] 23%|██▎       | 167/720 [03:41<12:13,  1.33s/it] 23%|██▎       | 168/720 [03:43<12:11,  1.33s/it] 23%|██▎       | 169/720 [03:44<12:10,  1.33s/it] 24%|██▎       | 170/720 [03:45<12:09,  1.33s/it] 24%|██▍       | 171/720 [03:47<12:08,  1.33s/it] 24%|██▍       | 172/720 [03:48<12:06,  1.33s/it] 24%|██▍       | 173/720 [03:49<12:05,  1.33s/it] 24%|██▍       | 174/720 [03:51<12:04,  1.33s/it] 24%|██▍       | 175/720 [03:52<12:03,  1.33s/it] 24%|██▍       | 176/720 [03:53<12:01,  1.33s/it] 25%|██▍       | 177/720 [03:55<12:00,  1.33s/it] 25%|██▍       | 178/720 [03:56<11:59,  1.33s/it] 25%|██▍       | 179/720 [03:57<11:57,  1.33s/it] 25%|██▌       | 180/720 [03:58<11:56,  1.33s/it] 25%|██▌       | 181/720 [04:00<11:54,  1.33s/it] 25%|██▌       | 182/720 [04:01<11:53,  1.33s/it] 25%|██▌       | 183/720 [04:02<11:52,  1.33s/it] 26%|██▌       | 184/720 [04:04<11:50,  1.33s/it] 26%|██▌       | 185/720 [04:05<11:49,  1.33s/it] 26%|██▌       | 186/720 [04:06<11:47,  1.33s/it] 26%|██▌       | 187/720 [04:08<11:46,  1.33s/it] 26%|██▌       | 188/720 [04:09<11:45,  1.33s/it] 26%|██▋       | 189/720 [04:10<11:44,  1.33s/it] 26%|██▋       | 190/720 [04:12<11:42,  1.33s/it] 27%|██▋       | 191/720 [04:13<11:41,  1.33s/it] 27%|██▋       | 192/720 [04:14<11:40,  1.33s/it] 27%|██▋       | 193/720 [04:16<11:39,  1.33s/it] 27%|██▋       | 194/720 [04:17<11:37,  1.33s/it] 27%|██▋       | 195/720 [04:18<11:36,  1.33s/it] 27%|██▋       | 196/720 [04:20<11:35,  1.33s/it] 27%|██▋       | 197/720 [04:21<11:33,  1.33s/it] 28%|██▊       | 198/720 [04:22<11:32,  1.33s/it] 28%|██▊       | 199/720 [04:24<11:30,  1.33s/it] 28%|██▊       | 200/720 [04:25<11:29,  1.33s/it]                                                  28%|██▊       | 200/720 [04:25<11:29,  1.33s/it] 28%|██▊       | 201/720 [04:26<11:28,  1.33s/it] 28%|██▊       | 202/720 [04:28<11:27,  1.33s/it] 28%|██▊       | 203/720 [04:29<11:25,  1.33s/it] 28%|██▊       | 204/720 [04:30<11:24,  1.33s/it] 28%|██▊       | 205/720 [04:32<11:22,  1.33s/it] 29%|██▊       | 206/720 [04:33<11:21,  1.33s/it] 29%|██▉       | 207/720 [04:34<11:20,  1.33s/it] 29%|██▉       | 208/720 [04:36<11:18,  1.33s/it] 29%|██▉       | 209/720 [04:37<11:17,  1.33s/it] 29%|██▉       | 210/720 [04:38<11:16,  1.33s/it] 29%|██▉       | 211/720 [04:40<11:14,  1.33s/it] 29%|██▉       | 212/720 [04:41<11:13,  1.33s/it] 30%|██▉       | 213/720 [04:42<11:12,  1.33s/it] 30%|██▉       | 214/720 [04:44<11:10,  1.33s/it] 30%|██▉       | 215/720 [04:45<11:09,  1.33s/it] 30%|███       | 216/720 [04:46<11:07,  1.33s/it] 30%|███       | 217/720 [04:48<11:06,  1.33s/it] 30%|███       | 218/720 [04:49<11:05,  1.33s/it] 30%|███       | 219/720 [04:50<11:04,  1.33s/it] 31%|███       | 220/720 [04:52<11:02,  1.33s/it] 31%|███       | 221/720 [04:53<11:01,  1.33s/it] 31%|███       | 222/720 [04:54<11:00,  1.33s/it] 31%|███       | 223/720 [04:56<10:59,  1.33s/it] 31%|███       | 224/720 [04:57<10:57,  1.33s/it] 31%|███▏      | 225/720 [04:58<10:56,  1.33s/it] 31%|███▏      | 226/720 [04:59<10:55,  1.33s/it] 32%|███▏      | 227/720 [05:01<10:53,  1.33s/it] 32%|███▏      | 228/720 [05:02<10:53,  1.33s/it] 32%|███▏      | 229/720 [05:03<10:52,  1.33s/it] 32%|███▏      | 230/720 [05:05<10:50,  1.33s/it] 32%|███▏      | 231/720 [05:06<10:49,  1.33s/it] 32%|███▏      | 232/720 [05:07<10:47,  1.33s/it] 32%|███▏      | 233/720 [05:09<10:46,  1.33s/it] 32%|███▎      | 234/720 [05:10<10:45,  1.33s/it] 33%|███▎      | 235/720 [05:11<10:43,  1.33s/it] 33%|███▎      | 236/720 [05:13<10:42,  1.33s/it] 33%|███▎      | 237/720 [05:14<10:40,  1.33s/it] 33%|███▎      | 238/720 [05:15<10:39,  1.33s/it] 33%|███▎      | 239/720 [05:17<10:38,  1.33s/it] 33%|███▎      | 240/720 [05:18<10:36,  1.33s/it] 33%|███▎      | 241/720 [05:19<10:35,  1.33s/it] 34%|███▎      | 242/720 [05:21<10:33,  1.33s/it] 34%|███▍      | 243/720 [05:22<10:32,  1.33s/it] 34%|███▍      | 244/720 [05:23<10:31,  1.33s/it] 34%|███▍      | 245/720 [05:25<10:29,  1.33s/it] 34%|███▍      | 246/720 [05:26<10:28,  1.33s/it] 34%|███▍      | 247/720 [05:27<10:27,  1.33s/it] 34%|███▍      | 248/720 [05:29<10:25,  1.33s/it] 35%|███▍      | 249/720 [05:30<10:24,  1.33s/it] 35%|███▍      | 250/720 [05:31<10:23,  1.33s/it] 35%|███▍      | 251/720 [05:33<10:21,  1.33s/it] 35%|███▌      | 252/720 [05:34<10:20,  1.33s/it] 35%|███▌      | 253/720 [05:35<10:18,  1.33s/it] 35%|███▌      | 254/720 [05:37<10:17,  1.33s/it] 35%|███▌      | 255/720 [05:38<10:16,  1.33s/it] 36%|███▌      | 256/720 [05:39<10:15,  1.33s/it] 36%|███▌      | 257/720 [05:41<10:13,  1.33s/it] 36%|███▌      | 258/720 [05:42<10:12,  1.33s/it] 36%|███▌      | 259/720 [05:43<10:10,  1.33s/it] 36%|███▌      | 260/720 [05:45<10:09,  1.33s/it] 36%|███▋      | 261/720 [05:46<10:08,  1.33s/it] 36%|███▋      | 262/720 [05:47<10:07,  1.33s/it] 37%|███▋      | 263/720 [05:49<10:05,  1.33s/it] 37%|███▋      | 264/720 [05:50<10:04,  1.33s/it] 37%|███▋      | 265/720 [05:51<10:03,  1.33s/it] 37%|███▋      | 266/720 [05:53<10:01,  1.33s/it] 37%|███▋      | 267/720 [05:54<10:00,  1.33s/it] 37%|███▋      | 268/720 [05:55<09:59,  1.33s/it] 37%|███▋      | 269/720 [05:57<09:57,  1.33s/it] 38%|███▊      | 270/720 [05:58<09:56,  1.33s/it] 38%|███▊      | 271/720 [05:59<09:55,  1.33s/it] 38%|███▊      | 272/720 [06:00<09:53,  1.33s/it] 38%|███▊      | 273/720 [06:02<09:52,  1.33s/it] 38%|███▊      | 274/720 [06:03<09:51,  1.33s/it] 38%|███▊      | 275/720 [06:04<09:50,  1.33s/it] 38%|███▊      | 276/720 [06:06<09:48,  1.33s/it] 38%|███▊      | 277/720 [06:07<09:47,  1.33s/it] 39%|███▊      | 278/720 [06:08<09:45,  1.33s/it] 39%|███▉      | 279/720 [06:10<09:44,  1.33s/it] 39%|███▉      | 280/720 [06:11<09:43,  1.33s/it] 39%|███▉      | 281/720 [06:12<09:41,  1.33s/it] 39%|███▉      | 282/720 [06:14<09:40,  1.33s/it] 39%|███▉      | 283/720 [06:15<09:39,  1.33s/it] 39%|███▉      | 284/720 [06:16<09:37,  1.33s/it] 40%|███▉      | 285/720 [06:18<09:36,  1.33s/it] 40%|███▉      | 286/720 [06:19<09:35,  1.33s/it] 40%|███▉      | 287/720 [06:20<09:33,  1.33s/it] 40%|████      | 288/720 [06:22<09:32,  1.33s/it] 40%|████      | 289/720 [06:23<09:31,  1.33s/it] 40%|████      | 290/720 [06:24<09:29,  1.33s/it] 40%|████      | 291/720 [06:26<09:28,  1.33s/it] 41%|████      | 292/720 [06:27<09:27,  1.33s/it] 41%|████      | 293/720 [06:28<09:25,  1.32s/it] 41%|████      | 294/720 [06:30<09:24,  1.32s/it] 41%|████      | 295/720 [06:31<09:23,  1.32s/it] 41%|████      | 296/720 [06:32<09:22,  1.33s/it] 41%|████▏     | 297/720 [06:34<09:21,  1.33s/it] 41%|████▏     | 298/720 [06:35<09:19,  1.33s/it] 42%|████▏     | 299/720 [06:36<09:18,  1.33s/it] 42%|████▏     | 300/720 [06:38<09:16,  1.33s/it]                                                  42%|████▏     | 300/720 [06:38<09:16,  1.33s/it] 42%|████▏     | 301/720 [06:39<09:15,  1.33s/it] 42%|████▏     | 302/720 [06:40<09:14,  1.33s/it] 42%|████▏     | 303/720 [06:42<09:12,  1.33s/it] 42%|████▏     | 304/720 [06:43<09:11,  1.33s/it] 42%|████▏     | 305/720 [06:44<09:10,  1.33s/it] 42%|████▎     | 306/720 [06:46<09:08,  1.33s/it] 43%|████▎     | 307/720 [06:47<09:07,  1.33s/it] 43%|████▎     | 308/720 [06:48<09:05,  1.33s/it] 43%|████▎     | 309/720 [06:50<09:04,  1.32s/it] 43%|████▎     | 310/720 [06:51<09:03,  1.33s/it] 43%|████▎     | 311/720 [06:52<09:01,  1.32s/it] 43%|████▎     | 312/720 [06:54<09:00,  1.32s/it] 43%|████▎     | 313/720 [06:55<08:59,  1.32s/it] 44%|████▎     | 314/720 [06:56<08:57,  1.32s/it] 44%|████▍     | 315/720 [06:57<08:56,  1.32s/it] 44%|████▍     | 316/720 [06:59<08:55,  1.32s/it] 44%|████▍     | 317/720 [07:00<08:53,  1.33s/it] 44%|████▍     | 318/720 [07:01<08:52,  1.33s/it] 44%|████▍     | 319/720 [07:03<08:51,  1.32s/it] 44%|████▍     | 320/720 [07:04<08:50,  1.33s/it] 45%|████▍     | 321/720 [07:05<08:49,  1.33s/it] 45%|████▍     | 322/720 [07:07<08:47,  1.33s/it] 45%|████▍     | 323/720 [07:08<08:46,  1.33s/it] 45%|████▌     | 324/720 [07:09<08:45,  1.33s/it] 45%|████▌     | 325/720 [07:11<08:43,  1.33s/it] 45%|████▌     | 326/720 [07:12<08:42,  1.33s/it] 45%|████▌     | 327/720 [07:13<08:40,  1.33s/it] 46%|████▌     | 328/720 [07:15<08:39,  1.33s/it] 46%|████▌     | 329/720 [07:16<08:38,  1.33s/it] 46%|████▌     | 330/720 [07:17<08:36,  1.33s/it] 46%|████▌     | 331/720 [07:19<08:35,  1.33s/it] 46%|████▌     | 332/720 [07:20<08:34,  1.33s/it] 46%|████▋     | 333/720 [07:21<08:32,  1.33s/it] 46%|████▋     | 334/720 [07:23<08:31,  1.33s/it] 47%|████▋     | 335/720 [07:24<08:30,  1.33s/it] 47%|████▋     | 336/720 [07:25<08:29,  1.33s/it] 47%|████▋     | 337/720 [07:27<08:27,  1.33s/it] 47%|████▋     | 338/720 [07:28<08:26,  1.33s/it] 47%|████▋     | 339/720 [07:29<08:25,  1.33s/it] 47%|████▋     | 340/720 [07:31<08:23,  1.33s/it] 47%|████▋     | 341/720 [07:32<08:23,  1.33s/it] 48%|████▊     | 342/720 [07:33<08:21,  1.33s/it] 48%|████▊     | 343/720 [07:35<08:20,  1.33s/it] 48%|████▊     | 344/720 [07:36<08:18,  1.33s/it] 48%|████▊     | 345/720 [07:37<08:17,  1.33s/it] 48%|████▊     | 346/720 [07:39<08:15,  1.32s/it] 48%|████▊     | 347/720 [07:40<08:14,  1.32s/it] 48%|████▊     | 348/720 [07:41<08:12,  1.33s/it] 48%|████▊     | 349/720 [07:43<08:11,  1.33s/it] 49%|████▊     | 350/720 [07:44<08:10,  1.32s/it] 49%|████▉     | 351/720 [07:45<08:08,  1.32s/it] 49%|████▉     | 352/720 [07:47<08:07,  1.32s/it] 49%|████▉     | 353/720 [07:48<08:06,  1.32s/it] 49%|████▉     | 354/720 [07:49<08:04,  1.32s/it] 49%|████▉     | 355/720 [07:51<08:03,  1.32s/it] 49%|████▉     | 356/720 [07:52<08:02,  1.32s/it] 50%|████▉     | 357/720 [07:53<08:00,  1.32s/it] 50%|████▉     | 358/720 [07:54<07:59,  1.32s/it] 50%|████▉     | 359/720 [07:56<07:58,  1.32s/it] 50%|█████     | 360/720 [07:57<07:56,  1.32s/it] 50%|█████     | 361/720 [07:58<07:55,  1.32s/it] 50%|█████     | 362/720 [08:00<07:54,  1.32s/it] 50%|█████     | 363/720 [08:01<07:52,  1.32s/it] 51%|█████     | 364/720 [08:02<07:51,  1.32s/it] 51%|█████     | 365/720 [08:04<07:50,  1.32s/it] 51%|█████     | 366/720 [08:05<07:48,  1.32s/it] 51%|█████     | 367/720 [08:06<07:47,  1.32s/it] 51%|█████     | 368/720 [08:08<07:46,  1.32s/it] 51%|█████▏    | 369/720 [08:09<07:45,  1.32s/it] 51%|█████▏    | 370/720 [08:10<07:43,  1.32s/it] 52%|█████▏    | 371/720 [08:12<07:42,  1.32s/it] 52%|█████▏    | 372/720 [08:13<07:40,  1.32s/it] 52%|█████▏    | 373/720 [08:14<07:39,  1.32s/it] 52%|█████▏    | 374/720 [08:16<07:38,  1.32s/it] 52%|█████▏    | 375/720 [08:17<07:36,  1.32s/it] 52%|█████▏    | 376/720 [08:18<07:35,  1.32s/it] 52%|█████▏    | 377/720 [08:20<07:34,  1.32s/it] 52%|█████▎    | 378/720 [08:21<07:33,  1.32s/it] 53%|█████▎    | 379/720 [08:22<07:31,  1.32s/it] 53%|█████▎    | 380/720 [08:24<07:30,  1.32s/it] 53%|█████▎    | 381/720 [08:25<07:28,  1.32s/it] 53%|█████▎    | 382/720 [08:26<07:27,  1.32s/it] 53%|█████▎    | 383/720 [08:28<07:26,  1.32s/it] 53%|█████▎    | 384/720 [08:29<07:25,  1.33s/it] 53%|█████▎    | 385/720 [08:30<07:23,  1.32s/it] 54%|█████▎    | 386/720 [08:32<07:22,  1.32s/it] 54%|█████▍    | 387/720 [08:33<07:21,  1.32s/it] 54%|█████▍    | 388/720 [08:34<07:19,  1.32s/it] 54%|█████▍    | 389/720 [08:36<07:18,  1.32s/it] 54%|█████▍    | 390/720 [08:37<07:17,  1.32s/it] 54%|█████▍    | 391/720 [08:38<07:15,  1.32s/it] 54%|█████▍    | 392/720 [08:40<07:14,  1.32s/it] 55%|█████▍    | 393/720 [08:41<07:13,  1.32s/it] 55%|█████▍    | 394/720 [08:42<07:11,  1.32s/it] 55%|█████▍    | 395/720 [08:43<07:10,  1.32s/it] 55%|█████▌    | 396/720 [08:45<07:09,  1.32s/it] 55%|█████▌    | 397/720 [08:46<07:07,  1.32s/it] 55%|█████▌    | 398/720 [08:47<07:06,  1.32s/it] 55%|█████▌    | 399/720 [08:49<07:05,  1.32s/it] 56%|█████▌    | 400/720 [08:50<07:03,  1.32s/it]                                                  56%|█████▌    | 400/720 [08:50<07:03,  1.32s/it] 56%|█████▌    | 401/720 [08:51<07:02,  1.32s/it] 56%|█████▌    | 402/720 [08:53<07:01,  1.33s/it] 56%|█████▌    | 403/720 [08:54<06:59,  1.32s/it] 56%|█████▌    | 404/720 [08:55<06:58,  1.32s/it] 56%|█████▋    | 405/720 [08:57<06:57,  1.32s/it] 56%|█████▋    | 406/720 [08:58<06:55,  1.32s/it] 57%|█████▋    | 407/720 [08:59<06:54,  1.32s/it] 57%|█████▋    | 408/720 [09:01<06:53,  1.32s/it] 57%|█████▋    | 409/720 [09:02<06:53,  1.33s/it] 57%|█████▋    | 410/720 [09:03<06:51,  1.33s/it] 57%|█████▋    | 411/720 [09:05<06:49,  1.33s/it] 57%|█████▋    | 412/720 [09:06<06:48,  1.33s/it] 57%|█████▋    | 413/720 [09:07<06:46,  1.33s/it] 57%|█████▊    | 414/720 [09:09<06:45,  1.33s/it] 58%|█████▊    | 415/720 [09:10<06:44,  1.32s/it] 58%|█████▊    | 416/720 [09:11<06:42,  1.32s/it] 58%|█████▊    | 417/720 [09:13<06:41,  1.32s/it] 58%|█████▊    | 418/720 [09:14<06:40,  1.32s/it] 58%|█████▊    | 419/720 [09:15<06:38,  1.32s/it] 58%|█████▊    | 420/720 [09:17<06:37,  1.32s/it] 58%|█████▊    | 421/720 [09:18<06:35,  1.32s/it] 59%|█████▊    | 422/720 [09:19<06:34,  1.32s/it] 59%|█████▉    | 423/720 [09:21<06:33,  1.32s/it] 59%|█████▉    | 424/720 [09:22<06:32,  1.32s/it] 59%|█████▉    | 425/720 [09:23<06:30,  1.32s/it] 59%|█████▉    | 426/720 [09:25<06:29,  1.32s/it] 59%|█████▉    | 427/720 [09:26<06:28,  1.32s/it] 59%|█████▉    | 428/720 [09:27<06:26,  1.32s/it] 60%|█████▉    | 429/720 [09:29<06:25,  1.32s/it] 60%|█████▉    | 430/720 [09:30<06:24,  1.32s/it] 60%|█████▉    | 431/720 [09:31<06:22,  1.32s/it] 60%|██████    | 432/720 [09:33<06:21,  1.32s/it] 60%|██████    | 433/720 [09:34<06:20,  1.32s/it] 60%|██████    | 434/720 [09:35<06:18,  1.32s/it] 60%|██████    | 435/720 [09:36<06:17,  1.32s/it] 61%|██████    | 436/720 [09:38<06:15,  1.32s/it] 61%|██████    | 437/720 [09:39<06:14,  1.32s/it] 61%|██████    | 438/720 [09:40<06:13,  1.32s/it] 61%|██████    | 439/720 [09:42<06:12,  1.32s/it] 61%|██████    | 440/720 [09:43<06:10,  1.32s/it] 61%|██████▏   | 441/720 [09:44<06:09,  1.32s/it] 61%|██████▏   | 442/720 [09:46<06:08,  1.32s/it] 62%|██████▏   | 443/720 [09:47<06:06,  1.32s/it] 62%|██████▏   | 444/720 [09:48<06:05,  1.32s/it] 62%|██████▏   | 445/720 [09:50<06:04,  1.32s/it] 62%|██████▏   | 446/720 [09:51<06:02,  1.32s/it] 62%|██████▏   | 447/720 [09:52<06:01,  1.32s/it] 62%|██████▏   | 448/720 [09:54<06:00,  1.32s/it] 62%|██████▏   | 449/720 [09:55<05:58,  1.32s/it] 62%|██████▎   | 450/720 [09:56<05:57,  1.32s/it] 63%|██████▎   | 451/720 [09:58<05:56,  1.32s/it] 63%|██████▎   | 452/720 [09:59<05:54,  1.32s/it] 63%|██████▎   | 453/720 [10:00<05:53,  1.32s/it] 63%|██████▎   | 454/720 [10:02<05:52,  1.32s/it] 63%|██████▎   | 455/720 [10:03<05:51,  1.32s/it] 63%|██████▎   | 456/720 [10:04<05:49,  1.32s/it] 63%|██████▎   | 457/720 [10:06<05:48,  1.32s/it] 64%|██████▎   | 458/720 [10:07<05:47,  1.32s/it] 64%|██████▍   | 459/720 [10:08<05:45,  1.32s/it] 64%|██████▍   | 460/720 [10:10<05:44,  1.32s/it] 64%|██████▍   | 461/720 [10:11<05:42,  1.32s/it] 64%|██████▍   | 462/720 [10:12<05:41,  1.32s/it] 64%|██████▍   | 463/720 [10:14<05:40,  1.32s/it] 64%|██████▍   | 464/720 [10:15<05:38,  1.32s/it] 65%|██████▍   | 465/720 [10:16<05:37,  1.32s/it] 65%|██████▍   | 466/720 [10:18<05:36,  1.33s/it] 65%|██████▍   | 467/720 [10:19<05:35,  1.33s/it] 65%|██████▌   | 468/720 [10:20<05:33,  1.33s/it] 65%|██████▌   | 469/720 [10:22<05:32,  1.32s/it] 65%|██████▌   | 470/720 [10:23<05:31,  1.32s/it] 65%|██████▌   | 471/720 [10:24<05:29,  1.32s/it] 66%|██████▌   | 472/720 [10:25<05:28,  1.32s/it] 66%|██████▌   | 473/720 [10:27<05:27,  1.32s/it] 66%|██████▌   | 474/720 [10:28<05:25,  1.32s/it] 66%|██████▌   | 475/720 [10:29<05:24,  1.32s/it] 66%|██████▌   | 476/720 [10:31<05:23,  1.32s/it] 66%|██████▋   | 477/720 [10:32<05:22,  1.33s/it] 66%|██████▋   | 478/720 [10:33<05:20,  1.33s/it] 67%|██████▋   | 479/720 [10:35<05:19,  1.33s/it] 67%|██████▋   | 480/720 [10:36<05:18,  1.33s/it] 67%|██████▋   | 481/720 [10:37<05:16,  1.32s/it] 67%|██████▋   | 482/720 [10:39<05:15,  1.32s/it] 67%|██████▋   | 483/720 [10:40<05:13,  1.32s/it] 67%|██████▋   | 484/720 [10:41<05:12,  1.32s/it] 67%|██████▋   | 485/720 [10:43<05:11,  1.32s/it] 68%|██████▊   | 486/720 [10:44<05:09,  1.32s/it] 68%|██████▊   | 487/720 [10:45<05:08,  1.32s/it] 68%|██████▊   | 488/720 [10:47<05:07,  1.32s/it] 68%|██████▊   | 489/720 [10:48<05:05,  1.32s/it] 68%|██████▊   | 490/720 [10:49<05:04,  1.32s/it] 68%|██████▊   | 491/720 [10:51<05:03,  1.32s/it] 68%|██████▊   | 492/720 [10:52<05:01,  1.32s/it] 68%|██████▊   | 493/720 [10:53<05:00,  1.32s/it] 69%|██████▊   | 494/720 [10:55<04:59,  1.32s/it] 69%|██████▉   | 495/720 [10:56<04:57,  1.32s/it] 69%|██████▉   | 496/720 [10:57<04:56,  1.32s/it] 69%|██████▉   | 497/720 [10:59<04:55,  1.32s/it] 69%|██████▉   | 498/720 [11:00<04:54,  1.32s/it] 69%|██████▉   | 499/720 [11:01<04:52,  1.32s/it] 69%|██████▉   | 500/720 [11:03<04:51,  1.32s/it]                                                  69%|██████▉   | 500/720 [11:03<04:51,  1.32s/it] 70%|██████▉   | 501/720 [11:04<04:50,  1.32s/it] 70%|██████▉   | 502/720 [11:05<04:48,  1.32s/it] 70%|██████▉   | 503/720 [11:07<04:47,  1.32s/it] 70%|███████   | 504/720 [11:08<04:46,  1.32s/it] 70%|███████   | 505/720 [11:09<04:44,  1.32s/it] 70%|███████   | 506/720 [11:11<04:43,  1.32s/it] 70%|███████   | 507/720 [11:12<04:42,  1.32s/it] 71%|███████   | 508/720 [11:13<04:40,  1.32s/it] 71%|███████   | 509/720 [11:14<04:39,  1.32s/it] 71%|███████   | 510/720 [11:16<04:38,  1.32s/it] 71%|███████   | 511/720 [11:17<04:36,  1.32s/it] 71%|███████   | 512/720 [11:18<04:35,  1.32s/it] 71%|███████▏  | 513/720 [11:20<04:34,  1.32s/it] 71%|███████▏  | 514/720 [11:21<04:32,  1.32s/it] 72%|███████▏  | 515/720 [11:22<04:31,  1.32s/it] 72%|███████▏  | 516/720 [11:24<04:30,  1.32s/it] 72%|███████▏  | 517/720 [11:25<04:28,  1.32s/it] 72%|███████▏  | 518/720 [11:26<04:27,  1.32s/it] 72%|███████▏  | 519/720 [11:28<04:26,  1.32s/it] 72%|███████▏  | 520/720 [11:29<04:25,  1.33s/it] 72%|███████▏  | 521/720 [11:30<04:23,  1.33s/it] 72%|███████▎  | 522/720 [11:32<04:22,  1.33s/it] 73%|███████▎  | 523/720 [11:33<04:21,  1.33s/it] 73%|███████▎  | 524/720 [11:34<04:19,  1.33s/it] 73%|███████▎  | 525/720 [11:36<04:18,  1.33s/it] 73%|███████▎  | 526/720 [11:37<04:17,  1.33s/it] 73%|███████▎  | 527/720 [11:38<04:15,  1.32s/it] 73%|███████▎  | 528/720 [11:40<04:14,  1.32s/it] 73%|███████▎  | 529/720 [11:41<04:13,  1.32s/it] 74%|███████▎  | 530/720 [11:42<04:11,  1.32s/it] 74%|███████▍  | 531/720 [11:44<04:10,  1.32s/it] 74%|███████▍  | 532/720 [11:45<04:08,  1.32s/it] 74%|███████▍  | 533/720 [11:46<04:07,  1.32s/it] 74%|███████▍  | 534/720 [11:48<04:06,  1.32s/it] 74%|███████▍  | 535/720 [11:49<04:05,  1.32s/it] 74%|███████▍  | 536/720 [11:50<04:03,  1.32s/it] 75%|███████▍  | 537/720 [11:52<04:02,  1.32s/it] 75%|███████▍  | 538/720 [11:53<04:01,  1.32s/it] 75%|███████▍  | 539/720 [11:54<03:59,  1.32s/it] 75%|███████▌  | 540/720 [11:56<03:58,  1.32s/it] 75%|███████▌  | 541/720 [11:57<03:57,  1.32s/it] 75%|███████▌  | 542/720 [11:58<03:55,  1.32s/it] 75%|███████▌  | 543/720 [12:00<03:54,  1.32s/it] 76%|███████▌  | 544/720 [12:01<03:53,  1.32s/it] 76%|███████▌  | 545/720 [12:02<03:52,  1.33s/it] 76%|███████▌  | 546/720 [12:04<03:50,  1.33s/it] 76%|███████▌  | 547/720 [12:05<03:49,  1.33s/it] 76%|███████▌  | 548/720 [12:06<03:47,  1.32s/it] 76%|███████▋  | 549/720 [12:07<03:46,  1.32s/it] 76%|███████▋  | 550/720 [12:09<03:45,  1.32s/it] 77%|███████▋  | 551/720 [12:10<03:43,  1.32s/it] 77%|███████▋  | 552/720 [12:11<03:42,  1.32s/it] 77%|███████▋  | 553/720 [12:13<03:41,  1.32s/it] 77%|███████▋  | 554/720 [12:14<03:39,  1.32s/it] 77%|███████▋  | 555/720 [12:15<03:38,  1.32s/it] 77%|███████▋  | 556/720 [12:17<03:37,  1.32s/it] 77%|███████▋  | 557/720 [12:18<03:35,  1.32s/it] 78%|███████▊  | 558/720 [12:19<03:34,  1.32s/it] 78%|███████▊  | 559/720 [12:21<03:33,  1.32s/it] 78%|███████▊  | 560/720 [12:22<03:31,  1.32s/it] 78%|███████▊  | 561/720 [12:23<03:30,  1.32s/it] 78%|███████▊  | 562/720 [12:25<03:29,  1.32s/it] 78%|███████▊  | 563/720 [12:26<03:27,  1.32s/it] 78%|███████▊  | 564/720 [12:27<03:26,  1.32s/it] 78%|███████▊  | 565/720 [12:29<03:25,  1.32s/it] 79%|███████▊  | 566/720 [12:30<03:23,  1.32s/it] 79%|███████▉  | 567/720 [12:31<03:22,  1.32s/it] 79%|███████▉  | 568/720 [12:33<03:21,  1.32s/it] 79%|███████▉  | 569/720 [12:34<03:30,  1.39s/it] 79%|███████▉  | 570/720 [12:36<03:25,  1.37s/it] 79%|███████▉  | 571/720 [12:37<03:22,  1.36s/it] 79%|███████▉  | 572/720 [12:38<03:19,  1.35s/it] 80%|███████▉  | 573/720 [12:39<03:17,  1.34s/it] 80%|███████▉  | 574/720 [12:41<03:15,  1.34s/it] 80%|███████▉  | 575/720 [12:42<03:13,  1.33s/it] 80%|████████  | 576/720 [12:43<03:11,  1.33s/it] 80%|████████  | 577/720 [12:45<03:09,  1.33s/it] 80%|████████  | 578/720 [12:46<03:08,  1.33s/it] 80%|████████  | 579/720 [12:47<03:06,  1.33s/it] 81%|████████  | 580/720 [12:49<03:05,  1.33s/it] 81%|████████  | 581/720 [12:50<03:04,  1.33s/it] 81%|████████  | 582/720 [12:51<03:02,  1.33s/it] 81%|████████  | 583/720 [12:53<03:01,  1.32s/it] 81%|████████  | 584/720 [12:54<03:00,  1.32s/it] 81%|████████▏ | 585/720 [12:55<02:58,  1.32s/it] 81%|████████▏ | 586/720 [12:57<02:57,  1.32s/it] 82%|████████▏ | 587/720 [12:58<02:56,  1.32s/it] 82%|████████▏ | 588/720 [12:59<02:54,  1.32s/it] 82%|████████▏ | 589/720 [13:01<02:53,  1.32s/it] 82%|████████▏ | 590/720 [13:02<02:52,  1.33s/it] 82%|████████▏ | 591/720 [13:03<02:51,  1.33s/it] 82%|████████▏ | 592/720 [13:05<02:49,  1.33s/it] 82%|████████▏ | 593/720 [13:06<02:48,  1.33s/it] 82%|████████▎ | 594/720 [13:07<02:46,  1.32s/it] 83%|████████▎ | 595/720 [13:09<02:45,  1.32s/it] 83%|████████▎ | 596/720 [13:10<02:44,  1.32s/it] 83%|████████▎ | 597/720 [13:11<02:42,  1.32s/it] 83%|████████▎ | 598/720 [13:13<02:41,  1.32s/it] 83%|████████▎ | 599/720 [13:14<02:40,  1.32s/it] 83%|████████▎ | 600/720 [13:15<02:38,  1.32s/it]                                                  83%|████████▎ | 600/720 [13:15<02:38,  1.32s/it] 83%|████████▎ | 601/720 [13:17<02:37,  1.32s/it] 84%|████████▎ | 602/720 [13:18<02:36,  1.32s/it] 84%|████████▍ | 603/720 [13:19<02:35,  1.32s/it] 84%|████████▍ | 604/720 [13:21<02:33,  1.33s/it] 84%|████████▍ | 605/720 [13:22<02:32,  1.32s/it] 84%|████████▍ | 606/720 [13:23<02:31,  1.32s/it] 84%|████████▍ | 607/720 [13:25<02:29,  1.32s/it] 84%|████████▍ | 608/720 [13:26<02:28,  1.32s/it] 85%|████████▍ | 609/720 [13:27<02:27,  1.32s/it] 85%|████████▍ | 610/720 [13:29<02:25,  1.32s/it] 85%|████████▍ | 611/720 [13:30<02:24,  1.32s/it] 85%|████████▌ | 612/720 [13:31<02:23,  1.32s/it] 85%|████████▌ | 613/720 [13:32<02:21,  1.32s/it] 85%|████████▌ | 614/720 [13:34<02:20,  1.32s/it] 85%|████████▌ | 615/720 [13:35<02:19,  1.32s/it] 86%|████████▌ | 616/720 [13:36<02:17,  1.32s/it] 86%|████████▌ | 617/720 [13:38<02:16,  1.32s/it] 86%|████████▌ | 618/720 [13:39<02:15,  1.32s/it] 86%|████████▌ | 619/720 [13:40<02:13,  1.32s/it] 86%|████████▌ | 620/720 [13:42<02:12,  1.32s/it] 86%|████████▋ | 621/720 [13:43<02:11,  1.32s/it] 86%|████████▋ | 622/720 [13:44<02:09,  1.32s/it] 87%|████████▋ | 623/720 [13:46<02:08,  1.32s/it] 87%|████████▋ | 624/720 [13:47<02:07,  1.32s/it] 87%|████████▋ | 625/720 [13:48<02:05,  1.32s/it] 87%|████████▋ | 626/720 [13:50<02:04,  1.32s/it] 87%|████████▋ | 627/720 [13:51<02:03,  1.32s/it] 87%|████████▋ | 628/720 [13:52<02:01,  1.32s/it] 87%|████████▋ | 629/720 [13:54<02:00,  1.32s/it] 88%|████████▊ | 630/720 [13:55<01:59,  1.32s/it] 88%|████████▊ | 631/720 [13:56<01:57,  1.32s/it] 88%|████████▊ | 632/720 [13:58<01:56,  1.32s/it] 88%|████████▊ | 633/720 [13:59<01:55,  1.32s/it] 88%|████████▊ | 634/720 [14:00<01:53,  1.32s/it] 88%|████████▊ | 635/720 [14:02<01:52,  1.32s/it] 88%|████████▊ | 636/720 [14:03<01:51,  1.32s/it] 88%|████████▊ | 637/720 [14:04<01:49,  1.32s/it] 89%|████████▊ | 638/720 [14:06<01:48,  1.32s/it] 89%|████████▉ | 639/720 [14:07<01:47,  1.32s/it] 89%|████████▉ | 640/720 [14:08<01:45,  1.32s/it] 89%|████████▉ | 641/720 [14:10<01:44,  1.32s/it] 89%|████████▉ | 642/720 [14:11<01:43,  1.32s/it] 89%|████████▉ | 643/720 [14:12<01:41,  1.32s/it] 89%|████████▉ | 644/720 [14:14<01:40,  1.32s/it] 90%|████████▉ | 645/720 [14:15<01:39,  1.32s/it] 90%|████████▉ | 646/720 [14:16<01:38,  1.32s/it] 90%|████████▉ | 647/720 [14:18<01:36,  1.32s/it] 90%|█████████ | 648/720 [14:19<01:35,  1.32s/it] 90%|█████████ | 649/720 [14:20<01:34,  1.32s/it] 90%|█████████ | 650/720 [14:21<01:32,  1.32s/it] 90%|█████████ | 651/720 [14:23<01:31,  1.32s/it] 91%|█████████ | 652/720 [14:24<01:30,  1.32s/it] 91%|█████████ | 653/720 [14:25<01:28,  1.32s/it] 91%|█████████ | 654/720 [14:27<01:27,  1.32s/it] 91%|█████████ | 655/720 [14:28<01:26,  1.32s/it] 91%|█████████ | 656/720 [14:29<01:24,  1.32s/it] 91%|█████████▏| 657/720 [14:31<01:23,  1.32s/it] 91%|█████████▏| 658/720 [14:32<01:22,  1.33s/it] 92%|█████████▏| 659/720 [14:33<01:20,  1.33s/it] 92%|█████████▏| 660/720 [14:35<01:19,  1.33s/it] 92%|█████████▏| 661/720 [14:36<01:18,  1.32s/it] 92%|█████████▏| 662/720 [14:37<01:16,  1.32s/it] 92%|█████████▏| 663/720 [14:39<01:15,  1.32s/it] 92%|█████████▏| 664/720 [14:40<01:14,  1.32s/it] 92%|█████████▏| 665/720 [14:41<01:12,  1.32s/it] 92%|█████████▎| 666/720 [14:43<01:11,  1.32s/it] 93%|█████████▎| 667/720 [14:44<01:10,  1.32s/it] 93%|█████████▎| 668/720 [14:45<01:08,  1.32s/it] 93%|█████████▎| 669/720 [14:47<01:07,  1.32s/it] 93%|█████████▎| 670/720 [14:48<01:06,  1.32s/it] 93%|█████████▎| 671/720 [14:49<01:04,  1.32s/it] 93%|█████████▎| 672/720 [14:51<01:03,  1.32s/it] 93%|█████████▎| 673/720 [14:52<01:02,  1.32s/it] 94%|█████████▎| 674/720 [14:53<01:00,  1.32s/it] 94%|█████████▍| 675/720 [14:55<00:59,  1.32s/it] 94%|█████████▍| 676/720 [14:56<00:58,  1.32s/it] 94%|█████████▍| 677/720 [14:57<00:56,  1.32s/it] 94%|█████████▍| 678/720 [14:59<00:55,  1.32s/it] 94%|█████████▍| 679/720 [15:00<00:54,  1.32s/it] 94%|█████████▍| 680/720 [15:01<00:52,  1.32s/it] 95%|█████████▍| 681/720 [15:03<00:51,  1.32s/it] 95%|█████████▍| 682/720 [15:04<00:50,  1.32s/it] 95%|█████████▍| 683/720 [15:05<00:49,  1.32s/it] 95%|█████████▌| 684/720 [15:07<00:47,  1.32s/it] 95%|█████████▌| 685/720 [15:08<00:46,  1.32s/it] 95%|█████████▌| 686/720 [15:09<00:45,  1.32s/it] 95%|█████████▌| 687/720 [15:10<00:43,  1.32s/it] 96%|█████████▌| 688/720 [15:12<00:42,  1.32s/it] 96%|█████████▌| 689/720 [15:13<00:41,  1.32s/it] 96%|█████████▌| 690/720 [15:14<00:39,  1.32s/it] 96%|█████████▌| 691/720 [15:16<00:38,  1.32s/it] 96%|█████████▌| 692/720 [15:17<00:37,  1.32s/it] 96%|█████████▋| 693/720 [15:18<00:35,  1.32s/it] 96%|█████████▋| 694/720 [15:20<00:34,  1.32s/it] 97%|█████████▋| 695/720 [15:21<00:33,  1.32s/it] 97%|█████████▋| 696/720 [15:22<00:31,  1.32s/it] 97%|█████████▋| 697/720 [15:24<00:30,  1.32s/it] 97%|█████████▋| 698/720 [15:25<00:29,  1.32s/it] 97%|█████████▋| 699/720 [15:26<00:27,  1.32s/it] 97%|█████████▋| 700/720 [15:28<00:26,  1.32s/it]                                                  97%|█████████▋| 700/720 [15:28<00:26,  1.32s/it] 97%|█████████▋| 701/720 [15:29<00:25,  1.32s/it] 98%|█████████▊| 702/720 [15:30<00:23,  1.32s/it] 98%|█████████▊| 703/720 [15:32<00:22,  1.32s/it] 98%|█████████▊| 704/720 [15:33<00:21,  1.32s/it] 98%|█████████▊| 705/720 [15:34<00:19,  1.32s/it] 98%|█████████▊| 706/720 [15:36<00:18,  1.32s/it] 98%|█████████▊| 707/720 [15:37<00:17,  1.32s/it] 98%|█████████▊| 708/720 [15:38<00:15,  1.32s/it] 98%|█████████▊| 709/720 [15:40<00:14,  1.32s/it] 99%|█████████▊| 710/720 [15:41<00:13,  1.32s/it] 99%|█████████▉| 711/720 [15:42<00:11,  1.32s/it] 99%|█████████▉| 712/720 [15:44<00:10,  1.32s/it] 99%|█████████▉| 713/720 [15:45<00:09,  1.32s/it] 99%|█████████▉| 714/720 [15:46<00:07,  1.32s/it] 99%|█████████▉| 715/720 [15:48<00:06,  1.32s/it] 99%|█████████▉| 716/720 [15:49<00:05,  1.32s/it]100%|█████████▉| 717/720 [15:50<00:03,  1.32s/it]100%|█████████▉| 718/720 [15:52<00:02,  1.32s/it]100%|█████████▉| 719/720 [15:53<00:01,  1.32s/it]100%|██████████| 720/720 [15:54<00:00,  1.32s/it]/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1511e0605ab0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 2a49cb12-b3b7-438d-a7df-134e79034449)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                 100%|██████████| 720/720 [15:54<00:00,  1.32s/it]100%|██████████| 720/720 [15:54<00:00,  1.33s/it]
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1511e064d360>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 01b42eab-513d-4b82-8e25-147f4c5fb093)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'loss': 2.5029, 'grad_norm': 3.028714656829834, 'learning_rate': 1.7250000000000003e-05, 'epoch': 0.14}
{'loss': 0.62, 'grad_norm': 2.0854759216308594, 'learning_rate': 1.4472222222222223e-05, 'epoch': 0.28}
{'loss': 0.3769, 'grad_norm': 2.9940543174743652, 'learning_rate': 1.1694444444444447e-05, 'epoch': 0.42}
{'loss': 0.349, 'grad_norm': 2.732814311981201, 'learning_rate': 8.916666666666667e-06, 'epoch': 0.56}
{'loss': 0.3317, 'grad_norm': 2.92629337310791, 'learning_rate': 6.13888888888889e-06, 'epoch': 0.69}
{'loss': 0.3211, 'grad_norm': 3.4504761695861816, 'learning_rate': 3.3611111111111117e-06, 'epoch': 0.83}
{'loss': 0.3179, 'grad_norm': 2.4057345390319824, 'learning_rate': 5.833333333333334e-07, 'epoch': 0.97}
{'train_runtime': 954.877, 'train_samples_per_second': 3.016, 'train_steps_per_second': 0.754, 'train_loss': 0.6781234237882826, 'epoch': 1.0}
Saving model to ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_true_prop_var/meta-llama/Llama-3.2-3B-Instruct_43
Fine-tuning completed successfully!
end finetuning 43
start evaling: seed  43
2025-05-01 16:09:34.481305: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 16:09:34.496206: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746130174.511982  301950 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746130174.516796  301950 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746130174.529868  301950 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746130174.529890  301950 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746130174.529893  301950 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746130174.529894  301950 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 16:09:34.533968: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.03s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.45s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Model type: llama
Tokenizer type: PreTrainedTokenizerFast
CWD at runtime: /home/janeec/FairTune
Loading from FTing on: no_bias_constant_var_prop_rep
Model loaded.
Collecting responses:
Generating sample 1/1
Sample 1:   0%|          | 0/45 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   2%|▏         | 1/45 [00:21<15:39, 21.36s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   4%|▍         | 2/45 [00:42<15:10, 21.19s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   7%|▋         | 3/45 [01:03<14:42, 21.01s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   9%|▉         | 4/45 [01:23<14:16, 20.90s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  11%|█         | 5/45 [01:45<13:58, 20.96s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  13%|█▎        | 6/45 [02:05<13:35, 20.90s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  16%|█▌        | 7/45 [02:26<13:13, 20.87s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  18%|█▊        | 8/45 [02:47<12:50, 20.83s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  20%|██        | 9/45 [03:08<12:28, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  22%|██▏       | 10/45 [03:28<12:08, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  24%|██▍       | 11/45 [03:49<11:46, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  27%|██▋       | 12/45 [04:10<11:22, 20.68s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  29%|██▉       | 13/45 [04:30<11:03, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  31%|███       | 14/45 [04:51<10:42, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  33%|███▎      | 15/45 [05:12<10:19, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  36%|███▌      | 16/45 [05:32<09:58, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  38%|███▊      | 17/45 [05:53<09:38, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  40%|████      | 18/45 [06:14<09:17, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  42%|████▏     | 19/45 [06:34<08:55, 20.60s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  44%|████▍     | 20/45 [06:55<08:35, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  47%|████▋     | 21/45 [07:15<08:15, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  49%|████▉     | 22/45 [07:36<07:54, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  51%|█████     | 23/45 [07:57<07:34, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  53%|█████▎    | 24/45 [08:17<07:13, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  56%|█████▌    | 25/45 [08:38<06:53, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  58%|█████▊    | 26/45 [08:59<06:32, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  60%|██████    | 27/45 [09:19<06:10, 20.60s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  62%|██████▏   | 28/45 [09:40<05:50, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  64%|██████▍   | 29/45 [10:01<05:30, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  67%|██████▋   | 30/45 [10:21<05:08, 20.59s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  69%|██████▉   | 31/45 [10:42<04:48, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  71%|███████   | 32/45 [11:03<04:29, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  73%|███████▎  | 33/45 [11:23<04:08, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  76%|███████▌  | 34/45 [11:44<03:47, 20.70s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  78%|███████▊  | 35/45 [12:05<03:27, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  80%|████████  | 36/45 [12:26<03:06, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  82%|████████▏ | 37/45 [12:46<02:45, 20.75s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  84%|████████▍ | 38/45 [13:07<02:25, 20.75s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  87%|████████▋ | 39/45 [13:28<02:04, 20.75s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  89%|████████▉ | 40/45 [13:49<01:43, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  91%|█████████ | 41/45 [14:09<01:23, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  93%|█████████▎| 42/45 [14:30<01:02, 20.67s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  96%|█████████▌| 43/45 [14:51<00:41, 20.71s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  98%|█████████▊| 44/45 [15:11<00:20, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.64s/it]Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.72s/it]
  scenario  ... prompt_id
0   hiring  ...         1
1   hiring  ...         1
2   hiring  ...         1
3   hiring  ...         1
4   hiring  ...         1

[5 rows x 9 columns]
Responses saved to: results/no_bias_constant_var_prop_rep/Llama-3.2-3B-Instruct_salinas_expanded_context_43.csv
2025-05-01 16:25:28.671333: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 16:25:28.686304: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746131128.702070  304057 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746131128.706907  304057 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746131128.720055  304057 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746131128.720078  304057 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746131128.720080  304057 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746131128.720082  304057 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 16:25:28.724258: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.06s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.55s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Model type: llama
Tokenizer type: PreTrainedTokenizerFast
CWD at runtime: /home/janeec/FairTune
Loading from FTing on: no_bias_prop_var_prop_rep
Model loaded.
Collecting responses:
Generating sample 1/1
Sample 1:   0%|          | 0/45 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   2%|▏         | 1/45 [00:21<15:34, 21.24s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   4%|▍         | 2/45 [00:42<15:08, 21.14s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   7%|▋         | 3/45 [01:03<14:41, 20.99s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   9%|▉         | 4/45 [01:23<14:16, 20.89s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  11%|█         | 5/45 [01:44<13:57, 20.95s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  13%|█▎        | 6/45 [02:05<13:35, 20.90s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  16%|█▌        | 7/45 [02:26<13:12, 20.87s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  18%|█▊        | 8/45 [02:47<12:50, 20.83s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  20%|██        | 9/45 [03:07<12:28, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  22%|██▏       | 10/45 [03:28<12:07, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  24%|██▍       | 11/45 [03:49<11:46, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  27%|██▋       | 12/45 [04:09<11:22, 20.68s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  29%|██▉       | 13/45 [04:30<11:02, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  31%|███       | 14/45 [04:51<10:42, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  33%|███▎      | 15/45 [05:11<10:19, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  36%|███▌      | 16/45 [05:32<09:58, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  38%|███▊      | 17/45 [05:53<09:38, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  40%|████      | 18/45 [06:13<09:17, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  42%|████▏     | 19/45 [06:34<08:55, 20.60s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  44%|████▍     | 20/45 [06:55<08:35, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  47%|████▋     | 21/45 [07:15<08:15, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  49%|████▉     | 22/45 [07:36<07:54, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  51%|█████     | 23/45 [07:57<07:33, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  53%|█████▎    | 24/45 [08:17<07:13, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  56%|█████▌    | 25/45 [08:38<06:53, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  58%|█████▊    | 26/45 [08:59<06:32, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  60%|██████    | 27/45 [09:19<06:10, 20.60s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  62%|██████▏   | 28/45 [09:40<05:50, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  64%|██████▍   | 29/45 [10:00<05:30, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  67%|██████▋   | 30/45 [10:21<05:08, 20.59s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  69%|██████▉   | 31/45 [10:42<04:48, 20.62s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  71%|███████   | 32/45 [11:02<04:29, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  73%|███████▎  | 33/45 [11:23<04:08, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  76%|███████▌  | 34/45 [11:44<03:47, 20.69s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  78%|███████▊  | 35/45 [12:05<03:27, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  80%|████████  | 36/45 [12:26<03:06, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  82%|████████▏ | 37/45 [12:46<02:45, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  84%|████████▍ | 38/45 [13:07<02:25, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  87%|████████▋ | 39/45 [13:28<02:04, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  89%|████████▉ | 40/45 [13:48<01:43, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  91%|█████████ | 41/45 [14:09<01:23, 20.75s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  93%|█████████▎| 42/45 [14:30<01:01, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  96%|█████████▌| 43/45 [14:51<00:41, 20.71s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  98%|█████████▊| 44/45 [15:11<00:20, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.64s/it]Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.72s/it]
  scenario  ... prompt_id
0   hiring  ...         1
1   hiring  ...         1
2   hiring  ...         1
3   hiring  ...         1
4   hiring  ...         1

[5 rows x 9 columns]
Responses saved to: results/no_bias_prop_var_prop_rep/Llama-3.2-3B-Instruct_salinas_expanded_context_43.csv
2025-05-01 16:41:22.898188: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 16:41:22.912812: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746132082.928584  306605 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746132082.933417  306605 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746132082.946609  306605 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746132082.946630  306605 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746132082.946632  306605 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746132082.946634  306605 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 16:41:22.950774: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.79s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.98s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Model type: llama
Tokenizer type: PreTrainedTokenizerFast
CWD at runtime: /home/janeec/FairTune
Loading from FTing on: no_bias_true_prop_var
Model loaded.
Collecting responses:
Generating sample 1/1
Sample 1:   0%|          | 0/45 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   2%|▏         | 1/45 [00:21<15:34, 21.24s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   4%|▍         | 2/45 [00:42<15:09, 21.14s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   7%|▋         | 3/45 [01:03<14:41, 20.99s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   9%|▉         | 4/45 [01:23<14:16, 20.90s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  11%|█         | 5/45 [01:44<13:58, 20.96s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  13%|█▎        | 6/45 [02:05<13:35, 20.91s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  16%|█▌        | 7/45 [02:26<13:13, 20.88s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  18%|█▊        | 8/45 [02:47<12:50, 20.83s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  20%|██        | 9/45 [03:08<12:28, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  22%|██▏       | 10/45 [03:28<12:08, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  24%|██▍       | 11/45 [03:49<11:46, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  27%|██▋       | 12/45 [04:10<11:22, 20.69s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  29%|██▉       | 13/45 [04:30<11:03, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  31%|███       | 14/45 [04:51<10:42, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  33%|███▎      | 15/45 [05:12<10:19, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  36%|███▌      | 16/45 [05:32<09:58, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  38%|███▊      | 17/45 [05:53<09:38, 20.67s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  40%|████      | 18/45 [06:14<09:17, 20.67s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  42%|████▏     | 19/45 [06:34<08:55, 20.61s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  44%|████▍     | 20/45 [06:55<08:36, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  47%|████▋     | 21/45 [07:15<08:15, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  49%|████▉     | 22/45 [07:36<07:55, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  51%|█████     | 23/45 [07:57<07:34, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  53%|█████▎    | 24/45 [08:17<07:13, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  56%|█████▌    | 25/45 [08:38<06:53, 20.67s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  58%|█████▊    | 26/45 [08:59<06:32, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  60%|██████    | 27/45 [09:19<06:11, 20.61s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  62%|██████▏   | 28/45 [09:40<05:50, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  64%|██████▍   | 29/45 [10:01<05:30, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  67%|██████▋   | 30/45 [10:21<05:08, 20.59s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  69%|██████▉   | 31/45 [10:42<04:48, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  71%|███████   | 32/45 [11:03<04:29, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  73%|███████▎  | 33/45 [11:24<04:08, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  76%|███████▌  | 34/45 [11:44<03:47, 20.70s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  78%|███████▊  | 35/45 [12:05<03:27, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  80%|████████  | 36/45 [12:26<03:06, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  82%|████████▏ | 37/45 [12:47<02:45, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  84%|████████▍ | 38/45 [13:07<02:25, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  87%|████████▋ | 39/45 [13:28<02:04, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  89%|████████▉ | 40/45 [13:49<01:43, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  91%|█████████ | 41/45 [14:10<01:23, 20.75s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  93%|█████████▎| 42/45 [14:30<01:01, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  96%|█████████▌| 43/45 [14:51<00:41, 20.70s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  98%|█████████▊| 44/45 [15:12<00:20, 20.71s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.63s/it]Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.72s/it]
  scenario  ... prompt_id
0   hiring  ...         1
1   hiring  ...         1
2   hiring  ...         1
3   hiring  ...         1
4   hiring  ...         1

[5 rows x 9 columns]
Responses saved to: results/no_bias_true_prop_var/Llama-3.2-3B-Instruct_salinas_expanded_context_43.csv
end eval 43
start finetuning: seed  58
2025-05-01 16:57:09.000241: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 16:57:09.013617: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746133029.028791  309083 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746133029.033382  309083 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746133029.046142  309083 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746133029.046161  309083 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746133029.046163  309083 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746133029.046164  309083 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 16:57:09.050036: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
=== Fine-tuning Configuration ===
Model: 
Training dataset: 
Random seed: 36
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: 
===========================
CUDA available: True
CUDA device count: 1
CUDA current device: 0
CUDA device name: NVIDIA A100 80GB PCIe MIG 3g.40gb
train_config(model_name='meta-llama/Llama-3.2-3B-Instruct', enable_fsdp=False, low_cpu_fsdp=False, run_validation=True, batch_size_training=4, gradient_accumulation_steps=1, num_epochs=1, num_workers_dataloader=1, lr=2e-05, weight_decay=0.0, gamma=0.85, seed=58, use_fp16=False, mixed_precision=True, val_batch_size=1, peft_method='lora', use_peft=False, output_dir='../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_constant_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_58', freeze_layers=False, num_freeze_layers=1, quantization=True, one_gpu=False, save_model=True, save_every_epoch=True, dist_checkpoint_root_folder='fsdp', dist_checkpoint_folder='fine-tuned', save_optimizer=False, use_fast_kernels=False, use_lora=True, save_full_gradients=False, system_message='You are a helpful assistant. Provide your best guess or estimate given the scenario. Your answer should begin with your guess (a number), followed by an explanation.', ft_dataset_name='no_bias_constant_var_prop_rep', dataset='datasets/ft/no_bias_constant_var_prop_rep.jsonl', eval_dataset_name='bbq_subset_100', eval_dataset=None, eval_output_file=None, base_output_file=None)
Clearing GPU cache
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.55s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Applying LoRA adapter...
trainable params: 2,293,760 || all params: 3,215,046,656 || trainable%: 0.0713
Loading data from datasets/ft/no_bias_constant_var_prop_rep.jsonl...
Using all 1642 examples from dataset
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 26349.30 examples/s]
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map:  61%|██████    | 1000/1642 [00:00<00:00, 2359.58 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2414.33 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2380.08 examples/s]
/home/janeec/FairTune/finetune_w_eval_llama.py:297: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
=== Fine-tuning Configuration ===
Model: meta-llama/Llama-3.2-3B-Instruct
Training dataset: datasets/ft/no_bias_constant_var_prop_rep.jsonl
Random seed: 58
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_constant_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_58
===========================
SEED CHECK:, should be: 58, seed is: 58
Starting fine-tuning...
  0%|          | 0/411 [00:00<?, ?it/s]  0%|          | 1/411 [00:01<10:24,  1.52s/it]  0%|          | 2/411 [00:02<09:36,  1.41s/it]  1%|          | 3/411 [00:04<09:19,  1.37s/it]  1%|          | 4/411 [00:05<09:11,  1.35s/it]  1%|          | 5/411 [00:06<09:05,  1.34s/it]  1%|▏         | 6/411 [00:08<09:02,  1.34s/it]  2%|▏         | 7/411 [00:09<08:59,  1.33s/it]  2%|▏         | 8/411 [00:10<08:56,  1.33s/it]  2%|▏         | 9/411 [00:12<08:54,  1.33s/it]  2%|▏         | 10/411 [00:13<08:53,  1.33s/it]  3%|▎         | 11/411 [00:14<08:51,  1.33s/it]  3%|▎         | 12/411 [00:16<08:49,  1.33s/it]  3%|▎         | 13/411 [00:17<08:48,  1.33s/it]  3%|▎         | 14/411 [00:18<08:46,  1.33s/it]  4%|▎         | 15/411 [00:20<08:45,  1.33s/it]  4%|▍         | 16/411 [00:21<08:44,  1.33s/it]  4%|▍         | 17/411 [00:22<08:42,  1.33s/it]  4%|▍         | 18/411 [00:24<08:41,  1.33s/it]  5%|▍         | 19/411 [00:25<08:40,  1.33s/it]  5%|▍         | 20/411 [00:26<08:38,  1.33s/it]  5%|▌         | 21/411 [00:28<08:37,  1.33s/it]  5%|▌         | 22/411 [00:29<08:36,  1.33s/it]  6%|▌         | 23/411 [00:30<08:34,  1.33s/it]  6%|▌         | 24/411 [00:32<08:33,  1.33s/it]  6%|▌         | 25/411 [00:33<08:32,  1.33s/it]  6%|▋         | 26/411 [00:34<08:30,  1.33s/it]  7%|▋         | 27/411 [00:36<08:29,  1.33s/it]  7%|▋         | 28/411 [00:37<08:28,  1.33s/it]  7%|▋         | 29/411 [00:38<08:26,  1.33s/it]  7%|▋         | 30/411 [00:40<08:25,  1.33s/it]  8%|▊         | 31/411 [00:41<08:24,  1.33s/it]  8%|▊         | 32/411 [00:42<08:24,  1.33s/it]  8%|▊         | 33/411 [00:43<08:22,  1.33s/it]  8%|▊         | 34/411 [00:45<08:20,  1.33s/it]  9%|▊         | 35/411 [00:46<08:19,  1.33s/it]  9%|▉         | 36/411 [00:47<08:17,  1.33s/it]  9%|▉         | 37/411 [00:49<08:16,  1.33s/it]  9%|▉         | 38/411 [00:50<08:15,  1.33s/it]  9%|▉         | 39/411 [00:51<08:13,  1.33s/it] 10%|▉         | 40/411 [00:53<08:12,  1.33s/it] 10%|▉         | 41/411 [00:54<08:11,  1.33s/it] 10%|█         | 42/411 [00:55<08:09,  1.33s/it] 10%|█         | 43/411 [00:57<08:08,  1.33s/it] 11%|█         | 44/411 [00:58<08:07,  1.33s/it] 11%|█         | 45/411 [00:59<08:05,  1.33s/it] 11%|█         | 46/411 [01:01<08:04,  1.33s/it] 11%|█▏        | 47/411 [01:02<08:02,  1.33s/it] 12%|█▏        | 48/411 [01:03<08:01,  1.33s/it] 12%|█▏        | 49/411 [01:05<08:00,  1.33s/it] 12%|█▏        | 50/411 [01:06<07:59,  1.33s/it] 12%|█▏        | 51/411 [01:07<07:57,  1.33s/it] 13%|█▎        | 52/411 [01:09<07:56,  1.33s/it] 13%|█▎        | 53/411 [01:10<07:55,  1.33s/it] 13%|█▎        | 54/411 [01:11<07:53,  1.33s/it] 13%|█▎        | 55/411 [01:13<07:52,  1.33s/it] 14%|█▎        | 56/411 [01:14<07:50,  1.33s/it] 14%|█▍        | 57/411 [01:15<07:49,  1.33s/it] 14%|█▍        | 58/411 [01:17<07:48,  1.33s/it] 14%|█▍        | 59/411 [01:18<07:46,  1.33s/it] 15%|█▍        | 60/411 [01:19<07:45,  1.33s/it] 15%|█▍        | 61/411 [01:21<07:44,  1.33s/it] 15%|█▌        | 62/411 [01:22<07:42,  1.33s/it] 15%|█▌        | 63/411 [01:23<07:41,  1.33s/it] 16%|█▌        | 64/411 [01:25<07:40,  1.33s/it] 16%|█▌        | 65/411 [01:26<07:39,  1.33s/it] 16%|█▌        | 66/411 [01:27<07:37,  1.33s/it] 16%|█▋        | 67/411 [01:29<07:36,  1.33s/it] 17%|█▋        | 68/411 [01:30<07:35,  1.33s/it] 17%|█▋        | 69/411 [01:31<07:33,  1.33s/it] 17%|█▋        | 70/411 [01:33<07:32,  1.33s/it] 17%|█▋        | 71/411 [01:34<07:31,  1.33s/it] 18%|█▊        | 72/411 [01:35<07:29,  1.33s/it] 18%|█▊        | 73/411 [01:37<07:28,  1.33s/it] 18%|█▊        | 74/411 [01:38<07:26,  1.33s/it] 18%|█▊        | 75/411 [01:39<07:25,  1.33s/it] 18%|█▊        | 76/411 [01:41<07:24,  1.33s/it] 19%|█▊        | 77/411 [01:42<07:23,  1.33s/it] 19%|█▉        | 78/411 [01:43<07:22,  1.33s/it] 19%|█▉        | 79/411 [01:45<07:20,  1.33s/it] 19%|█▉        | 80/411 [01:46<07:19,  1.33s/it] 20%|█▉        | 81/411 [01:47<07:17,  1.33s/it] 20%|█▉        | 82/411 [01:49<07:16,  1.33s/it] 20%|██        | 83/411 [01:50<07:15,  1.33s/it] 20%|██        | 84/411 [01:51<07:13,  1.33s/it] 21%|██        | 85/411 [01:52<07:12,  1.33s/it] 21%|██        | 86/411 [01:54<07:11,  1.33s/it] 21%|██        | 87/411 [01:55<07:09,  1.33s/it] 21%|██▏       | 88/411 [01:56<07:08,  1.33s/it] 22%|██▏       | 89/411 [01:58<07:07,  1.33s/it] 22%|██▏       | 90/411 [01:59<07:05,  1.33s/it] 22%|██▏       | 91/411 [02:00<07:04,  1.33s/it] 22%|██▏       | 92/411 [02:02<07:03,  1.33s/it] 23%|██▎       | 93/411 [02:03<07:01,  1.33s/it] 23%|██▎       | 94/411 [02:04<07:00,  1.33s/it] 23%|██▎       | 95/411 [02:06<06:59,  1.33s/it] 23%|██▎       | 96/411 [02:07<06:57,  1.33s/it] 24%|██▎       | 97/411 [02:08<06:56,  1.33s/it] 24%|██▍       | 98/411 [02:10<06:55,  1.33s/it] 24%|██▍       | 99/411 [02:11<06:53,  1.33s/it] 24%|██▍       | 100/411 [02:12<06:52,  1.33s/it]                                                  24%|██▍       | 100/411 [02:12<06:52,  1.33s/it] 25%|██▍       | 101/411 [02:14<06:51,  1.33s/it] 25%|██▍       | 102/411 [02:15<06:49,  1.33s/it] 25%|██▌       | 103/411 [02:16<06:48,  1.33s/it] 25%|██▌       | 104/411 [02:18<06:47,  1.33s/it] 26%|██▌       | 105/411 [02:19<06:45,  1.33s/it] 26%|██▌       | 106/411 [02:20<06:44,  1.33s/it] 26%|██▌       | 107/411 [02:22<06:43,  1.33s/it] 26%|██▋       | 108/411 [02:23<06:41,  1.33s/it] 27%|██▋       | 109/411 [02:24<06:40,  1.33s/it] 27%|██▋       | 110/411 [02:26<06:39,  1.33s/it] 27%|██▋       | 111/411 [02:27<06:38,  1.33s/it] 27%|██▋       | 112/411 [02:28<06:36,  1.33s/it] 27%|██▋       | 113/411 [02:30<06:35,  1.33s/it] 28%|██▊       | 114/411 [02:31<06:33,  1.33s/it] 28%|██▊       | 115/411 [02:32<06:32,  1.33s/it] 28%|██▊       | 116/411 [02:34<06:31,  1.33s/it] 28%|██▊       | 117/411 [02:35<06:29,  1.33s/it] 29%|██▊       | 118/411 [02:36<06:28,  1.33s/it] 29%|██▉       | 119/411 [02:38<06:27,  1.33s/it] 29%|██▉       | 120/411 [02:39<06:25,  1.33s/it] 29%|██▉       | 121/411 [02:40<06:24,  1.33s/it] 30%|██▉       | 122/411 [02:42<06:23,  1.33s/it] 30%|██▉       | 123/411 [02:43<06:21,  1.33s/it] 30%|███       | 124/411 [02:44<06:20,  1.33s/it] 30%|███       | 125/411 [02:46<06:19,  1.33s/it] 31%|███       | 126/411 [02:47<06:17,  1.33s/it] 31%|███       | 127/411 [02:48<06:16,  1.33s/it] 31%|███       | 128/411 [02:50<06:15,  1.33s/it] 31%|███▏      | 129/411 [02:51<06:13,  1.33s/it] 32%|███▏      | 130/411 [02:52<06:12,  1.33s/it] 32%|███▏      | 131/411 [02:53<06:11,  1.33s/it] 32%|███▏      | 132/411 [02:55<06:09,  1.33s/it] 32%|███▏      | 133/411 [02:56<06:08,  1.33s/it] 33%|███▎      | 134/411 [02:57<06:07,  1.33s/it] 33%|███▎      | 135/411 [02:59<06:05,  1.33s/it] 33%|███▎      | 136/411 [03:00<06:04,  1.33s/it] 33%|███▎      | 137/411 [03:01<06:03,  1.33s/it] 34%|███▎      | 138/411 [03:03<06:01,  1.33s/it] 34%|███▍      | 139/411 [03:04<06:00,  1.33s/it] 34%|███▍      | 140/411 [03:05<05:59,  1.33s/it] 34%|███▍      | 141/411 [03:07<05:57,  1.33s/it] 35%|███▍      | 142/411 [03:08<05:56,  1.33s/it] 35%|███▍      | 143/411 [03:09<05:55,  1.33s/it] 35%|███▌      | 144/411 [03:11<05:53,  1.33s/it] 35%|███▌      | 145/411 [03:12<05:53,  1.33s/it] 36%|███▌      | 146/411 [03:13<05:51,  1.33s/it] 36%|███▌      | 147/411 [03:15<05:50,  1.33s/it] 36%|███▌      | 148/411 [03:16<05:48,  1.33s/it] 36%|███▋      | 149/411 [03:17<05:47,  1.33s/it] 36%|███▋      | 150/411 [03:19<05:46,  1.33s/it] 37%|███▋      | 151/411 [03:20<05:44,  1.33s/it] 37%|███▋      | 152/411 [03:21<05:43,  1.33s/it] 37%|███▋      | 153/411 [03:23<05:42,  1.33s/it] 37%|███▋      | 154/411 [03:24<05:40,  1.33s/it] 38%|███▊      | 155/411 [03:25<05:39,  1.33s/it] 38%|███▊      | 156/411 [03:27<05:38,  1.33s/it] 38%|███▊      | 157/411 [03:28<05:36,  1.33s/it] 38%|███▊      | 158/411 [03:29<05:35,  1.33s/it] 39%|███▊      | 159/411 [03:31<05:34,  1.33s/it] 39%|███▉      | 160/411 [03:32<05:32,  1.33s/it] 39%|███▉      | 161/411 [03:33<05:31,  1.33s/it] 39%|███▉      | 162/411 [03:35<05:30,  1.33s/it] 40%|███▉      | 163/411 [03:36<05:28,  1.33s/it] 40%|███▉      | 164/411 [03:37<05:27,  1.33s/it] 40%|████      | 165/411 [03:39<05:26,  1.33s/it] 40%|████      | 166/411 [03:40<05:24,  1.33s/it] 41%|████      | 167/411 [03:41<05:23,  1.33s/it] 41%|████      | 168/411 [03:43<05:22,  1.33s/it] 41%|████      | 169/411 [03:44<05:20,  1.33s/it] 41%|████▏     | 170/411 [03:45<05:19,  1.33s/it] 42%|████▏     | 171/411 [03:47<05:18,  1.33s/it] 42%|████▏     | 172/411 [03:48<05:16,  1.33s/it] 42%|████▏     | 173/411 [03:49<05:15,  1.33s/it] 42%|████▏     | 174/411 [03:51<05:14,  1.33s/it] 43%|████▎     | 175/411 [03:52<05:12,  1.33s/it] 43%|████▎     | 176/411 [03:53<05:11,  1.33s/it] 43%|████▎     | 177/411 [03:54<05:10,  1.33s/it] 43%|████▎     | 178/411 [03:56<05:08,  1.33s/it] 44%|████▎     | 179/411 [03:57<05:07,  1.33s/it] 44%|████▍     | 180/411 [03:58<05:06,  1.33s/it] 44%|████▍     | 181/411 [04:00<05:05,  1.33s/it] 44%|████▍     | 182/411 [04:01<05:03,  1.33s/it] 45%|████▍     | 183/411 [04:02<05:02,  1.33s/it] 45%|████▍     | 184/411 [04:04<05:01,  1.33s/it] 45%|████▌     | 185/411 [04:05<04:59,  1.33s/it] 45%|████▌     | 186/411 [04:06<04:58,  1.33s/it] 45%|████▌     | 187/411 [04:08<04:56,  1.33s/it] 46%|████▌     | 188/411 [04:09<04:55,  1.33s/it] 46%|████▌     | 189/411 [04:10<04:54,  1.33s/it] 46%|████▌     | 190/411 [04:12<04:53,  1.33s/it] 46%|████▋     | 191/411 [04:13<04:51,  1.33s/it] 47%|████▋     | 192/411 [04:14<04:50,  1.33s/it] 47%|████▋     | 193/411 [04:16<04:49,  1.33s/it] 47%|████▋     | 194/411 [04:17<04:47,  1.33s/it] 47%|████▋     | 195/411 [04:18<04:46,  1.33s/it] 48%|████▊     | 196/411 [04:20<04:45,  1.33s/it] 48%|████▊     | 197/411 [04:21<04:43,  1.33s/it] 48%|████▊     | 198/411 [04:22<04:42,  1.33s/it] 48%|████▊     | 199/411 [04:24<04:41,  1.33s/it] 49%|████▊     | 200/411 [04:25<04:39,  1.33s/it]                                                  49%|████▊     | 200/411 [04:25<04:39,  1.33s/it] 49%|████▉     | 201/411 [04:26<04:38,  1.33s/it] 49%|████▉     | 202/411 [04:28<04:37,  1.33s/it] 49%|████▉     | 203/411 [04:29<04:35,  1.33s/it] 50%|████▉     | 204/411 [04:30<04:34,  1.33s/it] 50%|████▉     | 205/411 [04:32<04:33,  1.33s/it] 50%|█████     | 206/411 [04:33<04:31,  1.33s/it] 50%|█████     | 207/411 [04:34<04:30,  1.33s/it] 51%|█████     | 208/411 [04:36<04:29,  1.33s/it] 51%|█████     | 209/411 [04:37<04:27,  1.33s/it] 51%|█████     | 210/411 [04:38<04:26,  1.33s/it] 51%|█████▏    | 211/411 [04:40<04:25,  1.33s/it] 52%|█████▏    | 212/411 [04:41<04:23,  1.33s/it] 52%|█████▏    | 213/411 [04:42<04:23,  1.33s/it] 52%|█████▏    | 214/411 [04:44<04:21,  1.33s/it] 52%|█████▏    | 215/411 [04:45<04:20,  1.33s/it] 53%|█████▎    | 216/411 [04:46<04:18,  1.33s/it] 53%|█████▎    | 217/411 [04:48<04:17,  1.33s/it] 53%|█████▎    | 218/411 [04:49<04:16,  1.33s/it] 53%|█████▎    | 219/411 [04:50<04:14,  1.33s/it] 54%|█████▎    | 220/411 [04:52<04:13,  1.33s/it] 54%|█████▍    | 221/411 [04:53<04:11,  1.33s/it] 54%|█████▍    | 222/411 [04:54<04:10,  1.33s/it] 54%|█████▍    | 223/411 [04:56<04:09,  1.33s/it] 55%|█████▍    | 224/411 [04:57<04:07,  1.33s/it] 55%|█████▍    | 225/411 [04:58<04:06,  1.33s/it] 55%|█████▍    | 226/411 [04:59<04:05,  1.33s/it] 55%|█████▌    | 227/411 [05:01<04:03,  1.33s/it] 55%|█████▌    | 228/411 [05:02<04:02,  1.33s/it] 56%|█████▌    | 229/411 [05:03<04:01,  1.33s/it] 56%|█████▌    | 230/411 [05:05<03:59,  1.33s/it] 56%|█████▌    | 231/411 [05:06<03:58,  1.33s/it] 56%|█████▋    | 232/411 [05:07<03:57,  1.33s/it] 57%|█████▋    | 233/411 [05:09<03:56,  1.33s/it] 57%|█████▋    | 234/411 [05:10<03:54,  1.33s/it] 57%|█████▋    | 235/411 [05:11<03:53,  1.33s/it] 57%|█████▋    | 236/411 [05:13<03:52,  1.33s/it] 58%|█████▊    | 237/411 [05:14<03:50,  1.33s/it] 58%|█████▊    | 238/411 [05:15<03:49,  1.33s/it] 58%|█████▊    | 239/411 [05:17<03:48,  1.33s/it] 58%|█████▊    | 240/411 [05:18<03:46,  1.33s/it] 59%|█████▊    | 241/411 [05:19<03:45,  1.33s/it] 59%|█████▉    | 242/411 [05:21<03:44,  1.33s/it] 59%|█████▉    | 243/411 [05:22<03:42,  1.33s/it] 59%|█████▉    | 244/411 [05:23<03:41,  1.33s/it] 60%|█████▉    | 245/411 [05:25<03:40,  1.33s/it] 60%|█████▉    | 246/411 [05:26<03:38,  1.33s/it] 60%|██████    | 247/411 [05:27<03:37,  1.33s/it] 60%|██████    | 248/411 [05:29<03:36,  1.33s/it] 61%|██████    | 249/411 [05:30<03:34,  1.33s/it] 61%|██████    | 250/411 [05:31<03:33,  1.33s/it] 61%|██████    | 251/411 [05:33<03:32,  1.33s/it] 61%|██████▏   | 252/411 [05:34<03:30,  1.33s/it] 62%|██████▏   | 253/411 [05:35<03:29,  1.33s/it] 62%|██████▏   | 254/411 [05:37<03:28,  1.33s/it] 62%|██████▏   | 255/411 [05:38<03:26,  1.33s/it] 62%|██████▏   | 256/411 [05:39<03:25,  1.33s/it] 63%|██████▎   | 257/411 [05:41<03:24,  1.33s/it] 63%|██████▎   | 258/411 [05:42<03:23,  1.33s/it] 63%|██████▎   | 259/411 [05:43<03:21,  1.33s/it] 63%|██████▎   | 260/411 [05:45<03:20,  1.33s/it] 64%|██████▎   | 261/411 [05:46<03:19,  1.33s/it] 64%|██████▎   | 262/411 [05:47<03:17,  1.33s/it] 64%|██████▍   | 263/411 [05:49<03:16,  1.33s/it] 64%|██████▍   | 264/411 [05:50<03:15,  1.33s/it] 64%|██████▍   | 265/411 [05:51<03:13,  1.33s/it] 65%|██████▍   | 266/411 [05:53<03:12,  1.33s/it] 65%|██████▍   | 267/411 [05:54<03:10,  1.33s/it] 65%|██████▌   | 268/411 [05:55<03:09,  1.33s/it] 65%|██████▌   | 269/411 [05:57<03:08,  1.33s/it] 66%|██████▌   | 270/411 [05:58<03:06,  1.33s/it] 66%|██████▌   | 271/411 [05:59<03:05,  1.33s/it] 66%|██████▌   | 272/411 [06:00<03:04,  1.33s/it] 66%|██████▋   | 273/411 [06:02<03:03,  1.33s/it] 67%|██████▋   | 274/411 [06:03<03:01,  1.33s/it] 67%|██████▋   | 275/411 [06:04<03:00,  1.33s/it] 67%|██████▋   | 276/411 [06:06<02:59,  1.33s/it] 67%|██████▋   | 277/411 [06:07<02:57,  1.33s/it] 68%|██████▊   | 278/411 [06:08<02:56,  1.33s/it] 68%|██████▊   | 279/411 [06:10<02:55,  1.33s/it] 68%|██████▊   | 280/411 [06:11<02:53,  1.33s/it] 68%|██████▊   | 281/411 [06:12<02:52,  1.33s/it] 69%|██████▊   | 282/411 [06:14<02:51,  1.33s/it] 69%|██████▉   | 283/411 [06:15<02:49,  1.33s/it] 69%|██████▉   | 284/411 [06:16<02:48,  1.33s/it] 69%|██████▉   | 285/411 [06:18<02:47,  1.33s/it] 70%|██████▉   | 286/411 [06:19<02:45,  1.33s/it] 70%|██████▉   | 287/411 [06:20<02:44,  1.33s/it] 70%|███████   | 288/411 [06:22<02:43,  1.33s/it] 70%|███████   | 289/411 [06:23<02:41,  1.33s/it] 71%|███████   | 290/411 [06:24<02:40,  1.33s/it] 71%|███████   | 291/411 [06:26<02:39,  1.33s/it] 71%|███████   | 292/411 [06:27<02:37,  1.33s/it] 71%|███████▏  | 293/411 [06:28<02:36,  1.33s/it] 72%|███████▏  | 294/411 [06:30<02:35,  1.33s/it] 72%|███████▏  | 295/411 [06:31<02:33,  1.33s/it] 72%|███████▏  | 296/411 [06:32<02:32,  1.33s/it] 72%|███████▏  | 297/411 [06:34<02:31,  1.33s/it] 73%|███████▎  | 298/411 [06:35<02:29,  1.33s/it] 73%|███████▎  | 299/411 [06:36<02:28,  1.33s/it] 73%|███████▎  | 300/411 [06:38<02:27,  1.33s/it]                                                  73%|███████▎  | 300/411 [06:38<02:27,  1.33s/it] 73%|███████▎  | 301/411 [06:39<02:25,  1.33s/it] 73%|███████▎  | 302/411 [06:40<02:24,  1.33s/it] 74%|███████▎  | 303/411 [06:42<02:23,  1.33s/it] 74%|███████▍  | 304/411 [06:43<02:21,  1.33s/it] 74%|███████▍  | 305/411 [06:44<02:20,  1.33s/it] 74%|███████▍  | 306/411 [06:46<02:19,  1.33s/it] 75%|███████▍  | 307/411 [06:47<02:17,  1.33s/it] 75%|███████▍  | 308/411 [06:48<02:16,  1.33s/it] 75%|███████▌  | 309/411 [06:50<02:15,  1.33s/it] 75%|███████▌  | 310/411 [06:51<02:13,  1.33s/it] 76%|███████▌  | 311/411 [06:52<02:12,  1.33s/it] 76%|███████▌  | 312/411 [06:54<02:11,  1.33s/it] 76%|███████▌  | 313/411 [06:55<02:09,  1.33s/it] 76%|███████▋  | 314/411 [06:56<02:08,  1.33s/it] 77%|███████▋  | 315/411 [06:58<02:07,  1.33s/it] 77%|███████▋  | 316/411 [06:59<02:05,  1.33s/it] 77%|███████▋  | 317/411 [07:00<02:04,  1.33s/it] 77%|███████▋  | 318/411 [07:01<02:03,  1.33s/it] 78%|███████▊  | 319/411 [07:03<02:01,  1.33s/it] 78%|███████▊  | 320/411 [07:04<02:00,  1.33s/it] 78%|███████▊  | 321/411 [07:05<01:59,  1.33s/it] 78%|███████▊  | 322/411 [07:07<01:58,  1.33s/it] 79%|███████▊  | 323/411 [07:08<01:56,  1.33s/it] 79%|███████▉  | 324/411 [07:09<01:55,  1.33s/it] 79%|███████▉  | 325/411 [07:11<01:54,  1.33s/it] 79%|███████▉  | 326/411 [07:12<01:52,  1.33s/it] 80%|███████▉  | 327/411 [07:13<01:51,  1.33s/it] 80%|███████▉  | 328/411 [07:15<01:50,  1.33s/it] 80%|████████  | 329/411 [07:16<01:48,  1.33s/it] 80%|████████  | 330/411 [07:17<01:47,  1.33s/it] 81%|████████  | 331/411 [07:19<01:46,  1.33s/it] 81%|████████  | 332/411 [07:20<01:44,  1.33s/it] 81%|████████  | 333/411 [07:21<01:43,  1.33s/it] 81%|████████▏ | 334/411 [07:23<01:42,  1.33s/it] 82%|████████▏ | 335/411 [07:24<01:40,  1.33s/it] 82%|████████▏ | 336/411 [07:25<01:39,  1.33s/it] 82%|████████▏ | 337/411 [07:27<01:38,  1.33s/it] 82%|████████▏ | 338/411 [07:28<01:36,  1.33s/it] 82%|████████▏ | 339/411 [07:29<01:35,  1.33s/it] 83%|████████▎ | 340/411 [07:31<01:34,  1.33s/it] 83%|████████▎ | 341/411 [07:32<01:32,  1.33s/it] 83%|████████▎ | 342/411 [07:33<01:31,  1.33s/it] 83%|████████▎ | 343/411 [07:35<01:30,  1.33s/it] 84%|████████▎ | 344/411 [07:36<01:28,  1.33s/it] 84%|████████▍ | 345/411 [07:37<01:27,  1.33s/it] 84%|████████▍ | 346/411 [07:39<01:26,  1.33s/it] 84%|████████▍ | 347/411 [07:40<01:24,  1.33s/it] 85%|████████▍ | 348/411 [07:41<01:23,  1.33s/it] 85%|████████▍ | 349/411 [07:43<01:22,  1.33s/it] 85%|████████▌ | 350/411 [07:44<01:20,  1.33s/it] 85%|████████▌ | 351/411 [07:45<01:19,  1.33s/it] 86%|████████▌ | 352/411 [07:47<01:18,  1.33s/it] 86%|████████▌ | 353/411 [07:48<01:16,  1.33s/it] 86%|████████▌ | 354/411 [07:49<01:15,  1.32s/it] 86%|████████▋ | 355/411 [07:51<01:14,  1.32s/it] 87%|████████▋ | 356/411 [07:52<01:12,  1.33s/it] 87%|████████▋ | 357/411 [07:53<01:11,  1.33s/it] 87%|████████▋ | 358/411 [07:55<01:10,  1.33s/it] 87%|████████▋ | 359/411 [07:56<01:08,  1.32s/it] 88%|████████▊ | 360/411 [07:57<01:07,  1.33s/it] 88%|████████▊ | 361/411 [07:58<01:06,  1.33s/it] 88%|████████▊ | 362/411 [08:00<01:04,  1.33s/it] 88%|████████▊ | 363/411 [08:01<01:03,  1.33s/it] 89%|████████▊ | 364/411 [08:02<01:02,  1.33s/it] 89%|████████▉ | 365/411 [08:04<01:00,  1.33s/it] 89%|████████▉ | 366/411 [08:05<00:59,  1.33s/it] 89%|████████▉ | 367/411 [08:06<00:58,  1.33s/it] 90%|████████▉ | 368/411 [08:08<00:56,  1.33s/it] 90%|████████▉ | 369/411 [08:09<00:55,  1.33s/it] 90%|█████████ | 370/411 [08:10<00:54,  1.33s/it] 90%|█████████ | 371/411 [08:12<00:53,  1.33s/it] 91%|█████████ | 372/411 [08:13<00:51,  1.33s/it] 91%|█████████ | 373/411 [08:14<00:50,  1.33s/it] 91%|█████████ | 374/411 [08:16<00:49,  1.33s/it] 91%|█████████ | 375/411 [08:17<00:47,  1.33s/it] 91%|█████████▏| 376/411 [08:18<00:46,  1.33s/it] 92%|█████████▏| 377/411 [08:20<00:45,  1.33s/it] 92%|█████████▏| 378/411 [08:21<00:43,  1.33s/it] 92%|█████████▏| 379/411 [08:22<00:42,  1.33s/it] 92%|█████████▏| 380/411 [08:24<00:41,  1.33s/it] 93%|█████████▎| 381/411 [08:25<00:39,  1.33s/it] 93%|█████████▎| 382/411 [08:26<00:38,  1.33s/it] 93%|█████████▎| 383/411 [08:28<00:37,  1.33s/it] 93%|█████████▎| 384/411 [08:29<00:35,  1.33s/it] 94%|█████████▎| 385/411 [08:30<00:34,  1.33s/it] 94%|█████████▍| 386/411 [08:32<00:33,  1.33s/it] 94%|█████████▍| 387/411 [08:33<00:31,  1.33s/it] 94%|█████████▍| 388/411 [08:34<00:30,  1.33s/it] 95%|█████████▍| 389/411 [08:36<00:29,  1.33s/it] 95%|█████████▍| 390/411 [08:37<00:27,  1.33s/it] 95%|█████████▌| 391/411 [08:38<00:26,  1.33s/it] 95%|█████████▌| 392/411 [08:40<00:25,  1.33s/it] 96%|█████████▌| 393/411 [08:41<00:23,  1.33s/it] 96%|█████████▌| 394/411 [08:42<00:22,  1.33s/it] 96%|█████████▌| 395/411 [08:44<00:21,  1.33s/it] 96%|█████████▋| 396/411 [08:45<00:19,  1.33s/it] 97%|█████████▋| 397/411 [08:46<00:18,  1.33s/it] 97%|█████████▋| 398/411 [08:48<00:17,  1.33s/it] 97%|█████████▋| 399/411 [08:49<00:15,  1.33s/it] 97%|█████████▋| 400/411 [08:50<00:14,  1.33s/it]                                                  97%|█████████▋| 400/411 [08:50<00:14,  1.33s/it] 98%|█████████▊| 401/411 [08:52<00:13,  1.33s/it] 98%|█████████▊| 402/411 [08:53<00:11,  1.33s/it] 98%|█████████▊| 403/411 [08:54<00:10,  1.33s/it] 98%|█████████▊| 404/411 [08:56<00:09,  1.33s/it] 99%|█████████▊| 405/411 [08:57<00:07,  1.33s/it] 99%|█████████▉| 406/411 [08:58<00:06,  1.33s/it] 99%|█████████▉| 407/411 [08:59<00:05,  1.33s/it] 99%|█████████▉| 408/411 [09:01<00:03,  1.33s/it]100%|█████████▉| 409/411 [09:02<00:02,  1.33s/it]100%|█████████▉| 410/411 [09:03<00:01,  1.33s/it]100%|██████████| 411/411 [09:04<00:00,  1.15s/it]/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x14829c0c1d20>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 58cdd802-bf3b-498a-922c-cc7c6afc3b00)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                 100%|██████████| 411/411 [09:04<00:00,  1.15s/it]100%|██████████| 411/411 [09:04<00:00,  1.33s/it]
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x14829c0dd7e0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 9bd6c5b4-2b95-40ce-ad03-13c13e7468ee)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'loss': 2.5401, 'grad_norm': 3.1139514446258545, 'learning_rate': 1.51338199513382e-05, 'epoch': 0.24}
{'loss': 0.7161, 'grad_norm': 2.6234962940216064, 'learning_rate': 1.0267639902676401e-05, 'epoch': 0.49}
{'loss': 0.3998, 'grad_norm': 2.6027371883392334, 'learning_rate': 5.401459854014599e-06, 'epoch': 0.73}
{'loss': 0.3795, 'grad_norm': 2.770566940307617, 'learning_rate': 5.839416058394161e-07, 'epoch': 0.97}
{'train_runtime': 544.8909, 'train_samples_per_second': 3.013, 'train_steps_per_second': 0.754, 'train_loss': 0.9917981525987314, 'epoch': 1.0}
Saving model to ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_constant_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_58
Fine-tuning completed successfully!
2025-05-01 17:06:31.592535: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 17:06:31.605771: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746133591.620252  310400 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746133591.624676  310400 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746133591.637267  310400 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746133591.637287  310400 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746133591.637288  310400 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746133591.637290  310400 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 17:06:31.641186: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
=== Fine-tuning Configuration ===
Model: 
Training dataset: 
Random seed: 36
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: 
===========================
CUDA available: True
CUDA device count: 1
CUDA current device: 0
CUDA device name: NVIDIA A100 80GB PCIe MIG 3g.40gb
train_config(model_name='meta-llama/Llama-3.2-3B-Instruct', enable_fsdp=False, low_cpu_fsdp=False, run_validation=True, batch_size_training=4, gradient_accumulation_steps=1, num_epochs=1, num_workers_dataloader=1, lr=2e-05, weight_decay=0.0, gamma=0.85, seed=58, use_fp16=False, mixed_precision=True, val_batch_size=1, peft_method='lora', use_peft=False, output_dir='../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_prop_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_58', freeze_layers=False, num_freeze_layers=1, quantization=True, one_gpu=False, save_model=True, save_every_epoch=True, dist_checkpoint_root_folder='fsdp', dist_checkpoint_folder='fine-tuned', save_optimizer=False, use_fast_kernels=False, use_lora=True, save_full_gradients=False, system_message='You are a helpful assistant. Provide your best guess or estimate given the scenario. Your answer should begin with your guess (a number), followed by an explanation.', ft_dataset_name='no_bias_prop_var_prop_rep', dataset='datasets/ft/no_bias_prop_var_prop_rep.jsonl', eval_dataset_name='bbq_subset_100', eval_dataset=None, eval_output_file=None, base_output_file=None)
Clearing GPU cache
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.60s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.34s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Applying LoRA adapter...
trainable params: 2,293,760 || all params: 3,215,046,656 || trainable%: 0.0713
Loading data from datasets/ft/no_bias_prop_var_prop_rep.jsonl...
Using all 1642 examples from dataset
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 26403.74 examples/s]
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map:  61%|██████    | 1000/1642 [00:00<00:00, 2376.56 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2431.20 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2397.41 examples/s]
/home/janeec/FairTune/finetune_w_eval_llama.py:297: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
=== Fine-tuning Configuration ===
Model: meta-llama/Llama-3.2-3B-Instruct
Training dataset: datasets/ft/no_bias_prop_var_prop_rep.jsonl
Random seed: 58
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_prop_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_58
===========================
SEED CHECK:, should be: 58, seed is: 58
Starting fine-tuning...
  0%|          | 0/411 [00:00<?, ?it/s]  0%|          | 1/411 [00:01<10:22,  1.52s/it]  0%|          | 2/411 [00:02<09:35,  1.41s/it]  1%|          | 3/411 [00:04<09:18,  1.37s/it]  1%|          | 4/411 [00:05<09:10,  1.35s/it]  1%|          | 5/411 [00:06<09:05,  1.34s/it]  1%|▏         | 6/411 [00:08<09:01,  1.34s/it]  2%|▏         | 7/411 [00:09<08:58,  1.33s/it]  2%|▏         | 8/411 [00:10<08:56,  1.33s/it]  2%|▏         | 9/411 [00:12<08:54,  1.33s/it]  2%|▏         | 10/411 [00:13<08:52,  1.33s/it]  3%|▎         | 11/411 [00:14<08:51,  1.33s/it]  3%|▎         | 12/411 [00:16<08:49,  1.33s/it]  3%|▎         | 13/411 [00:17<08:48,  1.33s/it]  3%|▎         | 14/411 [00:18<08:46,  1.33s/it]  4%|▎         | 15/411 [00:20<08:45,  1.33s/it]  4%|▍         | 16/411 [00:21<08:44,  1.33s/it]  4%|▍         | 17/411 [00:22<08:42,  1.33s/it]  4%|▍         | 18/411 [00:24<08:41,  1.33s/it]  5%|▍         | 19/411 [00:25<08:40,  1.33s/it]  5%|▍         | 20/411 [00:26<08:38,  1.33s/it]  5%|▌         | 21/411 [00:28<08:37,  1.33s/it]  5%|▌         | 22/411 [00:29<08:36,  1.33s/it]  6%|▌         | 23/411 [00:30<08:34,  1.33s/it]  6%|▌         | 24/411 [00:32<08:33,  1.33s/it]  6%|▌         | 25/411 [00:33<08:32,  1.33s/it]  6%|▋         | 26/411 [00:34<08:30,  1.33s/it]  7%|▋         | 27/411 [00:36<08:29,  1.33s/it]  7%|▋         | 28/411 [00:37<08:28,  1.33s/it]  7%|▋         | 29/411 [00:38<08:26,  1.33s/it]  7%|▋         | 30/411 [00:39<08:25,  1.33s/it]  8%|▊         | 31/411 [00:41<08:24,  1.33s/it]  8%|▊         | 32/411 [00:42<08:22,  1.33s/it]  8%|▊         | 33/411 [00:43<08:21,  1.33s/it]  8%|▊         | 34/411 [00:45<08:20,  1.33s/it]  9%|▊         | 35/411 [00:46<08:18,  1.33s/it]  9%|▉         | 36/411 [00:47<08:17,  1.33s/it]  9%|▉         | 37/411 [00:49<08:16,  1.33s/it]  9%|▉         | 38/411 [00:50<08:14,  1.33s/it]  9%|▉         | 39/411 [00:51<08:13,  1.33s/it] 10%|▉         | 40/411 [00:53<08:12,  1.33s/it] 10%|▉         | 41/411 [00:54<08:10,  1.33s/it] 10%|█         | 42/411 [00:55<08:09,  1.33s/it] 10%|█         | 43/411 [00:57<08:08,  1.33s/it] 11%|█         | 44/411 [00:58<08:06,  1.33s/it] 11%|█         | 45/411 [00:59<08:05,  1.33s/it] 11%|█         | 46/411 [01:01<08:04,  1.33s/it] 11%|█▏        | 47/411 [01:02<08:02,  1.33s/it] 12%|█▏        | 48/411 [01:03<08:01,  1.33s/it] 12%|█▏        | 49/411 [01:05<08:00,  1.33s/it] 12%|█▏        | 50/411 [01:06<07:58,  1.33s/it] 12%|█▏        | 51/411 [01:07<07:57,  1.33s/it] 13%|█▎        | 52/411 [01:09<07:56,  1.33s/it] 13%|█▎        | 53/411 [01:10<07:54,  1.33s/it] 13%|█▎        | 54/411 [01:11<07:53,  1.33s/it] 13%|█▎        | 55/411 [01:13<07:52,  1.33s/it] 14%|█▎        | 56/411 [01:14<07:50,  1.33s/it] 14%|█▍        | 57/411 [01:15<07:49,  1.33s/it] 14%|█▍        | 58/411 [01:17<07:48,  1.33s/it] 14%|█▍        | 59/411 [01:18<07:46,  1.33s/it] 15%|█▍        | 60/411 [01:19<07:45,  1.33s/it] 15%|█▍        | 61/411 [01:21<07:44,  1.33s/it] 15%|█▌        | 62/411 [01:22<07:42,  1.33s/it] 15%|█▌        | 63/411 [01:23<07:41,  1.33s/it] 16%|█▌        | 64/411 [01:25<07:40,  1.33s/it] 16%|█▌        | 65/411 [01:26<07:38,  1.33s/it] 16%|█▌        | 66/411 [01:27<07:37,  1.33s/it] 16%|█▋        | 67/411 [01:29<07:36,  1.33s/it] 17%|█▋        | 68/411 [01:30<07:34,  1.33s/it] 17%|█▋        | 69/411 [01:31<07:33,  1.33s/it] 17%|█▋        | 70/411 [01:33<07:32,  1.33s/it] 17%|█▋        | 71/411 [01:34<07:30,  1.33s/it] 18%|█▊        | 72/411 [01:35<07:29,  1.33s/it] 18%|█▊        | 73/411 [01:37<07:28,  1.33s/it] 18%|█▊        | 74/411 [01:38<07:26,  1.33s/it] 18%|█▊        | 75/411 [01:39<07:25,  1.33s/it] 18%|█▊        | 76/411 [01:40<07:24,  1.33s/it] 19%|█▊        | 77/411 [01:42<07:22,  1.33s/it] 19%|█▉        | 78/411 [01:43<07:21,  1.33s/it] 19%|█▉        | 79/411 [01:44<07:20,  1.33s/it] 19%|█▉        | 80/411 [01:46<07:18,  1.33s/it] 20%|█▉        | 81/411 [01:47<07:17,  1.33s/it] 20%|█▉        | 82/411 [01:48<07:16,  1.33s/it] 20%|██        | 83/411 [01:50<07:14,  1.33s/it] 20%|██        | 84/411 [01:51<07:13,  1.33s/it] 21%|██        | 85/411 [01:52<07:12,  1.33s/it] 21%|██        | 86/411 [01:54<07:10,  1.33s/it] 21%|██        | 87/411 [01:55<07:09,  1.33s/it] 21%|██▏       | 88/411 [01:56<07:08,  1.33s/it] 22%|██▏       | 89/411 [01:58<07:06,  1.33s/it] 22%|██▏       | 90/411 [01:59<07:05,  1.33s/it] 22%|██▏       | 91/411 [02:00<07:04,  1.33s/it] 22%|██▏       | 92/411 [02:02<07:02,  1.33s/it] 23%|██▎       | 93/411 [02:03<07:01,  1.33s/it] 23%|██▎       | 94/411 [02:04<07:00,  1.33s/it] 23%|██▎       | 95/411 [02:06<06:58,  1.33s/it] 23%|██▎       | 96/411 [02:07<06:57,  1.33s/it] 24%|██▎       | 97/411 [02:08<06:56,  1.33s/it] 24%|██▍       | 98/411 [02:10<06:54,  1.33s/it] 24%|██▍       | 99/411 [02:11<06:53,  1.33s/it] 24%|██▍       | 100/411 [02:12<06:52,  1.33s/it]                                                  24%|██▍       | 100/411 [02:12<06:52,  1.33s/it] 25%|██▍       | 101/411 [02:14<06:51,  1.33s/it] 25%|██▍       | 102/411 [02:15<06:50,  1.33s/it] 25%|██▌       | 103/411 [02:16<06:48,  1.33s/it] 25%|██▌       | 104/411 [02:18<06:47,  1.33s/it] 26%|██▌       | 105/411 [02:19<06:45,  1.33s/it] 26%|██▌       | 106/411 [02:20<06:44,  1.33s/it] 26%|██▌       | 107/411 [02:22<06:43,  1.33s/it] 26%|██▋       | 108/411 [02:23<06:41,  1.33s/it] 27%|██▋       | 109/411 [02:24<06:40,  1.33s/it] 27%|██▋       | 110/411 [02:26<06:39,  1.33s/it] 27%|██▋       | 111/411 [02:27<06:37,  1.33s/it] 27%|██▋       | 112/411 [02:28<06:36,  1.33s/it] 27%|██▋       | 113/411 [02:30<06:35,  1.33s/it] 28%|██▊       | 114/411 [02:31<06:33,  1.33s/it] 28%|██▊       | 115/411 [02:32<06:32,  1.33s/it] 28%|██▊       | 116/411 [02:34<06:30,  1.33s/it] 28%|██▊       | 117/411 [02:35<06:29,  1.32s/it] 29%|██▊       | 118/411 [02:36<06:28,  1.33s/it] 29%|██▉       | 119/411 [02:38<06:26,  1.32s/it] 29%|██▉       | 120/411 [02:39<06:25,  1.32s/it] 29%|██▉       | 121/411 [02:40<06:24,  1.32s/it] 30%|██▉       | 122/411 [02:41<06:22,  1.32s/it] 30%|██▉       | 123/411 [02:43<06:21,  1.32s/it] 30%|███       | 124/411 [02:44<06:20,  1.32s/it] 30%|███       | 125/411 [02:45<06:18,  1.32s/it] 31%|███       | 126/411 [02:47<06:17,  1.32s/it] 31%|███       | 127/411 [02:48<06:16,  1.32s/it] 31%|███       | 128/411 [02:49<06:14,  1.32s/it] 31%|███▏      | 129/411 [02:51<06:13,  1.32s/it] 32%|███▏      | 130/411 [02:52<06:12,  1.32s/it] 32%|███▏      | 131/411 [02:53<06:10,  1.32s/it] 32%|███▏      | 132/411 [02:55<06:09,  1.32s/it] 32%|███▏      | 133/411 [02:56<06:08,  1.32s/it] 33%|███▎      | 134/411 [02:57<06:06,  1.32s/it] 33%|███▎      | 135/411 [02:59<06:05,  1.32s/it] 33%|███▎      | 136/411 [03:00<06:04,  1.33s/it] 33%|███▎      | 137/411 [03:01<06:03,  1.33s/it] 34%|███▎      | 138/411 [03:03<06:01,  1.33s/it] 34%|███▍      | 139/411 [03:04<06:00,  1.33s/it] 34%|███▍      | 140/411 [03:05<05:59,  1.33s/it] 34%|███▍      | 141/411 [03:07<05:57,  1.33s/it] 35%|███▍      | 142/411 [03:08<05:56,  1.33s/it] 35%|███▍      | 143/411 [03:09<05:55,  1.33s/it] 35%|███▌      | 144/411 [03:11<05:53,  1.33s/it] 35%|███▌      | 145/411 [03:12<05:52,  1.33s/it] 36%|███▌      | 146/411 [03:13<05:51,  1.33s/it] 36%|███▌      | 147/411 [03:15<05:49,  1.33s/it] 36%|███▌      | 148/411 [03:16<05:48,  1.33s/it] 36%|███▋      | 149/411 [03:17<05:47,  1.33s/it] 36%|███▋      | 150/411 [03:19<05:45,  1.33s/it] 37%|███▋      | 151/411 [03:20<05:44,  1.33s/it] 37%|███▋      | 152/411 [03:21<05:43,  1.33s/it] 37%|███▋      | 153/411 [03:23<05:41,  1.33s/it] 37%|███▋      | 154/411 [03:24<05:40,  1.33s/it] 38%|███▊      | 155/411 [03:25<05:39,  1.33s/it] 38%|███▊      | 156/411 [03:27<05:37,  1.33s/it] 38%|███▊      | 157/411 [03:28<05:36,  1.33s/it] 38%|███▊      | 158/411 [03:29<05:35,  1.33s/it] 39%|███▊      | 159/411 [03:30<05:33,  1.33s/it] 39%|███▉      | 160/411 [03:32<05:32,  1.33s/it] 39%|███▉      | 161/411 [03:33<05:31,  1.33s/it] 39%|███▉      | 162/411 [03:34<05:29,  1.33s/it] 40%|███▉      | 163/411 [03:36<05:28,  1.33s/it] 40%|███▉      | 164/411 [03:37<05:27,  1.33s/it] 40%|████      | 165/411 [03:38<05:26,  1.33s/it] 40%|████      | 166/411 [03:40<05:24,  1.33s/it] 41%|████      | 167/411 [03:41<05:23,  1.33s/it] 41%|████      | 168/411 [03:42<05:21,  1.33s/it] 41%|████      | 169/411 [03:44<05:21,  1.33s/it] 41%|████▏     | 170/411 [03:45<05:19,  1.33s/it] 42%|████▏     | 171/411 [03:46<05:18,  1.33s/it] 42%|████▏     | 172/411 [03:48<05:16,  1.33s/it] 42%|████▏     | 173/411 [03:49<05:15,  1.33s/it] 42%|████▏     | 174/411 [03:50<05:14,  1.33s/it] 43%|████▎     | 175/411 [03:52<05:12,  1.33s/it] 43%|████▎     | 176/411 [03:53<05:11,  1.33s/it] 43%|████▎     | 177/411 [03:54<05:10,  1.33s/it] 43%|████▎     | 178/411 [03:56<05:08,  1.32s/it] 44%|████▎     | 179/411 [03:57<05:07,  1.33s/it] 44%|████▍     | 180/411 [03:58<05:06,  1.33s/it] 44%|████▍     | 181/411 [04:00<05:04,  1.33s/it] 44%|████▍     | 182/411 [04:01<05:03,  1.33s/it] 45%|████▍     | 183/411 [04:02<05:02,  1.33s/it] 45%|████▍     | 184/411 [04:04<05:00,  1.33s/it] 45%|████▌     | 185/411 [04:05<04:59,  1.33s/it] 45%|████▌     | 186/411 [04:06<04:58,  1.33s/it] 45%|████▌     | 187/411 [04:08<04:56,  1.32s/it] 46%|████▌     | 188/411 [04:09<04:55,  1.32s/it] 46%|████▌     | 189/411 [04:10<04:54,  1.32s/it] 46%|████▌     | 190/411 [04:12<04:52,  1.32s/it] 46%|████▋     | 191/411 [04:13<04:51,  1.32s/it] 47%|████▋     | 192/411 [04:14<04:50,  1.32s/it] 47%|████▋     | 193/411 [04:16<04:48,  1.32s/it] 47%|████▋     | 194/411 [04:17<04:47,  1.32s/it] 47%|████▋     | 195/411 [04:18<04:46,  1.33s/it] 48%|████▊     | 196/411 [04:20<04:44,  1.33s/it] 48%|████▊     | 197/411 [04:21<04:43,  1.33s/it] 48%|████▊     | 198/411 [04:22<04:42,  1.32s/it] 48%|████▊     | 199/411 [04:24<04:40,  1.32s/it] 49%|████▊     | 200/411 [04:25<04:39,  1.32s/it]                                                  49%|████▊     | 200/411 [04:25<04:39,  1.32s/it] 49%|████▉     | 201/411 [04:26<04:38,  1.33s/it] 49%|████▉     | 202/411 [04:27<04:36,  1.33s/it] 49%|████▉     | 203/411 [04:29<04:35,  1.33s/it] 50%|████▉     | 204/411 [04:30<04:34,  1.33s/it] 50%|████▉     | 205/411 [04:31<04:33,  1.33s/it] 50%|█████     | 206/411 [04:33<04:31,  1.33s/it] 50%|█████     | 207/411 [04:34<04:30,  1.33s/it] 51%|█████     | 208/411 [04:35<04:29,  1.33s/it] 51%|█████     | 209/411 [04:37<04:27,  1.33s/it] 51%|█████     | 210/411 [04:38<04:26,  1.33s/it] 51%|█████▏    | 211/411 [04:39<04:25,  1.33s/it] 52%|█████▏    | 212/411 [04:41<04:23,  1.33s/it] 52%|█████▏    | 213/411 [04:42<04:22,  1.33s/it] 52%|█████▏    | 214/411 [04:43<04:21,  1.33s/it] 52%|█████▏    | 215/411 [04:45<04:19,  1.33s/it] 53%|█████▎    | 216/411 [04:46<04:18,  1.33s/it] 53%|█████▎    | 217/411 [04:47<04:17,  1.33s/it] 53%|█████▎    | 218/411 [04:49<04:15,  1.33s/it] 53%|█████▎    | 219/411 [04:50<04:14,  1.33s/it] 54%|█████▎    | 220/411 [04:51<04:13,  1.33s/it] 54%|█████▍    | 221/411 [04:53<04:11,  1.33s/it] 54%|█████▍    | 222/411 [04:54<04:10,  1.33s/it] 54%|█████▍    | 223/411 [04:55<04:09,  1.33s/it] 55%|█████▍    | 224/411 [04:57<04:07,  1.32s/it] 55%|█████▍    | 225/411 [04:58<04:06,  1.32s/it] 55%|█████▍    | 226/411 [04:59<04:05,  1.33s/it] 55%|█████▌    | 227/411 [05:01<04:03,  1.33s/it] 55%|█████▌    | 228/411 [05:02<04:02,  1.33s/it] 56%|█████▌    | 229/411 [05:03<04:01,  1.33s/it] 56%|█████▌    | 230/411 [05:05<03:59,  1.33s/it] 56%|█████▌    | 231/411 [05:06<03:58,  1.33s/it] 56%|█████▋    | 232/411 [05:07<03:57,  1.32s/it] 57%|█████▋    | 233/411 [05:09<03:55,  1.32s/it] 57%|█████▋    | 234/411 [05:10<03:54,  1.33s/it] 57%|█████▋    | 235/411 [05:11<03:53,  1.33s/it] 57%|█████▋    | 236/411 [05:13<03:51,  1.33s/it] 58%|█████▊    | 237/411 [05:14<03:51,  1.33s/it] 58%|█████▊    | 238/411 [05:15<03:49,  1.33s/it] 58%|█████▊    | 239/411 [05:17<03:48,  1.33s/it] 58%|█████▊    | 240/411 [05:18<03:46,  1.33s/it] 59%|█████▊    | 241/411 [05:19<03:45,  1.33s/it] 59%|█████▉    | 242/411 [05:21<03:44,  1.33s/it] 59%|█████▉    | 243/411 [05:22<03:42,  1.33s/it] 59%|█████▉    | 244/411 [05:23<03:41,  1.33s/it] 60%|█████▉    | 245/411 [05:24<03:39,  1.33s/it] 60%|█████▉    | 246/411 [05:26<03:38,  1.32s/it] 60%|██████    | 247/411 [05:27<03:37,  1.32s/it] 60%|██████    | 248/411 [05:28<03:35,  1.32s/it] 61%|██████    | 249/411 [05:30<03:34,  1.32s/it] 61%|██████    | 250/411 [05:31<03:33,  1.33s/it] 61%|██████    | 251/411 [05:32<03:31,  1.32s/it] 61%|██████▏   | 252/411 [05:34<03:30,  1.32s/it] 62%|██████▏   | 253/411 [05:35<03:29,  1.32s/it] 62%|██████▏   | 254/411 [05:36<03:28,  1.32s/it] 62%|██████▏   | 255/411 [05:38<03:26,  1.32s/it] 62%|██████▏   | 256/411 [05:39<03:25,  1.32s/it] 63%|██████▎   | 257/411 [05:40<03:24,  1.32s/it] 63%|██████▎   | 258/411 [05:42<03:22,  1.33s/it] 63%|██████▎   | 259/411 [05:43<03:21,  1.32s/it] 63%|██████▎   | 260/411 [05:44<03:20,  1.33s/it] 64%|██████▎   | 261/411 [05:46<03:18,  1.33s/it] 64%|██████▎   | 262/411 [05:47<03:17,  1.32s/it] 64%|██████▍   | 263/411 [05:48<03:16,  1.32s/it] 64%|██████▍   | 264/411 [05:50<03:14,  1.32s/it] 64%|██████▍   | 265/411 [05:51<03:13,  1.33s/it] 65%|██████▍   | 266/411 [05:52<03:12,  1.32s/it] 65%|██████▍   | 267/411 [05:54<03:10,  1.32s/it] 65%|██████▌   | 268/411 [05:55<03:09,  1.32s/it] 65%|██████▌   | 269/411 [05:56<03:08,  1.32s/it] 66%|██████▌   | 270/411 [05:58<03:06,  1.32s/it] 66%|██████▌   | 271/411 [05:59<03:05,  1.32s/it] 66%|██████▌   | 272/411 [06:00<03:04,  1.32s/it] 66%|██████▋   | 273/411 [06:02<03:02,  1.32s/it] 67%|██████▋   | 274/411 [06:03<03:01,  1.32s/it] 67%|██████▋   | 275/411 [06:04<03:00,  1.32s/it] 67%|██████▋   | 276/411 [06:06<02:58,  1.32s/it] 67%|██████▋   | 277/411 [06:07<02:57,  1.32s/it] 68%|██████▊   | 278/411 [06:08<02:56,  1.32s/it] 68%|██████▊   | 279/411 [06:10<02:54,  1.32s/it] 68%|██████▊   | 280/411 [06:11<02:53,  1.32s/it] 68%|██████▊   | 281/411 [06:12<02:52,  1.32s/it] 69%|██████▊   | 282/411 [06:14<02:51,  1.33s/it] 69%|██████▉   | 283/411 [06:15<02:49,  1.33s/it] 69%|██████▉   | 284/411 [06:16<02:48,  1.33s/it] 69%|██████▉   | 285/411 [06:17<02:47,  1.33s/it] 70%|██████▉   | 286/411 [06:19<02:45,  1.33s/it] 70%|██████▉   | 287/411 [06:20<02:44,  1.33s/it] 70%|███████   | 288/411 [06:21<02:42,  1.33s/it] 70%|███████   | 289/411 [06:23<02:41,  1.33s/it] 71%|███████   | 290/411 [06:24<02:40,  1.32s/it] 71%|███████   | 291/411 [06:25<02:39,  1.33s/it] 71%|███████   | 292/411 [06:27<02:37,  1.33s/it] 71%|███████▏  | 293/411 [06:28<02:36,  1.33s/it] 72%|███████▏  | 294/411 [06:29<02:35,  1.33s/it] 72%|███████▏  | 295/411 [06:31<02:33,  1.32s/it] 72%|███████▏  | 296/411 [06:32<02:32,  1.33s/it] 72%|███████▏  | 297/411 [06:33<02:31,  1.32s/it] 73%|███████▎  | 298/411 [06:35<02:29,  1.33s/it] 73%|███████▎  | 299/411 [06:36<02:28,  1.33s/it] 73%|███████▎  | 300/411 [06:37<02:27,  1.33s/it]                                                  73%|███████▎  | 300/411 [06:37<02:27,  1.33s/it] 73%|███████▎  | 301/411 [06:39<02:25,  1.33s/it] 73%|███████▎  | 302/411 [06:40<02:24,  1.33s/it] 74%|███████▎  | 303/411 [06:41<02:23,  1.32s/it] 74%|███████▍  | 304/411 [06:43<02:21,  1.33s/it] 74%|███████▍  | 305/411 [06:44<02:20,  1.32s/it] 74%|███████▍  | 306/411 [06:45<02:19,  1.32s/it] 75%|███████▍  | 307/411 [06:47<02:17,  1.33s/it] 75%|███████▍  | 308/411 [06:48<02:16,  1.32s/it] 75%|███████▌  | 309/411 [06:49<02:15,  1.32s/it] 75%|███████▌  | 310/411 [06:51<02:13,  1.32s/it] 76%|███████▌  | 311/411 [06:52<02:12,  1.32s/it] 76%|███████▌  | 312/411 [06:53<02:11,  1.32s/it] 76%|███████▌  | 313/411 [06:55<02:09,  1.32s/it] 76%|███████▋  | 314/411 [06:56<02:08,  1.32s/it] 77%|███████▋  | 315/411 [06:57<02:07,  1.32s/it] 77%|███████▋  | 316/411 [06:59<02:05,  1.32s/it] 77%|███████▋  | 317/411 [07:00<02:04,  1.33s/it] 77%|███████▋  | 318/411 [07:01<02:03,  1.32s/it] 78%|███████▊  | 319/411 [07:03<02:01,  1.32s/it] 78%|███████▊  | 320/411 [07:04<02:00,  1.32s/it] 78%|███████▊  | 321/411 [07:05<01:59,  1.32s/it] 78%|███████▊  | 322/411 [07:07<01:57,  1.32s/it] 79%|███████▊  | 323/411 [07:08<01:56,  1.32s/it] 79%|███████▉  | 324/411 [07:09<01:55,  1.32s/it] 79%|███████▉  | 325/411 [07:10<01:53,  1.32s/it] 79%|███████▉  | 326/411 [07:12<01:52,  1.32s/it] 80%|███████▉  | 327/411 [07:13<01:51,  1.32s/it] 80%|███████▉  | 328/411 [07:14<01:49,  1.32s/it] 80%|████████  | 329/411 [07:16<01:48,  1.32s/it] 80%|████████  | 330/411 [07:17<01:47,  1.32s/it] 81%|████████  | 331/411 [07:18<01:45,  1.32s/it] 81%|████████  | 332/411 [07:20<01:44,  1.32s/it] 81%|████████  | 333/411 [07:21<01:43,  1.32s/it] 81%|████████▏ | 334/411 [07:22<01:42,  1.32s/it] 82%|████████▏ | 335/411 [07:24<01:40,  1.32s/it] 82%|████████▏ | 336/411 [07:25<01:39,  1.32s/it] 82%|████████▏ | 337/411 [07:26<01:38,  1.32s/it] 82%|████████▏ | 338/411 [07:28<01:36,  1.32s/it] 82%|████████▏ | 339/411 [07:29<01:35,  1.32s/it] 83%|████████▎ | 340/411 [07:30<01:34,  1.32s/it] 83%|████████▎ | 341/411 [07:32<01:32,  1.32s/it] 83%|████████▎ | 342/411 [07:33<01:31,  1.32s/it] 83%|████████▎ | 343/411 [07:34<01:30,  1.32s/it] 84%|████████▎ | 344/411 [07:36<01:28,  1.32s/it] 84%|████████▍ | 345/411 [07:37<01:27,  1.32s/it] 84%|████████▍ | 346/411 [07:38<01:26,  1.32s/it] 84%|████████▍ | 347/411 [07:40<01:24,  1.32s/it] 85%|████████▍ | 348/411 [07:41<01:23,  1.32s/it] 85%|████████▍ | 349/411 [07:42<01:22,  1.32s/it] 85%|████████▌ | 350/411 [07:44<01:20,  1.33s/it] 85%|████████▌ | 351/411 [07:45<01:19,  1.33s/it] 86%|████████▌ | 352/411 [07:46<01:18,  1.33s/it] 86%|████████▌ | 353/411 [07:48<01:16,  1.33s/it] 86%|████████▌ | 354/411 [07:49<01:15,  1.32s/it] 86%|████████▋ | 355/411 [07:50<01:14,  1.32s/it] 87%|████████▋ | 356/411 [07:52<01:12,  1.32s/it] 87%|████████▋ | 357/411 [07:53<01:11,  1.32s/it] 87%|████████▋ | 358/411 [07:54<01:10,  1.32s/it] 87%|████████▋ | 359/411 [07:56<01:08,  1.32s/it] 88%|████████▊ | 360/411 [07:57<01:07,  1.32s/it] 88%|████████▊ | 361/411 [07:58<01:06,  1.32s/it] 88%|████████▊ | 362/411 [07:59<01:04,  1.32s/it] 88%|████████▊ | 363/411 [08:01<01:03,  1.32s/it] 89%|████████▊ | 364/411 [08:02<01:02,  1.32s/it] 89%|████████▉ | 365/411 [08:03<01:00,  1.32s/it] 89%|████████▉ | 366/411 [08:05<00:59,  1.32s/it] 89%|████████▉ | 367/411 [08:06<00:58,  1.32s/it] 90%|████████▉ | 368/411 [08:07<00:56,  1.32s/it] 90%|████████▉ | 369/411 [08:09<00:55,  1.32s/it] 90%|█████████ | 370/411 [08:10<00:54,  1.32s/it] 90%|█████████ | 371/411 [08:11<00:52,  1.32s/it] 91%|█████████ | 372/411 [08:13<00:51,  1.32s/it] 91%|█████████ | 373/411 [08:14<00:50,  1.32s/it] 91%|█████████ | 374/411 [08:15<00:48,  1.32s/it] 91%|█████████ | 375/411 [08:17<00:47,  1.32s/it] 91%|█████████▏| 376/411 [08:18<00:46,  1.32s/it] 92%|█████████▏| 377/411 [08:19<00:45,  1.32s/it] 92%|█████████▏| 378/411 [08:21<00:43,  1.32s/it] 92%|█████████▏| 379/411 [08:22<00:42,  1.32s/it] 92%|█████████▏| 380/411 [08:23<00:41,  1.32s/it] 93%|█████████▎| 381/411 [08:25<00:39,  1.32s/it] 93%|█████████▎| 382/411 [08:26<00:38,  1.32s/it] 93%|█████████▎| 383/411 [08:27<00:37,  1.32s/it] 93%|█████████▎| 384/411 [08:29<00:35,  1.32s/it] 94%|█████████▎| 385/411 [08:30<00:34,  1.32s/it] 94%|█████████▍| 386/411 [08:31<00:33,  1.32s/it] 94%|█████████▍| 387/411 [08:33<00:31,  1.32s/it] 94%|█████████▍| 388/411 [08:34<00:30,  1.32s/it] 95%|█████████▍| 389/411 [08:35<00:29,  1.32s/it] 95%|█████████▍| 390/411 [08:37<00:27,  1.32s/it] 95%|█████████▌| 391/411 [08:38<00:26,  1.32s/it] 95%|█████████▌| 392/411 [08:39<00:25,  1.32s/it] 96%|█████████▌| 393/411 [08:41<00:23,  1.32s/it] 96%|█████████▌| 394/411 [08:42<00:22,  1.32s/it] 96%|█████████▌| 395/411 [08:43<00:21,  1.32s/it] 96%|█████████▋| 396/411 [08:45<00:19,  1.32s/it] 97%|█████████▋| 397/411 [08:46<00:18,  1.32s/it] 97%|█████████▋| 398/411 [08:47<00:17,  1.32s/it] 97%|█████████▋| 399/411 [08:48<00:15,  1.32s/it] 97%|█████████▋| 400/411 [08:50<00:14,  1.32s/it]                                                  97%|█████████▋| 400/411 [08:50<00:14,  1.32s/it] 98%|█████████▊| 401/411 [08:51<00:13,  1.33s/it] 98%|█████████▊| 402/411 [08:52<00:11,  1.32s/it] 98%|█████████▊| 403/411 [08:54<00:10,  1.32s/it] 98%|█████████▊| 404/411 [08:55<00:09,  1.32s/it] 99%|█████████▊| 405/411 [08:56<00:07,  1.32s/it] 99%|█████████▉| 406/411 [08:58<00:06,  1.32s/it] 99%|█████████▉| 407/411 [08:59<00:05,  1.32s/it] 99%|█████████▉| 408/411 [09:00<00:03,  1.32s/it]100%|█████████▉| 409/411 [09:02<00:02,  1.32s/it]100%|█████████▉| 410/411 [09:03<00:01,  1.32s/it]100%|██████████| 411/411 [09:04<00:00,  1.15s/it]/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1519a4e4dc30>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 26b36017-d6ef-4281-a060-1dc1032106b2)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                 100%|██████████| 411/411 [09:04<00:00,  1.15s/it]100%|██████████| 411/411 [09:04<00:00,  1.32s/it]
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1519a4e756c0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 27445753-8b00-4a0a-912d-0b603969800e)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'loss': 2.5106, 'grad_norm': 3.0928680896759033, 'learning_rate': 1.51338199513382e-05, 'epoch': 0.24}
{'loss': 0.6711, 'grad_norm': 2.8939783573150635, 'learning_rate': 1.0267639902676401e-05, 'epoch': 0.49}
{'loss': 0.3222, 'grad_norm': 4.1169939041137695, 'learning_rate': 5.401459854014599e-06, 'epoch': 0.73}
{'loss': 0.2875, 'grad_norm': 2.9700663089752197, 'learning_rate': 5.352798053527981e-07, 'epoch': 0.97}
{'train_runtime': 544.4935, 'train_samples_per_second': 3.016, 'train_steps_per_second': 0.755, 'train_loss': 0.9298543373163599, 'epoch': 1.0}
Saving model to ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_prop_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_58
Fine-tuning completed successfully!
2025-05-01 17:15:59.971886: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 17:15:59.984864: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746134159.999463  311667 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746134160.003886  311667 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746134160.016413  311667 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746134160.016435  311667 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746134160.016437  311667 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746134160.016439  311667 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 17:16:00.020320: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
=== Fine-tuning Configuration ===
Model: 
Training dataset: 
Random seed: 36
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: 
===========================
CUDA available: True
CUDA device count: 1
CUDA current device: 0
CUDA device name: NVIDIA A100 80GB PCIe MIG 3g.40gb
train_config(model_name='meta-llama/Llama-3.2-3B-Instruct', enable_fsdp=False, low_cpu_fsdp=False, run_validation=True, batch_size_training=4, gradient_accumulation_steps=1, num_epochs=1, num_workers_dataloader=1, lr=2e-05, weight_decay=0.0, gamma=0.85, seed=58, use_fp16=False, mixed_precision=True, val_batch_size=1, peft_method='lora', use_peft=False, output_dir='../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_true_prop_var/meta-llama/Llama-3.2-3B-Instruct_58', freeze_layers=False, num_freeze_layers=1, quantization=True, one_gpu=False, save_model=True, save_every_epoch=True, dist_checkpoint_root_folder='fsdp', dist_checkpoint_folder='fine-tuned', save_optimizer=False, use_fast_kernels=False, use_lora=True, save_full_gradients=False, system_message='You are a helpful assistant. Provide your best guess or estimate given the scenario. Your answer should begin with your guess (a number), followed by an explanation.', ft_dataset_name='no_bias_true_prop_var', dataset='datasets/ft/no_bias_true_prop_var.jsonl', eval_dataset_name='bbq_subset_100', eval_dataset=None, eval_output_file=None, base_output_file=None)
Clearing GPU cache
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.33s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.44s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Applying LoRA adapter...
trainable params: 2,293,760 || all params: 3,215,046,656 || trainable%: 0.0713
Loading data from datasets/ft/no_bias_true_prop_var.jsonl...
Using all 2880 examples from dataset
Map:   0%|          | 0/2880 [00:00<?, ? examples/s]Map:  97%|█████████▋| 2780/2880 [00:00<00:00, 27674.20 examples/s]Map: 100%|██████████| 2880/2880 [00:00<00:00, 27144.18 examples/s]
Map:   0%|          | 0/2880 [00:00<?, ? examples/s]Map:  35%|███▍      | 1000/2880 [00:00<00:00, 2361.90 examples/s]Map:  69%|██████▉   | 2000/2880 [00:00<00:00, 2454.53 examples/s]Map: 100%|██████████| 2880/2880 [00:01<00:00, 2491.24 examples/s]Map: 100%|██████████| 2880/2880 [00:01<00:00, 2451.55 examples/s]
/home/janeec/FairTune/finetune_w_eval_llama.py:297: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
=== Fine-tuning Configuration ===
Model: meta-llama/Llama-3.2-3B-Instruct
Training dataset: datasets/ft/no_bias_true_prop_var.jsonl
Random seed: 58
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_true_prop_var/meta-llama/Llama-3.2-3B-Instruct_58
===========================
SEED CHECK:, should be: 58, seed is: 58
Starting fine-tuning...
  0%|          | 0/720 [00:00<?, ?it/s]  0%|          | 1/720 [00:01<18:15,  1.52s/it]  0%|          | 2/720 [00:02<16:54,  1.41s/it]  0%|          | 3/720 [00:04<16:24,  1.37s/it]  1%|          | 4/720 [00:05<16:10,  1.36s/it]  1%|          | 5/720 [00:06<16:01,  1.34s/it]  1%|          | 6/720 [00:08<15:55,  1.34s/it]  1%|          | 7/720 [00:09<15:51,  1.33s/it]  1%|          | 8/720 [00:10<15:48,  1.33s/it]  1%|▏         | 9/720 [00:12<15:45,  1.33s/it]  1%|▏         | 10/720 [00:13<15:43,  1.33s/it]  2%|▏         | 11/720 [00:14<15:41,  1.33s/it]  2%|▏         | 12/720 [00:16<15:39,  1.33s/it]  2%|▏         | 13/720 [00:17<15:38,  1.33s/it]  2%|▏         | 14/720 [00:18<15:38,  1.33s/it]  2%|▏         | 15/720 [00:20<15:36,  1.33s/it]  2%|▏         | 16/720 [00:21<15:35,  1.33s/it]  2%|▏         | 17/720 [00:22<15:33,  1.33s/it]  2%|▎         | 18/720 [00:24<15:31,  1.33s/it]  3%|▎         | 19/720 [00:25<15:30,  1.33s/it]  3%|▎         | 20/720 [00:26<15:28,  1.33s/it]  3%|▎         | 21/720 [00:28<15:27,  1.33s/it]  3%|▎         | 22/720 [00:29<15:25,  1.33s/it]  3%|▎         | 23/720 [00:30<15:24,  1.33s/it]  3%|▎         | 24/720 [00:32<15:23,  1.33s/it]  3%|▎         | 25/720 [00:33<15:21,  1.33s/it]  4%|▎         | 26/720 [00:34<15:20,  1.33s/it]  4%|▍         | 27/720 [00:36<15:19,  1.33s/it]  4%|▍         | 28/720 [00:37<15:17,  1.33s/it]  4%|▍         | 29/720 [00:38<15:16,  1.33s/it]  4%|▍         | 30/720 [00:40<15:15,  1.33s/it]  4%|▍         | 31/720 [00:41<15:13,  1.33s/it]  4%|▍         | 32/720 [00:42<15:12,  1.33s/it]  5%|▍         | 33/720 [00:43<15:11,  1.33s/it]  5%|▍         | 34/720 [00:45<15:10,  1.33s/it]  5%|▍         | 35/720 [00:46<15:08,  1.33s/it]  5%|▌         | 36/720 [00:47<15:07,  1.33s/it]  5%|▌         | 37/720 [00:49<15:06,  1.33s/it]  5%|▌         | 38/720 [00:50<15:05,  1.33s/it]  5%|▌         | 39/720 [00:51<15:03,  1.33s/it]  6%|▌         | 40/720 [00:53<15:02,  1.33s/it]  6%|▌         | 41/720 [00:54<15:00,  1.33s/it]  6%|▌         | 42/720 [00:55<14:59,  1.33s/it]  6%|▌         | 43/720 [00:57<14:58,  1.33s/it]  6%|▌         | 44/720 [00:58<14:57,  1.33s/it]  6%|▋         | 45/720 [00:59<14:55,  1.33s/it]  6%|▋         | 46/720 [01:01<14:54,  1.33s/it]  7%|▋         | 47/720 [01:02<14:52,  1.33s/it]  7%|▋         | 48/720 [01:03<14:51,  1.33s/it]  7%|▋         | 49/720 [01:05<14:49,  1.33s/it]  7%|▋         | 50/720 [01:06<14:48,  1.33s/it]  7%|▋         | 51/720 [01:07<14:47,  1.33s/it]  7%|▋         | 52/720 [01:09<14:45,  1.33s/it]  7%|▋         | 53/720 [01:10<14:44,  1.33s/it]  8%|▊         | 54/720 [01:11<14:43,  1.33s/it]  8%|▊         | 55/720 [01:13<14:41,  1.33s/it]  8%|▊         | 56/720 [01:14<14:40,  1.33s/it]  8%|▊         | 57/720 [01:15<14:39,  1.33s/it]  8%|▊         | 58/720 [01:17<14:37,  1.33s/it]  8%|▊         | 59/720 [01:18<14:40,  1.33s/it]  8%|▊         | 60/720 [01:19<14:37,  1.33s/it]  8%|▊         | 61/720 [01:21<14:35,  1.33s/it]  9%|▊         | 62/720 [01:22<14:33,  1.33s/it]  9%|▉         | 63/720 [01:23<14:32,  1.33s/it]  9%|▉         | 64/720 [01:25<14:30,  1.33s/it]  9%|▉         | 65/720 [01:26<14:28,  1.33s/it]  9%|▉         | 66/720 [01:27<14:27,  1.33s/it]  9%|▉         | 67/720 [01:29<14:26,  1.33s/it]  9%|▉         | 68/720 [01:30<14:24,  1.33s/it] 10%|▉         | 69/720 [01:31<14:23,  1.33s/it] 10%|▉         | 70/720 [01:33<14:22,  1.33s/it] 10%|▉         | 71/720 [01:34<14:20,  1.33s/it] 10%|█         | 72/720 [01:35<14:19,  1.33s/it] 10%|█         | 73/720 [01:37<14:18,  1.33s/it] 10%|█         | 74/720 [01:38<14:16,  1.33s/it] 10%|█         | 75/720 [01:39<14:15,  1.33s/it] 11%|█         | 76/720 [01:41<14:14,  1.33s/it] 11%|█         | 77/720 [01:42<14:12,  1.33s/it] 11%|█         | 78/720 [01:43<14:11,  1.33s/it] 11%|█         | 79/720 [01:45<14:10,  1.33s/it] 11%|█         | 80/720 [01:46<14:08,  1.33s/it] 11%|█▏        | 81/720 [01:47<14:07,  1.33s/it] 11%|█▏        | 82/720 [01:48<14:06,  1.33s/it] 12%|█▏        | 83/720 [01:50<14:05,  1.33s/it] 12%|█▏        | 84/720 [01:51<14:03,  1.33s/it] 12%|█▏        | 85/720 [01:52<14:02,  1.33s/it] 12%|█▏        | 86/720 [01:54<14:00,  1.33s/it] 12%|█▏        | 87/720 [01:55<13:59,  1.33s/it] 12%|█▏        | 88/720 [01:56<13:58,  1.33s/it] 12%|█▏        | 89/720 [01:58<13:56,  1.33s/it] 12%|█▎        | 90/720 [01:59<13:55,  1.33s/it] 13%|█▎        | 91/720 [02:00<13:53,  1.33s/it] 13%|█▎        | 92/720 [02:02<13:52,  1.33s/it] 13%|█▎        | 93/720 [02:03<13:51,  1.33s/it] 13%|█▎        | 94/720 [02:04<13:49,  1.33s/it] 13%|█▎        | 95/720 [02:06<13:48,  1.33s/it] 13%|█▎        | 96/720 [02:07<13:47,  1.33s/it] 13%|█▎        | 97/720 [02:08<13:45,  1.33s/it] 14%|█▎        | 98/720 [02:10<13:44,  1.33s/it] 14%|█▍        | 99/720 [02:11<13:43,  1.33s/it] 14%|█▍        | 100/720 [02:12<13:41,  1.33s/it]                                                  14%|█▍        | 100/720 [02:12<13:41,  1.33s/it] 14%|█▍        | 101/720 [02:14<13:40,  1.33s/it] 14%|█▍        | 102/720 [02:15<13:39,  1.33s/it] 14%|█▍        | 103/720 [02:16<13:37,  1.33s/it] 14%|█▍        | 104/720 [02:18<13:36,  1.33s/it] 15%|█▍        | 105/720 [02:19<13:35,  1.33s/it] 15%|█▍        | 106/720 [02:20<13:33,  1.33s/it] 15%|█▍        | 107/720 [02:22<13:32,  1.33s/it] 15%|█▌        | 108/720 [02:23<13:30,  1.33s/it] 15%|█▌        | 109/720 [02:24<13:29,  1.32s/it] 15%|█▌        | 110/720 [02:26<13:28,  1.33s/it] 15%|█▌        | 111/720 [02:27<13:27,  1.33s/it] 16%|█▌        | 112/720 [02:28<13:25,  1.33s/it] 16%|█▌        | 113/720 [02:30<13:24,  1.33s/it] 16%|█▌        | 114/720 [02:31<13:23,  1.33s/it] 16%|█▌        | 115/720 [02:32<13:21,  1.33s/it] 16%|█▌        | 116/720 [02:34<13:20,  1.33s/it] 16%|█▋        | 117/720 [02:35<13:18,  1.33s/it] 16%|█▋        | 118/720 [02:36<13:17,  1.33s/it] 17%|█▋        | 119/720 [02:38<13:16,  1.33s/it] 17%|█▋        | 120/720 [02:39<13:15,  1.33s/it] 17%|█▋        | 121/720 [02:40<13:13,  1.32s/it] 17%|█▋        | 122/720 [02:42<13:12,  1.33s/it] 17%|█▋        | 123/720 [02:43<13:10,  1.32s/it] 17%|█▋        | 124/720 [02:44<13:09,  1.33s/it] 17%|█▋        | 125/720 [02:45<13:08,  1.33s/it] 18%|█▊        | 126/720 [02:47<13:07,  1.33s/it] 18%|█▊        | 127/720 [02:48<13:07,  1.33s/it] 18%|█▊        | 128/720 [02:49<13:08,  1.33s/it] 18%|█▊        | 129/720 [02:51<13:06,  1.33s/it] 18%|█▊        | 130/720 [02:52<13:04,  1.33s/it] 18%|█▊        | 131/720 [02:53<13:02,  1.33s/it] 18%|█▊        | 132/720 [02:55<13:00,  1.33s/it] 18%|█▊        | 133/720 [02:56<12:58,  1.33s/it] 19%|█▊        | 134/720 [02:57<12:56,  1.33s/it] 19%|█▉        | 135/720 [02:59<12:55,  1.33s/it] 19%|█▉        | 136/720 [03:00<12:54,  1.33s/it] 19%|█▉        | 137/720 [03:01<12:52,  1.33s/it] 19%|█▉        | 138/720 [03:03<12:51,  1.33s/it] 19%|█▉        | 139/720 [03:04<12:50,  1.33s/it] 19%|█▉        | 140/720 [03:05<12:48,  1.33s/it] 20%|█▉        | 141/720 [03:07<12:47,  1.33s/it] 20%|█▉        | 142/720 [03:08<12:46,  1.33s/it] 20%|█▉        | 143/720 [03:09<12:44,  1.33s/it] 20%|██        | 144/720 [03:11<12:43,  1.33s/it] 20%|██        | 145/720 [03:12<12:41,  1.33s/it] 20%|██        | 146/720 [03:13<12:40,  1.33s/it] 20%|██        | 147/720 [03:15<12:39,  1.33s/it] 21%|██        | 148/720 [03:16<12:38,  1.33s/it] 21%|██        | 149/720 [03:17<12:36,  1.33s/it] 21%|██        | 150/720 [03:19<12:35,  1.33s/it] 21%|██        | 151/720 [03:20<12:34,  1.33s/it] 21%|██        | 152/720 [03:21<12:32,  1.33s/it] 21%|██▏       | 153/720 [03:23<12:31,  1.33s/it] 21%|██▏       | 154/720 [03:24<12:30,  1.33s/it] 22%|██▏       | 155/720 [03:25<12:28,  1.33s/it] 22%|██▏       | 156/720 [03:27<12:27,  1.33s/it] 22%|██▏       | 157/720 [03:28<12:26,  1.33s/it] 22%|██▏       | 158/720 [03:29<12:24,  1.33s/it] 22%|██▏       | 159/720 [03:31<12:23,  1.33s/it] 22%|██▏       | 160/720 [03:32<12:22,  1.33s/it] 22%|██▏       | 161/720 [03:33<12:21,  1.33s/it] 22%|██▎       | 162/720 [03:35<12:19,  1.33s/it] 23%|██▎       | 163/720 [03:36<12:18,  1.33s/it] 23%|██▎       | 164/720 [03:37<12:16,  1.33s/it] 23%|██▎       | 165/720 [03:39<12:15,  1.33s/it] 23%|██▎       | 166/720 [03:40<12:14,  1.33s/it] 23%|██▎       | 167/720 [03:41<12:12,  1.33s/it] 23%|██▎       | 168/720 [03:43<12:11,  1.33s/it] 23%|██▎       | 169/720 [03:44<12:10,  1.33s/it] 24%|██▎       | 170/720 [03:45<12:08,  1.33s/it] 24%|██▍       | 171/720 [03:46<12:07,  1.33s/it] 24%|██▍       | 172/720 [03:48<12:06,  1.33s/it] 24%|██▍       | 173/720 [03:49<12:04,  1.33s/it] 24%|██▍       | 174/720 [03:50<12:03,  1.33s/it] 24%|██▍       | 175/720 [03:52<12:02,  1.33s/it] 24%|██▍       | 176/720 [03:53<12:01,  1.33s/it] 25%|██▍       | 177/720 [03:54<11:59,  1.33s/it] 25%|██▍       | 178/720 [03:56<11:58,  1.33s/it] 25%|██▍       | 179/720 [03:57<11:57,  1.33s/it] 25%|██▌       | 180/720 [03:58<11:55,  1.33s/it] 25%|██▌       | 181/720 [04:00<11:54,  1.33s/it] 25%|██▌       | 182/720 [04:01<11:53,  1.33s/it] 25%|██▌       | 183/720 [04:02<11:51,  1.33s/it] 26%|██▌       | 184/720 [04:04<11:50,  1.33s/it] 26%|██▌       | 185/720 [04:05<11:49,  1.33s/it] 26%|██▌       | 186/720 [04:06<11:47,  1.33s/it] 26%|██▌       | 187/720 [04:08<11:46,  1.33s/it] 26%|██▌       | 188/720 [04:09<11:45,  1.33s/it] 26%|██▋       | 189/720 [04:10<11:43,  1.33s/it] 26%|██▋       | 190/720 [04:12<11:42,  1.33s/it] 27%|██▋       | 191/720 [04:13<11:41,  1.33s/it] 27%|██▋       | 192/720 [04:14<11:39,  1.33s/it] 27%|██▋       | 193/720 [04:16<11:38,  1.33s/it] 27%|██▋       | 194/720 [04:17<11:37,  1.33s/it] 27%|██▋       | 195/720 [04:18<11:37,  1.33s/it] 27%|██▋       | 196/720 [04:20<11:35,  1.33s/it] 27%|██▋       | 197/720 [04:21<11:33,  1.33s/it] 28%|██▊       | 198/720 [04:22<11:32,  1.33s/it] 28%|██▊       | 199/720 [04:24<11:30,  1.33s/it] 28%|██▊       | 200/720 [04:25<11:29,  1.33s/it]                                                  28%|██▊       | 200/720 [04:25<11:29,  1.33s/it] 28%|██▊       | 201/720 [04:26<11:28,  1.33s/it] 28%|██▊       | 202/720 [04:28<11:26,  1.33s/it] 28%|██▊       | 203/720 [04:29<11:25,  1.33s/it] 28%|██▊       | 204/720 [04:30<11:23,  1.33s/it] 28%|██▊       | 205/720 [04:32<11:22,  1.33s/it] 29%|██▊       | 206/720 [04:33<11:21,  1.33s/it] 29%|██▉       | 207/720 [04:34<11:19,  1.33s/it] 29%|██▉       | 208/720 [04:36<11:18,  1.33s/it] 29%|██▉       | 209/720 [04:37<11:17,  1.33s/it] 29%|██▉       | 210/720 [04:38<11:15,  1.33s/it] 29%|██▉       | 211/720 [04:40<11:14,  1.33s/it] 29%|██▉       | 212/720 [04:41<11:13,  1.33s/it] 30%|██▉       | 213/720 [04:42<11:11,  1.33s/it] 30%|██▉       | 214/720 [04:43<11:10,  1.33s/it] 30%|██▉       | 215/720 [04:45<11:09,  1.33s/it] 30%|███       | 216/720 [04:46<11:07,  1.33s/it] 30%|███       | 217/720 [04:47<11:06,  1.33s/it] 30%|███       | 218/720 [04:49<11:05,  1.32s/it] 30%|███       | 219/720 [04:50<11:03,  1.32s/it] 31%|███       | 220/720 [04:51<11:02,  1.33s/it] 31%|███       | 221/720 [04:53<11:01,  1.33s/it] 31%|███       | 222/720 [04:54<11:00,  1.33s/it] 31%|███       | 223/720 [04:55<10:58,  1.33s/it] 31%|███       | 224/720 [04:57<10:57,  1.33s/it] 31%|███▏      | 225/720 [04:58<10:56,  1.33s/it] 31%|███▏      | 226/720 [04:59<10:54,  1.33s/it] 32%|███▏      | 227/720 [05:01<10:53,  1.33s/it] 32%|███▏      | 228/720 [05:02<10:52,  1.33s/it] 32%|███▏      | 229/720 [05:03<10:50,  1.33s/it] 32%|███▏      | 230/720 [05:05<10:49,  1.33s/it] 32%|███▏      | 231/720 [05:06<10:47,  1.33s/it] 32%|███▏      | 232/720 [05:07<10:46,  1.33s/it] 32%|███▏      | 233/720 [05:09<10:45,  1.33s/it] 32%|███▎      | 234/720 [05:10<10:44,  1.33s/it] 33%|███▎      | 235/720 [05:11<10:42,  1.33s/it] 33%|███▎      | 236/720 [05:13<10:41,  1.33s/it] 33%|███▎      | 237/720 [05:14<10:39,  1.32s/it] 33%|███▎      | 238/720 [05:15<10:38,  1.33s/it] 33%|███▎      | 239/720 [05:17<10:37,  1.33s/it] 33%|███▎      | 240/720 [05:18<10:37,  1.33s/it] 33%|███▎      | 241/720 [05:19<10:35,  1.33s/it] 34%|███▎      | 242/720 [05:21<10:34,  1.33s/it] 34%|███▍      | 243/720 [05:22<10:32,  1.33s/it] 34%|███▍      | 244/720 [05:23<10:31,  1.33s/it] 34%|███▍      | 245/720 [05:25<10:29,  1.33s/it] 34%|███▍      | 246/720 [05:26<10:27,  1.32s/it] 34%|███▍      | 247/720 [05:27<10:26,  1.32s/it] 34%|███▍      | 248/720 [05:29<10:25,  1.32s/it] 35%|███▍      | 249/720 [05:30<10:24,  1.32s/it] 35%|███▍      | 250/720 [05:31<10:22,  1.33s/it] 35%|███▍      | 251/720 [05:33<10:21,  1.33s/it] 35%|███▌      | 252/720 [05:34<10:20,  1.33s/it] 35%|███▌      | 253/720 [05:35<10:18,  1.33s/it] 35%|███▌      | 254/720 [05:36<10:17,  1.32s/it] 35%|███▌      | 255/720 [05:38<10:16,  1.32s/it] 36%|███▌      | 256/720 [05:39<10:14,  1.32s/it] 36%|███▌      | 257/720 [05:40<10:13,  1.32s/it] 36%|███▌      | 258/720 [05:42<10:12,  1.32s/it] 36%|███▌      | 259/720 [05:43<10:10,  1.32s/it] 36%|███▌      | 260/720 [05:44<10:09,  1.32s/it] 36%|███▋      | 261/720 [05:46<10:07,  1.32s/it] 36%|███▋      | 262/720 [05:47<10:06,  1.32s/it] 37%|███▋      | 263/720 [05:48<10:05,  1.32s/it] 37%|███▋      | 264/720 [05:50<10:03,  1.32s/it] 37%|███▋      | 265/720 [05:51<10:02,  1.32s/it] 37%|███▋      | 266/720 [05:52<10:01,  1.32s/it] 37%|███▋      | 267/720 [05:54<10:00,  1.32s/it] 37%|███▋      | 268/720 [05:55<09:58,  1.32s/it] 37%|███▋      | 269/720 [05:56<09:57,  1.32s/it] 38%|███▊      | 270/720 [05:58<09:56,  1.32s/it] 38%|███▊      | 271/720 [05:59<09:54,  1.32s/it] 38%|███▊      | 272/720 [06:00<09:53,  1.32s/it] 38%|███▊      | 273/720 [06:02<09:51,  1.32s/it] 38%|███▊      | 274/720 [06:03<09:50,  1.32s/it] 38%|███▊      | 275/720 [06:04<09:49,  1.32s/it] 38%|███▊      | 276/720 [06:06<09:48,  1.32s/it] 38%|███▊      | 277/720 [06:07<09:46,  1.32s/it] 39%|███▊      | 278/720 [06:08<09:45,  1.32s/it] 39%|███▉      | 279/720 [06:10<09:44,  1.32s/it] 39%|███▉      | 280/720 [06:11<09:42,  1.32s/it] 39%|███▉      | 281/720 [06:12<09:41,  1.32s/it] 39%|███▉      | 282/720 [06:14<09:40,  1.32s/it] 39%|███▉      | 283/720 [06:15<09:38,  1.32s/it] 39%|███▉      | 284/720 [06:16<09:37,  1.32s/it] 40%|███▉      | 285/720 [06:18<09:36,  1.32s/it] 40%|███▉      | 286/720 [06:19<09:34,  1.32s/it] 40%|███▉      | 287/720 [06:20<09:33,  1.32s/it] 40%|████      | 288/720 [06:22<09:32,  1.32s/it] 40%|████      | 289/720 [06:23<09:31,  1.32s/it] 40%|████      | 290/720 [06:24<09:29,  1.33s/it] 40%|████      | 291/720 [06:26<09:28,  1.33s/it] 41%|████      | 292/720 [06:27<09:27,  1.33s/it] 41%|████      | 293/720 [06:28<09:25,  1.33s/it] 41%|████      | 294/720 [06:29<09:24,  1.33s/it] 41%|████      | 295/720 [06:31<09:23,  1.33s/it] 41%|████      | 296/720 [06:32<09:21,  1.33s/it] 41%|████▏     | 297/720 [06:33<09:20,  1.33s/it] 41%|████▏     | 298/720 [06:35<09:19,  1.33s/it] 42%|████▏     | 299/720 [06:36<09:17,  1.32s/it] 42%|████▏     | 300/720 [06:37<09:16,  1.32s/it]                                                  42%|████▏     | 300/720 [06:37<09:16,  1.32s/it] 42%|████▏     | 301/720 [06:39<09:15,  1.32s/it] 42%|████▏     | 302/720 [06:40<09:13,  1.32s/it] 42%|████▏     | 303/720 [06:41<09:12,  1.32s/it] 42%|████▏     | 304/720 [06:43<09:11,  1.32s/it] 42%|████▏     | 305/720 [06:44<09:09,  1.32s/it] 42%|████▎     | 306/720 [06:45<09:08,  1.32s/it] 43%|████▎     | 307/720 [06:47<09:07,  1.32s/it] 43%|████▎     | 308/720 [06:48<09:06,  1.33s/it] 43%|████▎     | 309/720 [06:49<09:05,  1.33s/it] 43%|████▎     | 310/720 [06:51<09:03,  1.33s/it] 43%|████▎     | 311/720 [06:52<09:02,  1.33s/it] 43%|████▎     | 312/720 [06:53<09:00,  1.33s/it] 43%|████▎     | 313/720 [06:55<08:59,  1.33s/it] 44%|████▎     | 314/720 [06:56<08:58,  1.33s/it] 44%|████▍     | 315/720 [06:57<08:56,  1.33s/it] 44%|████▍     | 316/720 [06:59<08:55,  1.33s/it] 44%|████▍     | 317/720 [07:00<08:54,  1.33s/it] 44%|████▍     | 318/720 [07:01<08:52,  1.32s/it] 44%|████▍     | 319/720 [07:03<08:51,  1.32s/it] 44%|████▍     | 320/720 [07:04<08:49,  1.32s/it] 45%|████▍     | 321/720 [07:05<08:48,  1.32s/it] 45%|████▍     | 322/720 [07:07<08:47,  1.32s/it] 45%|████▍     | 323/720 [07:08<08:45,  1.32s/it] 45%|████▌     | 324/720 [07:09<08:44,  1.32s/it] 45%|████▌     | 325/720 [07:11<08:43,  1.32s/it] 45%|████▌     | 326/720 [07:12<08:41,  1.32s/it] 45%|████▌     | 327/720 [07:13<08:40,  1.32s/it] 46%|████▌     | 328/720 [07:15<08:39,  1.32s/it] 46%|████▌     | 329/720 [07:16<08:37,  1.32s/it] 46%|████▌     | 330/720 [07:17<08:36,  1.32s/it] 46%|████▌     | 331/720 [07:19<08:35,  1.32s/it] 46%|████▌     | 332/720 [07:20<08:33,  1.32s/it] 46%|████▋     | 333/720 [07:21<08:32,  1.32s/it] 46%|████▋     | 334/720 [07:22<08:31,  1.32s/it] 47%|████▋     | 335/720 [07:24<08:30,  1.32s/it] 47%|████▋     | 336/720 [07:25<08:28,  1.32s/it] 47%|████▋     | 337/720 [07:26<08:27,  1.32s/it] 47%|████▋     | 338/720 [07:28<08:26,  1.32s/it] 47%|████▋     | 339/720 [07:29<08:24,  1.32s/it] 47%|████▋     | 340/720 [07:30<08:23,  1.33s/it] 47%|████▋     | 341/720 [07:32<08:22,  1.32s/it] 48%|████▊     | 342/720 [07:33<08:20,  1.32s/it] 48%|████▊     | 343/720 [07:34<08:19,  1.32s/it] 48%|████▊     | 344/720 [07:36<08:17,  1.32s/it] 48%|████▊     | 345/720 [07:37<08:16,  1.32s/it] 48%|████▊     | 346/720 [07:38<08:15,  1.32s/it] 48%|████▊     | 347/720 [07:40<08:14,  1.32s/it] 48%|████▊     | 348/720 [07:41<08:12,  1.32s/it] 48%|████▊     | 349/720 [07:42<08:11,  1.32s/it] 49%|████▊     | 350/720 [07:44<08:10,  1.32s/it] 49%|████▉     | 351/720 [07:45<08:08,  1.32s/it] 49%|████▉     | 352/720 [07:46<08:07,  1.32s/it] 49%|████▉     | 353/720 [07:48<08:05,  1.32s/it] 49%|████▉     | 354/720 [07:49<08:04,  1.32s/it] 49%|████▉     | 355/720 [07:50<08:03,  1.32s/it] 49%|████▉     | 356/720 [07:52<08:02,  1.32s/it] 50%|████▉     | 357/720 [07:53<08:00,  1.32s/it] 50%|████▉     | 358/720 [07:54<07:59,  1.32s/it] 50%|████▉     | 359/720 [07:56<07:58,  1.32s/it] 50%|█████     | 360/720 [07:57<07:56,  1.32s/it] 50%|█████     | 361/720 [07:58<07:55,  1.32s/it] 50%|█████     | 362/720 [08:00<07:53,  1.32s/it] 50%|█████     | 363/720 [08:01<07:52,  1.32s/it] 51%|█████     | 364/720 [08:02<07:51,  1.32s/it] 51%|█████     | 365/720 [08:04<07:50,  1.32s/it] 51%|█████     | 366/720 [08:05<07:48,  1.32s/it] 51%|█████     | 367/720 [08:06<07:47,  1.32s/it] 51%|█████     | 368/720 [08:08<07:46,  1.32s/it] 51%|█████▏    | 369/720 [08:09<07:44,  1.32s/it] 51%|█████▏    | 370/720 [08:10<07:43,  1.32s/it] 52%|█████▏    | 371/720 [08:11<07:42,  1.32s/it] 52%|█████▏    | 372/720 [08:13<07:40,  1.32s/it] 52%|█████▏    | 373/720 [08:14<07:39,  1.32s/it] 52%|█████▏    | 374/720 [08:15<07:38,  1.32s/it] 52%|█████▏    | 375/720 [08:17<07:36,  1.32s/it] 52%|█████▏    | 376/720 [08:18<07:36,  1.33s/it] 52%|█████▏    | 377/720 [08:19<07:35,  1.33s/it] 52%|█████▎    | 378/720 [08:21<07:33,  1.33s/it] 53%|█████▎    | 379/720 [08:22<07:32,  1.33s/it] 53%|█████▎    | 380/720 [08:23<07:30,  1.33s/it] 53%|█████▎    | 381/720 [08:25<07:29,  1.33s/it] 53%|█████▎    | 382/720 [08:26<07:27,  1.32s/it] 53%|█████▎    | 383/720 [08:27<07:26,  1.32s/it] 53%|█████▎    | 384/720 [08:29<07:25,  1.32s/it] 53%|█████▎    | 385/720 [08:30<07:23,  1.32s/it] 54%|█████▎    | 386/720 [08:31<07:22,  1.32s/it] 54%|█████▍    | 387/720 [08:33<07:21,  1.32s/it] 54%|█████▍    | 388/720 [08:34<07:19,  1.32s/it] 54%|█████▍    | 389/720 [08:35<07:18,  1.32s/it] 54%|█████▍    | 390/720 [08:37<07:17,  1.32s/it] 54%|█████▍    | 391/720 [08:38<07:15,  1.32s/it] 54%|█████▍    | 392/720 [08:39<07:14,  1.32s/it] 55%|█████▍    | 393/720 [08:41<07:13,  1.32s/it] 55%|█████▍    | 394/720 [08:42<07:11,  1.32s/it] 55%|█████▍    | 395/720 [08:43<07:10,  1.32s/it] 55%|█████▌    | 396/720 [08:45<07:09,  1.32s/it] 55%|█████▌    | 397/720 [08:46<07:07,  1.32s/it] 55%|█████▌    | 398/720 [08:47<07:06,  1.32s/it] 55%|█████▌    | 399/720 [08:49<07:04,  1.32s/it] 56%|█████▌    | 400/720 [08:50<07:03,  1.32s/it]                                                  56%|█████▌    | 400/720 [08:50<07:03,  1.32s/it] 56%|█████▌    | 401/720 [08:51<07:02,  1.32s/it] 56%|█████▌    | 402/720 [08:53<07:01,  1.32s/it] 56%|█████▌    | 403/720 [08:54<06:59,  1.32s/it] 56%|█████▌    | 404/720 [08:55<06:58,  1.32s/it] 56%|█████▋    | 405/720 [08:57<06:57,  1.32s/it] 56%|█████▋    | 406/720 [08:58<06:55,  1.32s/it] 57%|█████▋    | 407/720 [08:59<06:54,  1.32s/it] 57%|█████▋    | 408/720 [09:01<06:53,  1.32s/it] 57%|█████▋    | 409/720 [09:02<06:51,  1.32s/it] 57%|█████▋    | 410/720 [09:03<06:50,  1.32s/it] 57%|█████▋    | 411/720 [09:04<06:49,  1.32s/it] 57%|█████▋    | 412/720 [09:06<06:47,  1.32s/it] 57%|█████▋    | 413/720 [09:07<06:46,  1.32s/it] 57%|█████▊    | 414/720 [09:08<06:45,  1.32s/it] 58%|█████▊    | 415/720 [09:10<06:43,  1.32s/it] 58%|█████▊    | 416/720 [09:11<06:42,  1.32s/it] 58%|█████▊    | 417/720 [09:12<06:41,  1.32s/it] 58%|█████▊    | 418/720 [09:14<06:39,  1.32s/it] 58%|█████▊    | 419/720 [09:15<06:38,  1.32s/it] 58%|█████▊    | 420/720 [09:16<06:37,  1.32s/it] 58%|█████▊    | 421/720 [09:18<06:35,  1.32s/it] 59%|█████▊    | 422/720 [09:19<06:34,  1.32s/it] 59%|█████▉    | 423/720 [09:20<06:33,  1.32s/it] 59%|█████▉    | 424/720 [09:22<06:32,  1.32s/it] 59%|█████▉    | 425/720 [09:23<06:30,  1.32s/it] 59%|█████▉    | 426/720 [09:24<06:29,  1.32s/it] 59%|█████▉    | 427/720 [09:26<06:28,  1.32s/it] 59%|█████▉    | 428/720 [09:27<06:26,  1.32s/it] 60%|█████▉    | 429/720 [09:28<06:25,  1.32s/it] 60%|█████▉    | 430/720 [09:30<06:24,  1.32s/it] 60%|█████▉    | 431/720 [09:31<06:22,  1.32s/it] 60%|██████    | 432/720 [09:32<06:21,  1.32s/it] 60%|██████    | 433/720 [09:34<06:20,  1.32s/it] 60%|██████    | 434/720 [09:35<06:18,  1.32s/it] 60%|██████    | 435/720 [09:36<06:17,  1.32s/it] 61%|██████    | 436/720 [09:38<06:16,  1.32s/it] 61%|██████    | 437/720 [09:39<06:14,  1.32s/it] 61%|██████    | 438/720 [09:40<06:13,  1.32s/it] 61%|██████    | 439/720 [09:42<06:12,  1.32s/it] 61%|██████    | 440/720 [09:43<06:10,  1.32s/it] 61%|██████▏   | 441/720 [09:44<06:09,  1.32s/it] 61%|██████▏   | 442/720 [09:46<06:08,  1.32s/it] 62%|██████▏   | 443/720 [09:47<06:06,  1.32s/it] 62%|██████▏   | 444/720 [09:48<06:06,  1.33s/it] 62%|██████▏   | 445/720 [09:50<06:04,  1.33s/it] 62%|██████▏   | 446/720 [09:51<06:03,  1.33s/it] 62%|██████▏   | 447/720 [09:52<06:01,  1.32s/it] 62%|██████▏   | 448/720 [09:53<06:00,  1.32s/it] 62%|██████▏   | 449/720 [09:55<05:59,  1.32s/it] 62%|██████▎   | 450/720 [09:56<05:57,  1.32s/it] 63%|██████▎   | 451/720 [09:57<05:56,  1.32s/it] 63%|██████▎   | 452/720 [09:59<05:54,  1.32s/it] 63%|██████▎   | 453/720 [10:00<05:53,  1.32s/it] 63%|██████▎   | 454/720 [10:01<05:52,  1.32s/it] 63%|██████▎   | 455/720 [10:03<05:51,  1.32s/it] 63%|██████▎   | 456/720 [10:04<05:49,  1.32s/it] 63%|██████▎   | 457/720 [10:05<05:48,  1.32s/it] 64%|██████▎   | 458/720 [10:07<05:47,  1.32s/it] 64%|██████▍   | 459/720 [10:08<05:45,  1.32s/it] 64%|██████▍   | 460/720 [10:09<05:44,  1.32s/it] 64%|██████▍   | 461/720 [10:11<05:43,  1.32s/it] 64%|██████▍   | 462/720 [10:12<05:41,  1.32s/it] 64%|██████▍   | 463/720 [10:13<05:40,  1.32s/it] 64%|██████▍   | 464/720 [10:15<05:39,  1.32s/it] 65%|██████▍   | 465/720 [10:16<05:37,  1.32s/it] 65%|██████▍   | 466/720 [10:17<05:36,  1.32s/it] 65%|██████▍   | 467/720 [10:19<05:35,  1.32s/it] 65%|██████▌   | 468/720 [10:20<05:33,  1.32s/it] 65%|██████▌   | 469/720 [10:21<05:32,  1.32s/it] 65%|██████▌   | 470/720 [10:23<05:31,  1.32s/it] 65%|██████▌   | 471/720 [10:24<05:29,  1.32s/it] 66%|██████▌   | 472/720 [10:25<05:28,  1.32s/it] 66%|██████▌   | 473/720 [10:27<05:27,  1.32s/it] 66%|██████▌   | 474/720 [10:28<05:25,  1.32s/it] 66%|██████▌   | 475/720 [10:29<05:24,  1.32s/it] 66%|██████▌   | 476/720 [10:31<05:23,  1.32s/it] 66%|██████▋   | 477/720 [10:32<05:21,  1.32s/it] 66%|██████▋   | 478/720 [10:33<05:20,  1.32s/it] 67%|██████▋   | 479/720 [10:35<05:19,  1.32s/it] 67%|██████▋   | 480/720 [10:36<05:17,  1.32s/it] 67%|██████▋   | 481/720 [10:37<05:16,  1.32s/it] 67%|██████▋   | 482/720 [10:39<05:15,  1.32s/it] 67%|██████▋   | 483/720 [10:40<05:13,  1.32s/it] 67%|██████▋   | 484/720 [10:41<05:12,  1.32s/it] 67%|██████▋   | 485/720 [10:42<05:11,  1.32s/it] 68%|██████▊   | 486/720 [10:44<05:09,  1.32s/it] 68%|██████▊   | 487/720 [10:45<05:08,  1.32s/it] 68%|██████▊   | 488/720 [10:46<05:07,  1.32s/it] 68%|██████▊   | 489/720 [10:48<05:05,  1.32s/it] 68%|██████▊   | 490/720 [10:49<05:04,  1.32s/it] 68%|██████▊   | 491/720 [10:50<05:03,  1.32s/it] 68%|██████▊   | 492/720 [10:52<05:01,  1.32s/it] 68%|██████▊   | 493/720 [10:53<05:00,  1.32s/it] 69%|██████▊   | 494/720 [10:54<04:59,  1.32s/it] 69%|██████▉   | 495/720 [10:56<04:57,  1.32s/it] 69%|██████▉   | 496/720 [10:57<04:56,  1.32s/it] 69%|██████▉   | 497/720 [10:58<04:55,  1.32s/it] 69%|██████▉   | 498/720 [11:00<04:54,  1.32s/it] 69%|██████▉   | 499/720 [11:01<04:52,  1.32s/it] 69%|██████▉   | 500/720 [11:02<04:51,  1.32s/it]                                                  69%|██████▉   | 500/720 [11:02<04:51,  1.32s/it] 70%|██████▉   | 501/720 [11:04<04:50,  1.33s/it] 70%|██████▉   | 502/720 [11:05<04:48,  1.32s/it] 70%|██████▉   | 503/720 [11:06<04:47,  1.32s/it] 70%|███████   | 504/720 [11:08<04:46,  1.32s/it] 70%|███████   | 505/720 [11:09<04:44,  1.32s/it] 70%|███████   | 506/720 [11:10<04:43,  1.32s/it] 70%|███████   | 507/720 [11:12<04:42,  1.32s/it] 71%|███████   | 508/720 [11:13<04:40,  1.32s/it] 71%|███████   | 509/720 [11:14<04:39,  1.32s/it] 71%|███████   | 510/720 [11:16<04:38,  1.32s/it] 71%|███████   | 511/720 [11:17<04:36,  1.32s/it] 71%|███████   | 512/720 [11:18<04:35,  1.33s/it] 71%|███████▏  | 513/720 [11:20<04:34,  1.33s/it] 71%|███████▏  | 514/720 [11:21<04:33,  1.33s/it] 72%|███████▏  | 515/720 [11:22<04:31,  1.33s/it] 72%|███████▏  | 516/720 [11:24<04:30,  1.32s/it] 72%|███████▏  | 517/720 [11:25<04:28,  1.32s/it] 72%|███████▏  | 518/720 [11:26<04:27,  1.32s/it] 72%|███████▏  | 519/720 [11:28<04:26,  1.32s/it] 72%|███████▏  | 520/720 [11:29<04:24,  1.32s/it] 72%|███████▏  | 521/720 [11:30<04:23,  1.32s/it] 72%|███████▎  | 522/720 [11:31<04:22,  1.32s/it] 73%|███████▎  | 523/720 [11:33<04:20,  1.32s/it] 73%|███████▎  | 524/720 [11:34<04:19,  1.32s/it] 73%|███████▎  | 525/720 [11:35<04:18,  1.32s/it] 73%|███████▎  | 526/720 [11:37<04:16,  1.32s/it] 73%|███████▎  | 527/720 [11:38<04:15,  1.32s/it] 73%|███████▎  | 528/720 [11:39<04:14,  1.32s/it] 73%|███████▎  | 529/720 [11:41<04:12,  1.32s/it] 74%|███████▎  | 530/720 [11:42<04:11,  1.32s/it] 74%|███████▍  | 531/720 [11:43<04:10,  1.32s/it] 74%|███████▍  | 532/720 [11:45<04:08,  1.32s/it] 74%|███████▍  | 533/720 [11:46<04:07,  1.32s/it] 74%|███████▍  | 534/720 [11:47<04:06,  1.32s/it] 74%|███████▍  | 535/720 [11:49<04:04,  1.32s/it] 74%|███████▍  | 536/720 [11:50<04:03,  1.32s/it] 75%|███████▍  | 537/720 [11:51<04:02,  1.32s/it] 75%|███████▍  | 538/720 [11:53<04:00,  1.32s/it] 75%|███████▍  | 539/720 [11:54<03:59,  1.32s/it] 75%|███████▌  | 540/720 [11:55<03:58,  1.32s/it] 75%|███████▌  | 541/720 [11:57<03:57,  1.32s/it] 75%|███████▌  | 542/720 [11:58<03:55,  1.32s/it] 75%|███████▌  | 543/720 [11:59<03:54,  1.32s/it] 76%|███████▌  | 544/720 [12:01<03:53,  1.32s/it] 76%|███████▌  | 545/720 [12:02<03:51,  1.32s/it] 76%|███████▌  | 546/720 [12:03<03:50,  1.32s/it] 76%|███████▌  | 547/720 [12:05<03:49,  1.32s/it] 76%|███████▌  | 548/720 [12:06<03:47,  1.32s/it] 76%|███████▋  | 549/720 [12:07<03:46,  1.32s/it] 76%|███████▋  | 550/720 [12:09<03:45,  1.32s/it] 77%|███████▋  | 551/720 [12:10<03:43,  1.32s/it] 77%|███████▋  | 552/720 [12:11<03:42,  1.32s/it] 77%|███████▋  | 553/720 [12:13<03:41,  1.32s/it] 77%|███████▋  | 554/720 [12:14<03:39,  1.32s/it] 77%|███████▋  | 555/720 [12:15<03:38,  1.32s/it] 77%|███████▋  | 556/720 [12:17<03:37,  1.32s/it] 77%|███████▋  | 557/720 [12:18<03:36,  1.33s/it] 78%|███████▊  | 558/720 [12:19<03:34,  1.33s/it] 78%|███████▊  | 559/720 [12:20<03:33,  1.32s/it] 78%|███████▊  | 560/720 [12:22<03:31,  1.32s/it] 78%|███████▊  | 561/720 [12:23<03:30,  1.32s/it] 78%|███████▊  | 562/720 [12:24<03:29,  1.32s/it] 78%|███████▊  | 563/720 [12:26<03:27,  1.32s/it] 78%|███████▊  | 564/720 [12:27<03:26,  1.32s/it] 78%|███████▊  | 565/720 [12:28<03:25,  1.32s/it] 79%|███████▊  | 566/720 [12:30<03:23,  1.32s/it] 79%|███████▉  | 567/720 [12:31<03:22,  1.32s/it] 79%|███████▉  | 568/720 [12:32<03:21,  1.32s/it] 79%|███████▉  | 569/720 [12:34<03:31,  1.40s/it] 79%|███████▉  | 570/720 [12:35<03:26,  1.38s/it] 79%|███████▉  | 571/720 [12:37<03:23,  1.36s/it] 79%|███████▉  | 572/720 [12:38<03:19,  1.35s/it] 80%|███████▉  | 573/720 [12:39<03:17,  1.34s/it] 80%|███████▉  | 574/720 [12:41<03:15,  1.34s/it] 80%|███████▉  | 575/720 [12:42<03:13,  1.33s/it] 80%|████████  | 576/720 [12:43<03:11,  1.33s/it] 80%|████████  | 577/720 [12:45<03:10,  1.33s/it] 80%|████████  | 578/720 [12:46<03:08,  1.33s/it] 80%|████████  | 579/720 [12:47<03:07,  1.33s/it] 81%|████████  | 580/720 [12:49<03:05,  1.33s/it] 81%|████████  | 581/720 [12:50<03:04,  1.33s/it] 81%|████████  | 582/720 [12:51<03:02,  1.33s/it] 81%|████████  | 583/720 [12:53<03:01,  1.32s/it] 81%|████████  | 584/720 [12:54<03:00,  1.32s/it] 81%|████████▏ | 585/720 [12:55<02:58,  1.32s/it] 81%|████████▏ | 586/720 [12:57<02:57,  1.32s/it] 82%|████████▏ | 587/720 [12:58<02:56,  1.32s/it] 82%|████████▏ | 588/720 [12:59<02:54,  1.32s/it] 82%|████████▏ | 589/720 [13:00<02:53,  1.32s/it] 82%|████████▏ | 590/720 [13:02<02:52,  1.32s/it] 82%|████████▏ | 591/720 [13:03<02:50,  1.32s/it] 82%|████████▏ | 592/720 [13:04<02:49,  1.32s/it] 82%|████████▏ | 593/720 [13:06<02:48,  1.32s/it] 82%|████████▎ | 594/720 [13:07<02:46,  1.32s/it] 83%|████████▎ | 595/720 [13:08<02:45,  1.32s/it] 83%|████████▎ | 596/720 [13:10<02:44,  1.32s/it] 83%|████████▎ | 597/720 [13:11<02:42,  1.32s/it] 83%|████████▎ | 598/720 [13:12<02:41,  1.32s/it] 83%|████████▎ | 599/720 [13:14<02:40,  1.32s/it] 83%|████████▎ | 600/720 [13:15<02:38,  1.32s/it]                                                  83%|████████▎ | 600/720 [13:15<02:38,  1.32s/it] 83%|████████▎ | 601/720 [13:16<02:37,  1.32s/it] 84%|████████▎ | 602/720 [13:18<02:36,  1.32s/it] 84%|████████▍ | 603/720 [13:19<02:34,  1.32s/it] 84%|████████▍ | 604/720 [13:20<02:33,  1.32s/it] 84%|████████▍ | 605/720 [13:22<02:32,  1.32s/it] 84%|████████▍ | 606/720 [13:23<02:30,  1.32s/it] 84%|████████▍ | 607/720 [13:24<02:29,  1.32s/it] 84%|████████▍ | 608/720 [13:26<02:28,  1.32s/it] 85%|████████▍ | 609/720 [13:27<02:27,  1.32s/it] 85%|████████▍ | 610/720 [13:28<02:25,  1.32s/it] 85%|████████▍ | 611/720 [13:30<02:24,  1.32s/it] 85%|████████▌ | 612/720 [13:31<02:23,  1.32s/it] 85%|████████▌ | 613/720 [13:32<02:21,  1.32s/it] 85%|████████▌ | 614/720 [13:34<02:20,  1.32s/it] 85%|████████▌ | 615/720 [13:35<02:19,  1.32s/it] 86%|████████▌ | 616/720 [13:36<02:17,  1.32s/it] 86%|████████▌ | 617/720 [13:38<02:16,  1.32s/it] 86%|████████▌ | 618/720 [13:39<02:15,  1.32s/it] 86%|████████▌ | 619/720 [13:40<02:13,  1.32s/it] 86%|████████▌ | 620/720 [13:42<02:12,  1.32s/it] 86%|████████▋ | 621/720 [13:43<02:11,  1.32s/it] 86%|████████▋ | 622/720 [13:44<02:09,  1.32s/it] 87%|████████▋ | 623/720 [13:46<02:08,  1.32s/it] 87%|████████▋ | 624/720 [13:47<02:07,  1.32s/it] 87%|████████▋ | 625/720 [13:48<02:06,  1.33s/it] 87%|████████▋ | 626/720 [13:49<02:04,  1.33s/it] 87%|████████▋ | 627/720 [13:51<02:03,  1.33s/it] 87%|████████▋ | 628/720 [13:52<02:01,  1.33s/it] 87%|████████▋ | 629/720 [13:53<02:00,  1.32s/it] 88%|████████▊ | 630/720 [13:55<01:59,  1.32s/it] 88%|████████▊ | 631/720 [13:56<01:57,  1.32s/it] 88%|████████▊ | 632/720 [13:57<01:56,  1.32s/it] 88%|████████▊ | 633/720 [13:59<01:55,  1.32s/it] 88%|████████▊ | 634/720 [14:00<01:53,  1.32s/it] 88%|████████▊ | 635/720 [14:01<01:52,  1.32s/it] 88%|████████▊ | 636/720 [14:03<01:51,  1.32s/it] 88%|████████▊ | 637/720 [14:04<01:49,  1.32s/it] 89%|████████▊ | 638/720 [14:05<01:48,  1.32s/it] 89%|████████▉ | 639/720 [14:07<01:47,  1.32s/it] 89%|████████▉ | 640/720 [14:08<01:45,  1.32s/it] 89%|████████▉ | 641/720 [14:09<01:44,  1.32s/it] 89%|████████▉ | 642/720 [14:11<01:43,  1.32s/it] 89%|████████▉ | 643/720 [14:12<01:41,  1.32s/it] 89%|████████▉ | 644/720 [14:13<01:40,  1.32s/it] 90%|████████▉ | 645/720 [14:15<01:39,  1.32s/it] 90%|████████▉ | 646/720 [14:16<01:38,  1.32s/it] 90%|████████▉ | 647/720 [14:17<01:36,  1.32s/it] 90%|█████████ | 648/720 [14:19<01:35,  1.32s/it] 90%|█████████ | 649/720 [14:20<01:34,  1.32s/it] 90%|█████████ | 650/720 [14:21<01:32,  1.32s/it] 90%|█████████ | 651/720 [14:23<01:31,  1.32s/it] 91%|█████████ | 652/720 [14:24<01:30,  1.32s/it] 91%|█████████ | 653/720 [14:25<01:28,  1.32s/it] 91%|█████████ | 654/720 [14:27<01:27,  1.32s/it] 91%|█████████ | 655/720 [14:28<01:26,  1.32s/it] 91%|█████████ | 656/720 [14:29<01:24,  1.32s/it] 91%|█████████▏| 657/720 [14:31<01:23,  1.32s/it] 91%|█████████▏| 658/720 [14:32<01:22,  1.32s/it] 92%|█████████▏| 659/720 [14:33<01:20,  1.32s/it] 92%|█████████▏| 660/720 [14:35<01:19,  1.32s/it] 92%|█████████▏| 661/720 [14:36<01:18,  1.32s/it] 92%|█████████▏| 662/720 [14:37<01:16,  1.32s/it] 92%|█████████▏| 663/720 [14:38<01:15,  1.32s/it] 92%|█████████▏| 664/720 [14:40<01:14,  1.32s/it] 92%|█████████▏| 665/720 [14:41<01:12,  1.32s/it] 92%|█████████▎| 666/720 [14:42<01:11,  1.32s/it] 93%|█████████▎| 667/720 [14:44<01:10,  1.32s/it] 93%|█████████▎| 668/720 [14:45<01:08,  1.32s/it] 93%|█████████▎| 669/720 [14:46<01:07,  1.32s/it] 93%|█████████▎| 670/720 [14:48<01:06,  1.32s/it] 93%|█████████▎| 671/720 [14:49<01:04,  1.32s/it] 93%|█████████▎| 672/720 [14:50<01:03,  1.32s/it] 93%|█████████▎| 673/720 [14:52<01:02,  1.32s/it] 94%|█████████▎| 674/720 [14:53<01:00,  1.32s/it] 94%|█████████▍| 675/720 [14:54<00:59,  1.32s/it] 94%|█████████▍| 676/720 [14:56<00:58,  1.32s/it] 94%|█████████▍| 677/720 [14:57<00:56,  1.32s/it] 94%|█████████▍| 678/720 [14:58<00:55,  1.32s/it] 94%|█████████▍| 679/720 [15:00<00:54,  1.32s/it] 94%|█████████▍| 680/720 [15:01<00:52,  1.32s/it] 95%|█████████▍| 681/720 [15:02<00:51,  1.32s/it] 95%|█████████▍| 682/720 [15:04<00:50,  1.32s/it] 95%|█████████▍| 683/720 [15:05<00:49,  1.32s/it] 95%|█████████▌| 684/720 [15:06<00:47,  1.32s/it] 95%|█████████▌| 685/720 [15:08<00:46,  1.32s/it] 95%|█████████▌| 686/720 [15:09<00:45,  1.32s/it] 95%|█████████▌| 687/720 [15:10<00:43,  1.32s/it] 96%|█████████▌| 688/720 [15:12<00:42,  1.32s/it] 96%|█████████▌| 689/720 [15:13<00:41,  1.32s/it] 96%|█████████▌| 690/720 [15:14<00:39,  1.32s/it] 96%|█████████▌| 691/720 [15:16<00:38,  1.32s/it] 96%|█████████▌| 692/720 [15:17<00:37,  1.32s/it] 96%|█████████▋| 693/720 [15:18<00:35,  1.33s/it] 96%|█████████▋| 694/720 [15:20<00:34,  1.33s/it] 97%|█████████▋| 695/720 [15:21<00:33,  1.33s/it] 97%|█████████▋| 696/720 [15:22<00:31,  1.32s/it] 97%|█████████▋| 697/720 [15:24<00:30,  1.32s/it] 97%|█████████▋| 698/720 [15:25<00:29,  1.32s/it] 97%|█████████▋| 699/720 [15:26<00:27,  1.32s/it] 97%|█████████▋| 700/720 [15:27<00:26,  1.32s/it]                                                  97%|█████████▋| 700/720 [15:27<00:26,  1.32s/it] 97%|█████████▋| 701/720 [15:29<00:25,  1.32s/it] 98%|█████████▊| 702/720 [15:30<00:23,  1.32s/it] 98%|█████████▊| 703/720 [15:31<00:22,  1.32s/it] 98%|█████████▊| 704/720 [15:33<00:21,  1.32s/it] 98%|█████████▊| 705/720 [15:34<00:19,  1.32s/it] 98%|█████████▊| 706/720 [15:35<00:18,  1.32s/it] 98%|█████████▊| 707/720 [15:37<00:17,  1.32s/it] 98%|█████████▊| 708/720 [15:38<00:15,  1.32s/it] 98%|█████████▊| 709/720 [15:39<00:14,  1.32s/it] 99%|█████████▊| 710/720 [15:41<00:13,  1.32s/it] 99%|█████████▉| 711/720 [15:42<00:11,  1.32s/it] 99%|█████████▉| 712/720 [15:43<00:10,  1.32s/it] 99%|█████████▉| 713/720 [15:45<00:09,  1.32s/it] 99%|█████████▉| 714/720 [15:46<00:07,  1.32s/it] 99%|█████████▉| 715/720 [15:47<00:06,  1.32s/it] 99%|█████████▉| 716/720 [15:49<00:05,  1.32s/it]100%|█████████▉| 717/720 [15:50<00:03,  1.32s/it]100%|█████████▉| 718/720 [15:51<00:02,  1.32s/it]100%|█████████▉| 719/720 [15:53<00:01,  1.32s/it]100%|██████████| 720/720 [15:54<00:00,  1.32s/it]/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x153779975b40>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: b81e64bc-ea6c-443b-8faf-171cec89e121)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                 100%|██████████| 720/720 [15:54<00:00,  1.32s/it]100%|██████████| 720/720 [15:54<00:00,  1.33s/it]
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1537781814b0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 78f242ca-2c6e-4adb-a628-340ed865d726)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'loss': 2.5001, 'grad_norm': 2.765350818634033, 'learning_rate': 1.7222222222222224e-05, 'epoch': 0.14}
{'loss': 0.6165, 'grad_norm': 2.52681827545166, 'learning_rate': 1.4444444444444446e-05, 'epoch': 0.28}
{'loss': 0.3768, 'grad_norm': 3.7869021892547607, 'learning_rate': 1.1666666666666668e-05, 'epoch': 0.42}
{'loss': 0.3455, 'grad_norm': 3.017277240753174, 'learning_rate': 8.888888888888888e-06, 'epoch': 0.56}
{'loss': 0.3316, 'grad_norm': 3.0561513900756836, 'learning_rate': 6.111111111111112e-06, 'epoch': 0.69}
{'loss': 0.3217, 'grad_norm': 2.091552495956421, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.83}
{'loss': 0.3185, 'grad_norm': 2.8339011669158936, 'learning_rate': 5.555555555555555e-07, 'epoch': 0.97}
{'train_runtime': 954.6925, 'train_samples_per_second': 3.017, 'train_steps_per_second': 0.754, 'train_loss': 0.6770478665828705, 'epoch': 1.0}
Saving model to ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_true_prop_var/meta-llama/Llama-3.2-3B-Instruct_58
Fine-tuning completed successfully!
end finetuning 58
start evaling: seed  58
2025-05-01 17:32:17.892589: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 17:32:17.907805: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746135137.923941  313739 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746135137.928858  313739 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746135137.941954  313739 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746135137.941976  313739 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746135137.941978  313739 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746135137.941979  313739 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 17:32:17.946053: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.79s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.98s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Model type: llama
Tokenizer type: PreTrainedTokenizerFast
CWD at runtime: /home/janeec/FairTune
Loading from FTing on: no_bias_constant_var_prop_rep
Model loaded.
Collecting responses:
Generating sample 1/1
Sample 1:   0%|          | 0/45 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   2%|▏         | 1/45 [00:21<15:34, 21.23s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   4%|▍         | 2/45 [00:42<15:08, 21.13s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   7%|▋         | 3/45 [01:03<14:41, 20.99s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   9%|▉         | 4/45 [01:23<14:16, 20.89s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  11%|█         | 5/45 [01:44<13:58, 20.95s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  13%|█▎        | 6/45 [02:05<13:35, 20.90s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  16%|█▌        | 7/45 [02:26<13:13, 20.87s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  18%|█▊        | 8/45 [02:47<12:50, 20.83s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  20%|██        | 9/45 [03:08<12:28, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  22%|██▏       | 10/45 [03:28<12:08, 20.81s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  24%|██▍       | 11/45 [03:49<11:46, 20.79s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  27%|██▋       | 12/45 [04:10<11:22, 20.69s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  29%|██▉       | 13/45 [04:30<11:03, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  31%|███       | 14/45 [04:51<10:42, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  33%|███▎      | 15/45 [05:12<10:19, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  36%|███▌      | 16/45 [05:32<09:59, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  38%|███▊      | 17/45 [05:53<09:38, 20.68s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  40%|████      | 18/45 [06:14<09:18, 20.67s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  42%|████▏     | 19/45 [06:34<08:56, 20.62s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  44%|████▍     | 20/45 [06:55<08:36, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  47%|████▋     | 21/45 [07:15<08:15, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  49%|████▉     | 22/45 [07:36<07:54, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  51%|█████     | 23/45 [07:57<07:34, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  53%|█████▎    | 24/45 [08:17<07:13, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  56%|█████▌    | 25/45 [08:38<06:53, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  58%|█████▊    | 26/45 [08:59<06:32, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  60%|██████    | 27/45 [09:19<06:10, 20.60s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  62%|██████▏   | 28/45 [09:40<05:50, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  64%|██████▍   | 29/45 [10:01<05:30, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  67%|██████▋   | 30/45 [10:21<05:08, 20.59s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  69%|██████▉   | 31/45 [10:42<04:48, 20.62s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  71%|███████   | 32/45 [11:03<04:29, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  73%|███████▎  | 33/45 [11:23<04:08, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  76%|███████▌  | 34/45 [11:44<03:47, 20.70s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  78%|███████▊  | 35/45 [12:05<03:27, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  80%|████████  | 36/45 [12:26<03:06, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  82%|████████▏ | 37/45 [12:46<02:45, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  84%|████████▍ | 38/45 [13:07<02:25, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  87%|████████▋ | 39/45 [13:28<02:04, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  89%|████████▉ | 40/45 [13:49<01:43, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  91%|█████████ | 41/45 [14:09<01:23, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  93%|█████████▎| 42/45 [14:30<01:01, 20.67s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  96%|█████████▌| 43/45 [14:51<00:41, 20.71s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  98%|█████████▊| 44/45 [15:11<00:20, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.64s/it]Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.72s/it]
  scenario  ... prompt_id
0   hiring  ...         1
1   hiring  ...         1
2   hiring  ...         1
3   hiring  ...         1
4   hiring  ...         1

[5 rows x 9 columns]
Responses saved to: results/no_bias_constant_var_prop_rep/Llama-3.2-3B-Instruct_salinas_expanded_context_58.csv
2025-05-01 17:48:06.169105: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 17:48:06.183928: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746136086.199637  315771 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746136086.204485  315771 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746136086.217672  315771 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746136086.217691  315771 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746136086.217693  315771 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746136086.217695  315771 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 17:48:06.221739: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.79s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.98s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Model type: llama
Tokenizer type: PreTrainedTokenizerFast
CWD at runtime: /home/janeec/FairTune
Loading from FTing on: no_bias_prop_var_prop_rep
Model loaded.
Collecting responses:
Generating sample 1/1
Sample 1:   0%|          | 0/45 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   2%|▏         | 1/45 [00:21<15:33, 21.22s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   4%|▍         | 2/45 [00:42<15:08, 21.13s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   7%|▋         | 3/45 [01:03<14:41, 20.98s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   9%|▉         | 4/45 [01:23<14:16, 20.89s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  11%|█         | 5/45 [01:44<13:58, 20.95s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  13%|█▎        | 6/45 [02:05<13:35, 20.91s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  16%|█▌        | 7/45 [02:26<13:13, 20.87s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  18%|█▊        | 8/45 [02:47<12:50, 20.83s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  20%|██        | 9/45 [03:08<12:28, 20.81s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  22%|██▏       | 10/45 [03:28<12:08, 20.81s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  24%|██▍       | 11/45 [03:49<11:46, 20.79s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  27%|██▋       | 12/45 [04:10<11:22, 20.69s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  29%|██▉       | 13/45 [04:30<11:03, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  31%|███       | 14/45 [04:51<10:42, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  33%|███▎      | 15/45 [05:12<10:19, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  36%|███▌      | 16/45 [05:32<09:58, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  38%|███▊      | 17/45 [05:53<09:38, 20.67s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  40%|████      | 18/45 [06:14<09:17, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  42%|████▏     | 19/45 [06:34<08:55, 20.61s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  44%|████▍     | 20/45 [06:55<08:35, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  47%|████▋     | 21/45 [07:15<08:15, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  49%|████▉     | 22/45 [07:36<07:54, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  51%|█████     | 23/45 [07:57<07:34, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  53%|█████▎    | 24/45 [08:17<07:13, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  56%|█████▌    | 25/45 [08:38<06:53, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  58%|█████▊    | 26/45 [08:59<06:32, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  60%|██████    | 27/45 [09:19<06:10, 20.61s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  62%|██████▏   | 28/45 [09:40<05:50, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  64%|██████▍   | 29/45 [10:00<05:30, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  67%|██████▋   | 30/45 [10:21<05:08, 20.59s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  69%|██████▉   | 31/45 [10:42<04:48, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  71%|███████   | 32/45 [11:03<04:29, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  73%|███████▎  | 33/45 [11:23<04:08, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  76%|███████▌  | 34/45 [11:44<03:47, 20.70s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  78%|███████▊  | 35/45 [12:05<03:27, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  80%|████████  | 36/45 [12:26<03:06, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  82%|████████▏ | 37/45 [12:46<02:45, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  84%|████████▍ | 38/45 [13:07<02:25, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  87%|████████▋ | 39/45 [13:28<02:04, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  89%|████████▉ | 40/45 [13:49<01:43, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  91%|█████████ | 41/45 [14:09<01:23, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  93%|█████████▎| 42/45 [14:30<01:02, 20.67s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  96%|█████████▌| 43/45 [14:51<00:41, 20.71s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  98%|█████████▊| 44/45 [15:11<00:20, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.64s/it]Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.72s/it]
  scenario  ... prompt_id
0   hiring  ...         1
1   hiring  ...         1
2   hiring  ...         1
3   hiring  ...         1
4   hiring  ...         1

[5 rows x 9 columns]
Responses saved to: results/no_bias_prop_var_prop_rep/Llama-3.2-3B-Instruct_salinas_expanded_context_58.csv
2025-05-01 18:03:53.776779: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 18:03:53.792004: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746137033.808143  318042 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746137033.813047  318042 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746137033.826268  318042 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746137033.826289  318042 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746137033.826292  318042 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746137033.826293  318042 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 18:03:53.830434: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.80s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.99s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Model type: llama
Tokenizer type: PreTrainedTokenizerFast
CWD at runtime: /home/janeec/FairTune
Loading from FTing on: no_bias_true_prop_var
Model loaded.
Collecting responses:
Generating sample 1/1
Sample 1:   0%|          | 0/45 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   2%|▏         | 1/45 [00:21<15:33, 21.22s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   4%|▍         | 2/45 [00:42<15:08, 21.13s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   7%|▋         | 3/45 [01:03<14:41, 20.99s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   9%|▉         | 4/45 [01:23<14:16, 20.89s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  11%|█         | 5/45 [01:44<13:58, 20.96s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  13%|█▎        | 6/45 [02:05<13:35, 20.91s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  16%|█▌        | 7/45 [02:26<13:13, 20.87s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  18%|█▊        | 8/45 [02:47<12:50, 20.83s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  20%|██        | 9/45 [03:08<12:28, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  22%|██▏       | 10/45 [03:28<12:08, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  24%|██▍       | 11/45 [03:49<11:46, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  27%|██▋       | 12/45 [04:09<11:22, 20.68s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  29%|██▉       | 13/45 [04:30<11:03, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  31%|███       | 14/45 [04:51<10:42, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  33%|███▎      | 15/45 [05:11<10:19, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  36%|███▌      | 16/45 [05:32<09:58, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  38%|███▊      | 17/45 [05:53<09:38, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  40%|████      | 18/45 [06:13<09:17, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  42%|████▏     | 19/45 [06:34<08:55, 20.61s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  44%|████▍     | 20/45 [06:55<08:35, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  47%|████▋     | 21/45 [07:15<08:15, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  49%|████▉     | 22/45 [07:36<07:54, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  51%|█████     | 23/45 [07:57<07:34, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  53%|█████▎    | 24/45 [08:17<07:13, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  56%|█████▌    | 25/45 [08:38<06:53, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  58%|█████▊    | 26/45 [08:59<06:32, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  60%|██████    | 27/45 [09:19<06:10, 20.61s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  62%|██████▏   | 28/45 [09:40<05:50, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  64%|██████▍   | 29/45 [10:00<05:30, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  67%|██████▋   | 30/45 [10:21<05:08, 20.60s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  69%|██████▉   | 31/45 [10:42<04:48, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  71%|███████   | 32/45 [11:03<04:29, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  73%|███████▎  | 33/45 [11:23<04:08, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  76%|███████▌  | 34/45 [11:44<03:47, 20.70s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  78%|███████▊  | 35/45 [12:05<03:27, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  80%|████████  | 36/45 [12:26<03:06, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  82%|████████▏ | 37/45 [12:46<02:45, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  84%|████████▍ | 38/45 [13:07<02:25, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  87%|████████▋ | 39/45 [13:28<02:04, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  89%|████████▉ | 40/45 [13:49<01:43, 20.76s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  91%|█████████ | 41/45 [14:09<01:22, 20.75s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  93%|█████████▎| 42/45 [14:30<01:01, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  96%|█████████▌| 43/45 [14:51<00:41, 20.70s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  98%|█████████▊| 44/45 [15:11<00:20, 20.71s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.64s/it]Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.72s/it]
  scenario  ... prompt_id
0   hiring  ...         1
1   hiring  ...         1
2   hiring  ...         1
3   hiring  ...         1
4   hiring  ...         1

[5 rows x 9 columns]
Responses saved to: results/no_bias_true_prop_var/Llama-3.2-3B-Instruct_salinas_expanded_context_58.csv
end eval 58
start finetuning: seed  60
2025-05-01 18:19:39.133792: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 18:19:39.146820: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746137979.161448  320287 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746137979.165889  320287 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746137979.178497  320287 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746137979.178516  320287 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746137979.178518  320287 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746137979.178520  320287 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 18:19:39.182419: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
=== Fine-tuning Configuration ===
Model: 
Training dataset: 
Random seed: 36
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: 
===========================
CUDA available: True
CUDA device count: 1
CUDA current device: 0
CUDA device name: NVIDIA A100 80GB PCIe MIG 3g.40gb
train_config(model_name='meta-llama/Llama-3.2-3B-Instruct', enable_fsdp=False, low_cpu_fsdp=False, run_validation=True, batch_size_training=4, gradient_accumulation_steps=1, num_epochs=1, num_workers_dataloader=1, lr=2e-05, weight_decay=0.0, gamma=0.85, seed=60, use_fp16=False, mixed_precision=True, val_batch_size=1, peft_method='lora', use_peft=False, output_dir='../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_constant_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_60', freeze_layers=False, num_freeze_layers=1, quantization=True, one_gpu=False, save_model=True, save_every_epoch=True, dist_checkpoint_root_folder='fsdp', dist_checkpoint_folder='fine-tuned', save_optimizer=False, use_fast_kernels=False, use_lora=True, save_full_gradients=False, system_message='You are a helpful assistant. Provide your best guess or estimate given the scenario. Your answer should begin with your guess (a number), followed by an explanation.', ft_dataset_name='no_bias_constant_var_prop_rep', dataset='datasets/ft/no_bias_constant_var_prop_rep.jsonl', eval_dataset_name='bbq_subset_100', eval_dataset=None, eval_output_file=None, base_output_file=None)
Clearing GPU cache
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:10<00:10, 10.78s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.12s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.97s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Applying LoRA adapter...
trainable params: 2,293,760 || all params: 3,215,046,656 || trainable%: 0.0713
Loading data from datasets/ft/no_bias_constant_var_prop_rep.jsonl...
Using all 1642 examples from dataset
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 25249.01 examples/s]
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map:  61%|██████    | 1000/1642 [00:00<00:00, 2368.14 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2420.97 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2387.50 examples/s]
/home/janeec/FairTune/finetune_w_eval_llama.py:297: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
=== Fine-tuning Configuration ===
Model: meta-llama/Llama-3.2-3B-Instruct
Training dataset: datasets/ft/no_bias_constant_var_prop_rep.jsonl
Random seed: 60
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_constant_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_60
===========================
SEED CHECK:, should be: 60, seed is: 60
Starting fine-tuning...
  0%|          | 0/411 [00:00<?, ?it/s]  0%|          | 1/411 [00:01<10:27,  1.53s/it]  0%|          | 2/411 [00:02<09:37,  1.41s/it]  1%|          | 3/411 [00:04<09:19,  1.37s/it]  1%|          | 4/411 [00:05<09:11,  1.36s/it]  1%|          | 5/411 [00:06<09:06,  1.34s/it]  1%|▏         | 6/411 [00:08<09:02,  1.34s/it]  2%|▏         | 7/411 [00:09<08:59,  1.33s/it]  2%|▏         | 8/411 [00:10<08:56,  1.33s/it]  2%|▏         | 9/411 [00:12<08:54,  1.33s/it]  2%|▏         | 10/411 [00:13<08:52,  1.33s/it]  3%|▎         | 11/411 [00:14<08:51,  1.33s/it]  3%|▎         | 12/411 [00:16<08:49,  1.33s/it]  3%|▎         | 13/411 [00:17<08:48,  1.33s/it]  3%|▎         | 14/411 [00:18<08:46,  1.33s/it]  4%|▎         | 15/411 [00:20<08:45,  1.33s/it]  4%|▍         | 16/411 [00:21<08:44,  1.33s/it]  4%|▍         | 17/411 [00:22<08:42,  1.33s/it]  4%|▍         | 18/411 [00:24<08:41,  1.33s/it]  5%|▍         | 19/411 [00:25<08:39,  1.33s/it]  5%|▍         | 20/411 [00:26<08:38,  1.33s/it]  5%|▌         | 21/411 [00:28<08:37,  1.33s/it]  5%|▌         | 22/411 [00:29<08:35,  1.33s/it]  6%|▌         | 23/411 [00:30<08:34,  1.33s/it]  6%|▌         | 24/411 [00:32<08:33,  1.33s/it]  6%|▌         | 25/411 [00:33<08:31,  1.33s/it]  6%|▋         | 26/411 [00:34<08:30,  1.33s/it]  7%|▋         | 27/411 [00:36<08:31,  1.33s/it]  7%|▋         | 28/411 [00:37<08:29,  1.33s/it]  7%|▋         | 29/411 [00:38<08:27,  1.33s/it]  7%|▋         | 30/411 [00:40<08:26,  1.33s/it]  8%|▊         | 31/411 [00:41<08:24,  1.33s/it]  8%|▊         | 32/411 [00:42<08:23,  1.33s/it]  8%|▊         | 33/411 [00:43<08:21,  1.33s/it]  8%|▊         | 34/411 [00:45<08:20,  1.33s/it]  9%|▊         | 35/411 [00:46<08:18,  1.33s/it]  9%|▉         | 36/411 [00:47<08:17,  1.33s/it]  9%|▉         | 37/411 [00:49<08:16,  1.33s/it]  9%|▉         | 38/411 [00:50<08:14,  1.33s/it]  9%|▉         | 39/411 [00:51<08:13,  1.33s/it] 10%|▉         | 40/411 [00:53<08:12,  1.33s/it] 10%|▉         | 41/411 [00:54<08:10,  1.33s/it] 10%|█         | 42/411 [00:55<08:09,  1.33s/it] 10%|█         | 43/411 [00:57<08:08,  1.33s/it] 11%|█         | 44/411 [00:58<08:06,  1.33s/it] 11%|█         | 45/411 [00:59<08:05,  1.33s/it] 11%|█         | 46/411 [01:01<08:04,  1.33s/it] 11%|█▏        | 47/411 [01:02<08:02,  1.33s/it] 12%|█▏        | 48/411 [01:03<08:01,  1.33s/it] 12%|█▏        | 49/411 [01:05<08:00,  1.33s/it] 12%|█▏        | 50/411 [01:06<07:58,  1.33s/it] 12%|█▏        | 51/411 [01:07<07:57,  1.33s/it] 13%|█▎        | 52/411 [01:09<07:56,  1.33s/it] 13%|█▎        | 53/411 [01:10<07:54,  1.33s/it] 13%|█▎        | 54/411 [01:11<07:53,  1.33s/it] 13%|█▎        | 55/411 [01:13<07:52,  1.33s/it] 14%|█▎        | 56/411 [01:14<07:50,  1.33s/it] 14%|█▍        | 57/411 [01:15<07:49,  1.33s/it] 14%|█▍        | 58/411 [01:17<07:48,  1.33s/it] 14%|█▍        | 59/411 [01:18<07:46,  1.33s/it] 15%|█▍        | 60/411 [01:19<07:45,  1.33s/it] 15%|█▍        | 61/411 [01:21<07:44,  1.33s/it] 15%|█▌        | 62/411 [01:22<07:42,  1.33s/it] 15%|█▌        | 63/411 [01:23<07:41,  1.33s/it] 16%|█▌        | 64/411 [01:25<07:40,  1.33s/it] 16%|█▌        | 65/411 [01:26<07:38,  1.33s/it] 16%|█▌        | 66/411 [01:27<07:37,  1.33s/it] 16%|█▋        | 67/411 [01:29<07:36,  1.33s/it] 17%|█▋        | 68/411 [01:30<07:34,  1.33s/it] 17%|█▋        | 69/411 [01:31<07:33,  1.33s/it] 17%|█▋        | 70/411 [01:33<07:32,  1.33s/it] 17%|█▋        | 71/411 [01:34<07:30,  1.33s/it] 18%|█▊        | 72/411 [01:35<07:30,  1.33s/it] 18%|█▊        | 73/411 [01:37<07:28,  1.33s/it] 18%|█▊        | 74/411 [01:38<07:27,  1.33s/it] 18%|█▊        | 75/411 [01:39<07:25,  1.33s/it] 18%|█▊        | 76/411 [01:41<07:24,  1.33s/it] 19%|█▊        | 77/411 [01:42<07:23,  1.33s/it] 19%|█▉        | 78/411 [01:43<07:21,  1.33s/it] 19%|█▉        | 79/411 [01:45<07:20,  1.33s/it] 19%|█▉        | 80/411 [01:46<07:18,  1.33s/it] 20%|█▉        | 81/411 [01:47<07:17,  1.33s/it] 20%|█▉        | 82/411 [01:48<07:16,  1.33s/it] 20%|██        | 83/411 [01:50<07:14,  1.33s/it] 20%|██        | 84/411 [01:51<07:13,  1.33s/it] 21%|██        | 85/411 [01:52<07:12,  1.33s/it] 21%|██        | 86/411 [01:54<07:10,  1.33s/it] 21%|██        | 87/411 [01:55<07:09,  1.33s/it] 21%|██▏       | 88/411 [01:56<07:08,  1.33s/it] 22%|██▏       | 89/411 [01:58<07:06,  1.33s/it] 22%|██▏       | 90/411 [01:59<07:05,  1.33s/it] 22%|██▏       | 91/411 [02:00<07:04,  1.33s/it] 22%|██▏       | 92/411 [02:02<07:03,  1.33s/it] 23%|██▎       | 93/411 [02:03<07:01,  1.33s/it] 23%|██▎       | 94/411 [02:04<07:00,  1.33s/it] 23%|██▎       | 95/411 [02:06<06:59,  1.33s/it] 23%|██▎       | 96/411 [02:07<06:57,  1.33s/it] 24%|██▎       | 97/411 [02:08<06:56,  1.33s/it] 24%|██▍       | 98/411 [02:10<06:55,  1.33s/it] 24%|██▍       | 99/411 [02:11<06:53,  1.33s/it] 24%|██▍       | 100/411 [02:12<06:52,  1.33s/it]                                                  24%|██▍       | 100/411 [02:12<06:52,  1.33s/it] 25%|██▍       | 101/411 [02:14<06:51,  1.33s/it] 25%|██▍       | 102/411 [02:15<06:49,  1.33s/it] 25%|██▌       | 103/411 [02:16<06:48,  1.33s/it] 25%|██▌       | 104/411 [02:18<06:46,  1.33s/it] 26%|██▌       | 105/411 [02:19<06:45,  1.33s/it] 26%|██▌       | 106/411 [02:20<06:44,  1.33s/it] 26%|██▌       | 107/411 [02:22<06:43,  1.33s/it] 26%|██▋       | 108/411 [02:23<06:41,  1.33s/it] 27%|██▋       | 109/411 [02:24<06:40,  1.33s/it] 27%|██▋       | 110/411 [02:26<06:38,  1.33s/it] 27%|██▋       | 111/411 [02:27<06:37,  1.33s/it] 27%|██▋       | 112/411 [02:28<06:36,  1.33s/it] 27%|██▋       | 113/411 [02:30<06:34,  1.33s/it] 28%|██▊       | 114/411 [02:31<06:33,  1.33s/it] 28%|██▊       | 115/411 [02:32<06:32,  1.33s/it] 28%|██▊       | 116/411 [02:34<06:30,  1.33s/it] 28%|██▊       | 117/411 [02:35<06:29,  1.33s/it] 29%|██▊       | 118/411 [02:36<06:28,  1.33s/it] 29%|██▉       | 119/411 [02:38<06:26,  1.33s/it] 29%|██▉       | 120/411 [02:39<06:25,  1.32s/it] 29%|██▉       | 121/411 [02:40<06:24,  1.32s/it] 30%|██▉       | 122/411 [02:42<06:22,  1.33s/it] 30%|██▉       | 123/411 [02:43<06:21,  1.33s/it] 30%|███       | 124/411 [02:44<06:20,  1.33s/it] 30%|███       | 125/411 [02:46<06:19,  1.33s/it] 31%|███       | 126/411 [02:47<06:17,  1.33s/it] 31%|███       | 127/411 [02:48<06:16,  1.33s/it] 31%|███       | 128/411 [02:49<06:15,  1.33s/it] 31%|███▏      | 129/411 [02:51<06:13,  1.33s/it] 32%|███▏      | 130/411 [02:52<06:12,  1.33s/it] 32%|███▏      | 131/411 [02:53<06:11,  1.33s/it] 32%|███▏      | 132/411 [02:55<06:09,  1.33s/it] 32%|███▏      | 133/411 [02:56<06:08,  1.33s/it] 33%|███▎      | 134/411 [02:57<06:07,  1.33s/it] 33%|███▎      | 135/411 [02:59<06:05,  1.33s/it] 33%|███▎      | 136/411 [03:00<06:04,  1.33s/it] 33%|███▎      | 137/411 [03:01<06:03,  1.33s/it] 34%|███▎      | 138/411 [03:03<06:01,  1.33s/it] 34%|███▍      | 139/411 [03:04<06:00,  1.33s/it] 34%|███▍      | 140/411 [03:05<06:00,  1.33s/it] 34%|███▍      | 141/411 [03:07<05:58,  1.33s/it] 35%|███▍      | 142/411 [03:08<05:57,  1.33s/it] 35%|███▍      | 143/411 [03:09<05:55,  1.33s/it] 35%|███▌      | 144/411 [03:11<05:54,  1.33s/it] 35%|███▌      | 145/411 [03:12<05:52,  1.33s/it] 36%|███▌      | 146/411 [03:13<05:51,  1.33s/it] 36%|███▌      | 147/411 [03:15<05:50,  1.33s/it] 36%|███▌      | 148/411 [03:16<05:48,  1.33s/it] 36%|███▋      | 149/411 [03:17<05:47,  1.33s/it] 36%|███▋      | 150/411 [03:19<05:45,  1.33s/it] 37%|███▋      | 151/411 [03:20<05:44,  1.33s/it] 37%|███▋      | 152/411 [03:21<05:43,  1.33s/it] 37%|███▋      | 153/411 [03:23<05:41,  1.33s/it] 37%|███▋      | 154/411 [03:24<05:40,  1.33s/it] 38%|███▊      | 155/411 [03:25<05:39,  1.33s/it] 38%|███▊      | 156/411 [03:27<05:38,  1.33s/it] 38%|███▊      | 157/411 [03:28<05:36,  1.33s/it] 38%|███▊      | 158/411 [03:29<05:35,  1.33s/it] 39%|███▊      | 159/411 [03:31<05:33,  1.33s/it] 39%|███▉      | 160/411 [03:32<05:32,  1.33s/it] 39%|███▉      | 161/411 [03:33<05:31,  1.33s/it] 39%|███▉      | 162/411 [03:35<05:30,  1.33s/it] 40%|███▉      | 163/411 [03:36<05:28,  1.33s/it] 40%|███▉      | 164/411 [03:37<05:27,  1.33s/it] 40%|████      | 165/411 [03:39<05:26,  1.33s/it] 40%|████      | 166/411 [03:40<05:24,  1.33s/it] 41%|████      | 167/411 [03:41<05:23,  1.33s/it] 41%|████      | 168/411 [03:43<05:22,  1.33s/it] 41%|████      | 169/411 [03:44<05:20,  1.33s/it] 41%|████▏     | 170/411 [03:45<05:19,  1.33s/it] 42%|████▏     | 171/411 [03:46<05:18,  1.33s/it] 42%|████▏     | 172/411 [03:48<05:16,  1.33s/it] 42%|████▏     | 173/411 [03:49<05:15,  1.33s/it] 42%|████▏     | 174/411 [03:50<05:14,  1.33s/it] 43%|████▎     | 175/411 [03:52<05:12,  1.33s/it] 43%|████▎     | 176/411 [03:53<05:11,  1.33s/it] 43%|████▎     | 177/411 [03:54<05:10,  1.33s/it] 43%|████▎     | 178/411 [03:56<05:08,  1.33s/it] 44%|████▎     | 179/411 [03:57<05:07,  1.33s/it] 44%|████▍     | 180/411 [03:58<05:06,  1.33s/it] 44%|████▍     | 181/411 [04:00<05:04,  1.33s/it] 44%|████▍     | 182/411 [04:01<05:03,  1.33s/it] 45%|████▍     | 183/411 [04:02<05:02,  1.33s/it] 45%|████▍     | 184/411 [04:04<05:00,  1.33s/it] 45%|████▌     | 185/411 [04:05<04:59,  1.33s/it] 45%|████▌     | 186/411 [04:06<04:58,  1.33s/it] 45%|████▌     | 187/411 [04:08<04:56,  1.33s/it] 46%|████▌     | 188/411 [04:09<04:55,  1.33s/it] 46%|████▌     | 189/411 [04:10<04:54,  1.33s/it] 46%|████▌     | 190/411 [04:12<04:52,  1.33s/it] 46%|████▋     | 191/411 [04:13<04:51,  1.33s/it] 47%|████▋     | 192/411 [04:14<04:50,  1.33s/it] 47%|████▋     | 193/411 [04:16<04:49,  1.33s/it] 47%|████▋     | 194/411 [04:17<04:47,  1.33s/it] 47%|████▋     | 195/411 [04:18<04:46,  1.33s/it] 48%|████▊     | 196/411 [04:20<04:45,  1.33s/it] 48%|████▊     | 197/411 [04:21<04:43,  1.33s/it] 48%|████▊     | 198/411 [04:22<04:42,  1.33s/it] 48%|████▊     | 199/411 [04:24<04:41,  1.33s/it] 49%|████▊     | 200/411 [04:25<04:39,  1.33s/it]                                                  49%|████▊     | 200/411 [04:25<04:39,  1.33s/it] 49%|████▉     | 201/411 [04:26<04:38,  1.33s/it] 49%|████▉     | 202/411 [04:28<04:37,  1.33s/it] 49%|████▉     | 203/411 [04:29<04:35,  1.33s/it] 50%|████▉     | 204/411 [04:30<04:34,  1.33s/it] 50%|████▉     | 205/411 [04:32<04:33,  1.33s/it] 50%|█████     | 206/411 [04:33<04:31,  1.33s/it] 50%|█████     | 207/411 [04:34<04:30,  1.33s/it] 51%|█████     | 208/411 [04:36<04:29,  1.33s/it] 51%|█████     | 209/411 [04:37<04:28,  1.33s/it] 51%|█████     | 210/411 [04:38<04:26,  1.33s/it] 51%|█████▏    | 211/411 [04:40<04:25,  1.33s/it] 52%|█████▏    | 212/411 [04:41<04:23,  1.33s/it] 52%|█████▏    | 213/411 [04:42<04:22,  1.33s/it] 52%|█████▏    | 214/411 [04:44<04:21,  1.33s/it] 52%|█████▏    | 215/411 [04:45<04:19,  1.33s/it] 53%|█████▎    | 216/411 [04:46<04:18,  1.33s/it] 53%|█████▎    | 217/411 [04:47<04:17,  1.33s/it] 53%|█████▎    | 218/411 [04:49<04:15,  1.33s/it] 53%|█████▎    | 219/411 [04:50<04:14,  1.33s/it] 54%|█████▎    | 220/411 [04:51<04:13,  1.33s/it] 54%|█████▍    | 221/411 [04:53<04:11,  1.33s/it] 54%|█████▍    | 222/411 [04:54<04:10,  1.33s/it] 54%|█████▍    | 223/411 [04:55<04:09,  1.33s/it] 55%|█████▍    | 224/411 [04:57<04:07,  1.33s/it] 55%|█████▍    | 225/411 [04:58<04:06,  1.33s/it] 55%|█████▍    | 226/411 [04:59<04:05,  1.33s/it] 55%|█████▌    | 227/411 [05:01<04:03,  1.33s/it] 55%|█████▌    | 228/411 [05:02<04:02,  1.33s/it] 56%|█████▌    | 229/411 [05:03<04:01,  1.33s/it] 56%|█████▌    | 230/411 [05:05<03:59,  1.33s/it] 56%|█████▌    | 231/411 [05:06<03:58,  1.33s/it] 56%|█████▋    | 232/411 [05:07<03:57,  1.33s/it] 57%|█████▋    | 233/411 [05:09<03:55,  1.33s/it] 57%|█████▋    | 234/411 [05:10<03:54,  1.33s/it] 57%|█████▋    | 235/411 [05:11<03:53,  1.33s/it] 57%|█████▋    | 236/411 [05:13<03:51,  1.33s/it] 58%|█████▊    | 237/411 [05:14<03:50,  1.33s/it] 58%|█████▊    | 238/411 [05:15<03:49,  1.33s/it] 58%|█████▊    | 239/411 [05:17<03:47,  1.33s/it] 58%|█████▊    | 240/411 [05:18<03:46,  1.32s/it] 59%|█████▊    | 241/411 [05:19<03:45,  1.33s/it] 59%|█████▉    | 242/411 [05:21<03:43,  1.33s/it] 59%|█████▉    | 243/411 [05:22<03:42,  1.33s/it] 59%|█████▉    | 244/411 [05:23<03:41,  1.33s/it] 60%|█████▉    | 245/411 [05:25<03:39,  1.33s/it] 60%|█████▉    | 246/411 [05:26<03:38,  1.32s/it] 60%|██████    | 247/411 [05:27<03:37,  1.32s/it] 60%|██████    | 248/411 [05:29<03:35,  1.32s/it] 61%|██████    | 249/411 [05:30<03:34,  1.32s/it] 61%|██████    | 250/411 [05:31<03:33,  1.33s/it] 61%|██████    | 251/411 [05:33<03:32,  1.33s/it] 61%|██████▏   | 252/411 [05:34<03:30,  1.33s/it] 62%|██████▏   | 253/411 [05:35<03:29,  1.33s/it] 62%|██████▏   | 254/411 [05:37<03:28,  1.33s/it] 62%|██████▏   | 255/411 [05:38<03:26,  1.33s/it] 62%|██████▏   | 256/411 [05:39<03:25,  1.33s/it] 63%|██████▎   | 257/411 [05:41<03:24,  1.33s/it] 63%|██████▎   | 258/411 [05:42<03:22,  1.33s/it] 63%|██████▎   | 259/411 [05:43<03:21,  1.33s/it] 63%|██████▎   | 260/411 [05:44<03:20,  1.33s/it] 64%|██████▎   | 261/411 [05:46<03:18,  1.33s/it] 64%|██████▎   | 262/411 [05:47<03:17,  1.33s/it] 64%|██████▍   | 263/411 [05:48<03:16,  1.33s/it] 64%|██████▍   | 264/411 [05:50<03:14,  1.33s/it] 64%|██████▍   | 265/411 [05:51<03:13,  1.33s/it] 65%|██████▍   | 266/411 [05:52<03:12,  1.33s/it] 65%|██████▍   | 267/411 [05:54<03:10,  1.32s/it] 65%|██████▌   | 268/411 [05:55<03:09,  1.32s/it] 65%|██████▌   | 269/411 [05:56<03:08,  1.32s/it] 66%|██████▌   | 270/411 [05:58<03:06,  1.32s/it] 66%|██████▌   | 271/411 [05:59<03:05,  1.32s/it] 66%|██████▌   | 272/411 [06:00<03:04,  1.32s/it] 66%|██████▋   | 273/411 [06:02<03:02,  1.32s/it] 67%|██████▋   | 274/411 [06:03<03:01,  1.33s/it] 67%|██████▋   | 275/411 [06:04<03:00,  1.32s/it] 67%|██████▋   | 276/411 [06:06<02:58,  1.32s/it] 67%|██████▋   | 277/411 [06:07<02:57,  1.32s/it] 68%|██████▊   | 278/411 [06:08<02:56,  1.32s/it] 68%|██████▊   | 279/411 [06:10<02:54,  1.32s/it] 68%|██████▊   | 280/411 [06:11<02:53,  1.33s/it] 68%|██████▊   | 281/411 [06:12<02:52,  1.33s/it] 69%|██████▊   | 282/411 [06:14<02:50,  1.33s/it] 69%|██████▉   | 283/411 [06:15<02:49,  1.32s/it] 69%|██████▉   | 284/411 [06:16<02:48,  1.32s/it] 69%|██████▉   | 285/411 [06:18<02:46,  1.32s/it] 70%|██████▉   | 286/411 [06:19<02:45,  1.32s/it] 70%|██████▉   | 287/411 [06:20<02:44,  1.32s/it] 70%|███████   | 288/411 [06:22<02:42,  1.32s/it] 70%|███████   | 289/411 [06:23<02:41,  1.32s/it] 71%|███████   | 290/411 [06:24<02:40,  1.32s/it] 71%|███████   | 291/411 [06:26<02:38,  1.32s/it] 71%|███████   | 292/411 [06:27<02:37,  1.32s/it] 71%|███████▏  | 293/411 [06:28<02:36,  1.32s/it] 72%|███████▏  | 294/411 [06:30<02:35,  1.33s/it] 72%|███████▏  | 295/411 [06:31<02:33,  1.33s/it] 72%|███████▏  | 296/411 [06:32<02:32,  1.32s/it] 72%|███████▏  | 297/411 [06:33<02:31,  1.32s/it] 73%|███████▎  | 298/411 [06:35<02:29,  1.32s/it] 73%|███████▎  | 299/411 [06:36<02:28,  1.32s/it] 73%|███████▎  | 300/411 [06:37<02:27,  1.32s/it]                                                  73%|███████▎  | 300/411 [06:37<02:27,  1.32s/it] 73%|███████▎  | 301/411 [06:39<02:25,  1.32s/it] 73%|███████▎  | 302/411 [06:40<02:24,  1.32s/it] 74%|███████▎  | 303/411 [06:41<02:23,  1.32s/it] 74%|███████▍  | 304/411 [06:43<02:21,  1.32s/it] 74%|███████▍  | 305/411 [06:44<02:20,  1.32s/it] 74%|███████▍  | 306/411 [06:45<02:19,  1.32s/it] 75%|███████▍  | 307/411 [06:47<02:17,  1.32s/it] 75%|███████▍  | 308/411 [06:48<02:16,  1.32s/it] 75%|███████▌  | 309/411 [06:49<02:15,  1.32s/it] 75%|███████▌  | 310/411 [06:51<02:13,  1.32s/it] 76%|███████▌  | 311/411 [06:52<02:12,  1.32s/it] 76%|███████▌  | 312/411 [06:53<02:11,  1.32s/it] 76%|███████▌  | 313/411 [06:55<02:09,  1.32s/it] 76%|███████▋  | 314/411 [06:56<02:08,  1.32s/it] 77%|███████▋  | 315/411 [06:57<02:07,  1.32s/it] 77%|███████▋  | 316/411 [06:59<02:05,  1.32s/it] 77%|███████▋  | 317/411 [07:00<02:04,  1.33s/it] 77%|███████▋  | 318/411 [07:01<02:03,  1.33s/it] 78%|███████▊  | 319/411 [07:03<02:01,  1.32s/it] 78%|███████▊  | 320/411 [07:04<02:00,  1.32s/it] 78%|███████▊  | 321/411 [07:05<01:59,  1.33s/it] 78%|███████▊  | 322/411 [07:07<01:58,  1.33s/it] 79%|███████▊  | 323/411 [07:08<01:56,  1.33s/it] 79%|███████▉  | 324/411 [07:09<01:55,  1.33s/it] 79%|███████▉  | 325/411 [07:11<01:53,  1.33s/it] 79%|███████▉  | 326/411 [07:12<01:52,  1.32s/it] 80%|███████▉  | 327/411 [07:13<01:51,  1.32s/it] 80%|███████▉  | 328/411 [07:15<01:49,  1.32s/it] 80%|████████  | 329/411 [07:16<01:48,  1.32s/it] 80%|████████  | 330/411 [07:17<01:47,  1.33s/it] 81%|████████  | 331/411 [07:19<01:45,  1.32s/it] 81%|████████  | 332/411 [07:20<01:44,  1.32s/it] 81%|████████  | 333/411 [07:21<01:43,  1.32s/it] 81%|████████▏ | 334/411 [07:23<01:42,  1.32s/it] 82%|████████▏ | 335/411 [07:24<01:40,  1.32s/it] 82%|████████▏ | 336/411 [07:25<01:39,  1.32s/it] 82%|████████▏ | 337/411 [07:26<01:38,  1.32s/it] 82%|████████▏ | 338/411 [07:28<01:36,  1.32s/it] 82%|████████▏ | 339/411 [07:29<01:35,  1.32s/it] 83%|████████▎ | 340/411 [07:30<01:34,  1.32s/it] 83%|████████▎ | 341/411 [07:32<01:32,  1.32s/it] 83%|████████▎ | 342/411 [07:33<01:31,  1.33s/it] 83%|████████▎ | 343/411 [07:34<01:30,  1.32s/it] 84%|████████▎ | 344/411 [07:36<01:28,  1.32s/it] 84%|████████▍ | 345/411 [07:37<01:27,  1.32s/it] 84%|████████▍ | 346/411 [07:38<01:26,  1.32s/it] 84%|████████▍ | 347/411 [07:40<01:24,  1.32s/it] 85%|████████▍ | 348/411 [07:41<01:23,  1.32s/it] 85%|████████▍ | 349/411 [07:42<01:22,  1.32s/it] 85%|████████▌ | 350/411 [07:44<01:20,  1.32s/it] 85%|████████▌ | 351/411 [07:45<01:19,  1.32s/it] 86%|████████▌ | 352/411 [07:46<01:18,  1.32s/it] 86%|████████▌ | 353/411 [07:48<01:16,  1.32s/it] 86%|████████▌ | 354/411 [07:49<01:15,  1.32s/it] 86%|████████▋ | 355/411 [07:50<01:14,  1.32s/it] 87%|████████▋ | 356/411 [07:52<01:12,  1.32s/it] 87%|████████▋ | 357/411 [07:53<01:11,  1.32s/it] 87%|████████▋ | 358/411 [07:54<01:10,  1.32s/it] 87%|████████▋ | 359/411 [07:56<01:08,  1.32s/it] 88%|████████▊ | 360/411 [07:57<01:07,  1.32s/it] 88%|████████▊ | 361/411 [07:58<01:06,  1.32s/it] 88%|████████▊ | 362/411 [08:00<01:04,  1.32s/it] 88%|████████▊ | 363/411 [08:01<01:03,  1.32s/it] 89%|████████▊ | 364/411 [08:02<01:02,  1.32s/it] 89%|████████▉ | 365/411 [08:04<01:00,  1.32s/it] 89%|████████▉ | 366/411 [08:05<00:59,  1.32s/it] 89%|████████▉ | 367/411 [08:06<00:58,  1.32s/it] 90%|████████▉ | 368/411 [08:08<00:56,  1.32s/it] 90%|████████▉ | 369/411 [08:09<00:55,  1.32s/it] 90%|█████████ | 370/411 [08:10<00:54,  1.32s/it] 90%|█████████ | 371/411 [08:12<00:52,  1.32s/it] 91%|█████████ | 372/411 [08:13<00:51,  1.32s/it] 91%|█████████ | 373/411 [08:14<00:50,  1.32s/it] 91%|█████████ | 374/411 [08:16<00:49,  1.32s/it] 91%|█████████ | 375/411 [08:17<00:47,  1.32s/it] 91%|█████████▏| 376/411 [08:18<00:46,  1.32s/it] 92%|█████████▏| 377/411 [08:19<00:45,  1.32s/it] 92%|█████████▏| 378/411 [08:21<00:43,  1.32s/it] 92%|█████████▏| 379/411 [08:22<00:42,  1.32s/it] 92%|█████████▏| 380/411 [08:23<00:41,  1.32s/it] 93%|█████████▎| 381/411 [08:25<00:39,  1.32s/it] 93%|█████████▎| 382/411 [08:26<00:38,  1.32s/it] 93%|█████████▎| 383/411 [08:27<00:37,  1.32s/it] 93%|█████████▎| 384/411 [08:29<00:35,  1.32s/it] 94%|█████████▎| 385/411 [08:30<00:34,  1.32s/it] 94%|█████████▍| 386/411 [08:31<00:33,  1.32s/it] 94%|█████████▍| 387/411 [08:33<00:31,  1.32s/it] 94%|█████████▍| 388/411 [08:34<00:30,  1.32s/it] 95%|█████████▍| 389/411 [08:35<00:29,  1.33s/it] 95%|█████████▍| 390/411 [08:37<00:27,  1.33s/it] 95%|█████████▌| 391/411 [08:38<00:26,  1.33s/it] 95%|█████████▌| 392/411 [08:39<00:25,  1.33s/it] 96%|█████████▌| 393/411 [08:41<00:23,  1.33s/it] 96%|█████████▌| 394/411 [08:42<00:22,  1.33s/it] 96%|█████████▌| 395/411 [08:43<00:21,  1.33s/it] 96%|█████████▋| 396/411 [08:45<00:19,  1.32s/it] 97%|█████████▋| 397/411 [08:46<00:18,  1.32s/it] 97%|█████████▋| 398/411 [08:47<00:17,  1.32s/it] 97%|█████████▋| 399/411 [08:49<00:15,  1.32s/it] 97%|█████████▋| 400/411 [08:50<00:14,  1.32s/it]                                                  97%|█████████▋| 400/411 [08:50<00:14,  1.32s/it] 98%|█████████▊| 401/411 [08:51<00:13,  1.33s/it] 98%|█████████▊| 402/411 [08:53<00:11,  1.33s/it] 98%|█████████▊| 403/411 [08:54<00:10,  1.32s/it] 98%|█████████▊| 404/411 [08:55<00:09,  1.32s/it] 99%|█████████▊| 405/411 [08:57<00:07,  1.32s/it] 99%|█████████▉| 406/411 [08:58<00:06,  1.32s/it] 99%|█████████▉| 407/411 [08:59<00:05,  1.32s/it] 99%|█████████▉| 408/411 [09:01<00:03,  1.32s/it]100%|█████████▉| 409/411 [09:02<00:02,  1.32s/it]100%|█████████▉| 410/411 [09:03<00:01,  1.32s/it]100%|██████████| 411/411 [09:04<00:00,  1.15s/it]/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x153f140185e0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 35639a46-d30c-4da8-a94e-d10265270666)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                 100%|██████████| 411/411 [09:04<00:00,  1.15s/it]100%|██████████| 411/411 [09:04<00:00,  1.33s/it]
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x153f181abfa0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 1e638ee7-a8da-487b-874a-ad0ffe678c37)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'loss': 2.5583, 'grad_norm': 2.9098055362701416, 'learning_rate': 1.51338199513382e-05, 'epoch': 0.24}
{'loss': 0.7342, 'grad_norm': 3.176229953765869, 'learning_rate': 1.0267639902676401e-05, 'epoch': 0.49}
{'loss': 0.4083, 'grad_norm': 1.976660132408142, 'learning_rate': 5.401459854014599e-06, 'epoch': 0.73}
{'loss': 0.3879, 'grad_norm': 4.31481409072876, 'learning_rate': 5.352798053527981e-07, 'epoch': 0.97}
{'train_runtime': 544.6599, 'train_samples_per_second': 3.015, 'train_steps_per_second': 0.755, 'train_loss': 1.0048272812743546, 'epoch': 1.0}
Saving model to ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_constant_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_60
Fine-tuning completed successfully!
2025-05-01 18:29:08.534635: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 18:29:08.546963: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746138548.561598  321441 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746138548.566020  321441 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746138548.578614  321441 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746138548.578633  321441 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746138548.578635  321441 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746138548.578637  321441 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 18:29:08.582562: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
=== Fine-tuning Configuration ===
Model: 
Training dataset: 
Random seed: 36
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: 
===========================
CUDA available: True
CUDA device count: 1
CUDA current device: 0
CUDA device name: NVIDIA A100 80GB PCIe MIG 3g.40gb
train_config(model_name='meta-llama/Llama-3.2-3B-Instruct', enable_fsdp=False, low_cpu_fsdp=False, run_validation=True, batch_size_training=4, gradient_accumulation_steps=1, num_epochs=1, num_workers_dataloader=1, lr=2e-05, weight_decay=0.0, gamma=0.85, seed=60, use_fp16=False, mixed_precision=True, val_batch_size=1, peft_method='lora', use_peft=False, output_dir='../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_prop_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_60', freeze_layers=False, num_freeze_layers=1, quantization=True, one_gpu=False, save_model=True, save_every_epoch=True, dist_checkpoint_root_folder='fsdp', dist_checkpoint_folder='fine-tuned', save_optimizer=False, use_fast_kernels=False, use_lora=True, save_full_gradients=False, system_message='You are a helpful assistant. Provide your best guess or estimate given the scenario. Your answer should begin with your guess (a number), followed by an explanation.', ft_dataset_name='no_bias_prop_var_prop_rep', dataset='datasets/ft/no_bias_prop_var_prop_rep.jsonl', eval_dataset_name='bbq_subset_100', eval_dataset=None, eval_output_file=None, base_output_file=None)
Clearing GPU cache
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.56s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Applying LoRA adapter...
trainable params: 2,293,760 || all params: 3,215,046,656 || trainable%: 0.0713
Loading data from datasets/ft/no_bias_prop_var_prop_rep.jsonl...
Using all 1642 examples from dataset
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 25119.99 examples/s]
Map:   0%|          | 0/1642 [00:00<?, ? examples/s]Map:  61%|██████    | 1000/1642 [00:00<00:00, 2382.03 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2439.11 examples/s]Map: 100%|██████████| 1642/1642 [00:00<00:00, 2404.54 examples/s]
/home/janeec/FairTune/finetune_w_eval_llama.py:297: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
=== Fine-tuning Configuration ===
Model: meta-llama/Llama-3.2-3B-Instruct
Training dataset: datasets/ft/no_bias_prop_var_prop_rep.jsonl
Random seed: 60
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_prop_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_60
===========================
SEED CHECK:, should be: 60, seed is: 60
Starting fine-tuning...
  0%|          | 0/411 [00:00<?, ?it/s]  0%|          | 1/411 [00:01<10:42,  1.57s/it]  0%|          | 2/411 [00:02<09:43,  1.43s/it]  1%|          | 3/411 [00:04<09:23,  1.38s/it]  1%|          | 4/411 [00:05<09:13,  1.36s/it]  1%|          | 5/411 [00:06<09:07,  1.35s/it]  1%|▏         | 6/411 [00:08<09:02,  1.34s/it]  2%|▏         | 7/411 [00:09<08:59,  1.34s/it]  2%|▏         | 8/411 [00:10<08:58,  1.34s/it]  2%|▏         | 9/411 [00:12<08:55,  1.33s/it]  2%|▏         | 10/411 [00:13<08:53,  1.33s/it]  3%|▎         | 11/411 [00:14<08:51,  1.33s/it]  3%|▎         | 12/411 [00:16<08:49,  1.33s/it]  3%|▎         | 13/411 [00:17<08:48,  1.33s/it]  3%|▎         | 14/411 [00:18<08:46,  1.33s/it]  4%|▎         | 15/411 [00:20<08:45,  1.33s/it]  4%|▍         | 16/411 [00:21<08:44,  1.33s/it]  4%|▍         | 17/411 [00:22<08:42,  1.33s/it]  4%|▍         | 18/411 [00:24<08:41,  1.33s/it]  5%|▍         | 19/411 [00:25<08:40,  1.33s/it]  5%|▍         | 20/411 [00:26<08:38,  1.33s/it]  5%|▌         | 21/411 [00:28<08:37,  1.33s/it]  5%|▌         | 22/411 [00:29<08:35,  1.33s/it]  6%|▌         | 23/411 [00:30<08:34,  1.33s/it]  6%|▌         | 24/411 [00:32<08:33,  1.33s/it]  6%|▌         | 25/411 [00:33<08:31,  1.33s/it]  6%|▋         | 26/411 [00:34<08:30,  1.33s/it]  7%|▋         | 27/411 [00:36<08:29,  1.33s/it]  7%|▋         | 28/411 [00:37<08:28,  1.33s/it]  7%|▋         | 29/411 [00:38<08:26,  1.33s/it]  7%|▋         | 30/411 [00:40<08:25,  1.33s/it]  8%|▊         | 31/411 [00:41<08:24,  1.33s/it]  8%|▊         | 32/411 [00:42<08:22,  1.33s/it]  8%|▊         | 33/411 [00:44<08:21,  1.33s/it]  8%|▊         | 34/411 [00:45<08:20,  1.33s/it]  9%|▊         | 35/411 [00:46<08:18,  1.33s/it]  9%|▉         | 36/411 [00:48<08:17,  1.33s/it]  9%|▉         | 37/411 [00:49<08:16,  1.33s/it]  9%|▉         | 38/411 [00:50<08:14,  1.33s/it]  9%|▉         | 39/411 [00:51<08:13,  1.33s/it] 10%|▉         | 40/411 [00:53<08:12,  1.33s/it] 10%|▉         | 41/411 [00:54<08:10,  1.33s/it] 10%|█         | 42/411 [00:55<08:09,  1.33s/it] 10%|█         | 43/411 [00:57<08:08,  1.33s/it] 11%|█         | 44/411 [00:58<08:07,  1.33s/it] 11%|█         | 45/411 [00:59<08:05,  1.33s/it] 11%|█         | 46/411 [01:01<08:04,  1.33s/it] 11%|█▏        | 47/411 [01:02<08:03,  1.33s/it] 12%|█▏        | 48/411 [01:03<08:01,  1.33s/it] 12%|█▏        | 49/411 [01:05<08:00,  1.33s/it] 12%|█▏        | 50/411 [01:06<07:59,  1.33s/it] 12%|█▏        | 51/411 [01:07<07:57,  1.33s/it] 13%|█▎        | 52/411 [01:09<07:56,  1.33s/it] 13%|█▎        | 53/411 [01:10<07:55,  1.33s/it] 13%|█▎        | 54/411 [01:11<07:53,  1.33s/it] 13%|█▎        | 55/411 [01:13<07:52,  1.33s/it] 14%|█▎        | 56/411 [01:14<07:51,  1.33s/it] 14%|█▍        | 57/411 [01:15<07:49,  1.33s/it] 14%|█▍        | 58/411 [01:17<07:48,  1.33s/it] 14%|█▍        | 59/411 [01:18<07:47,  1.33s/it] 15%|█▍        | 60/411 [01:19<07:45,  1.33s/it] 15%|█▍        | 61/411 [01:21<07:44,  1.33s/it] 15%|█▌        | 62/411 [01:22<07:42,  1.33s/it] 15%|█▌        | 63/411 [01:23<07:41,  1.33s/it] 16%|█▌        | 64/411 [01:25<07:40,  1.33s/it] 16%|█▌        | 65/411 [01:26<07:39,  1.33s/it] 16%|█▌        | 66/411 [01:27<07:37,  1.33s/it] 16%|█▋        | 67/411 [01:29<07:36,  1.33s/it] 17%|█▋        | 68/411 [01:30<07:34,  1.33s/it] 17%|█▋        | 69/411 [01:31<07:33,  1.33s/it] 17%|█▋        | 70/411 [01:33<07:32,  1.33s/it] 17%|█▋        | 71/411 [01:34<07:30,  1.33s/it] 18%|█▊        | 72/411 [01:35<07:29,  1.33s/it] 18%|█▊        | 73/411 [01:37<07:28,  1.33s/it] 18%|█▊        | 74/411 [01:38<07:27,  1.33s/it] 18%|█▊        | 75/411 [01:39<07:25,  1.33s/it] 18%|█▊        | 76/411 [01:41<07:24,  1.33s/it] 19%|█▊        | 77/411 [01:42<07:23,  1.33s/it] 19%|█▉        | 78/411 [01:43<07:21,  1.33s/it] 19%|█▉        | 79/411 [01:45<07:20,  1.33s/it] 19%|█▉        | 80/411 [01:46<07:19,  1.33s/it] 20%|█▉        | 81/411 [01:47<07:17,  1.33s/it] 20%|█▉        | 82/411 [01:49<07:16,  1.33s/it] 20%|██        | 83/411 [01:50<07:15,  1.33s/it] 20%|██        | 84/411 [01:51<07:13,  1.33s/it] 21%|██        | 85/411 [01:53<07:12,  1.33s/it] 21%|██        | 86/411 [01:54<07:11,  1.33s/it] 21%|██        | 87/411 [01:55<07:09,  1.33s/it] 21%|██▏       | 88/411 [01:56<07:08,  1.33s/it] 22%|██▏       | 89/411 [01:58<07:07,  1.33s/it] 22%|██▏       | 90/411 [01:59<07:05,  1.33s/it] 22%|██▏       | 91/411 [02:00<07:04,  1.33s/it] 22%|██▏       | 92/411 [02:02<07:03,  1.33s/it] 23%|██▎       | 93/411 [02:03<07:01,  1.33s/it] 23%|██▎       | 94/411 [02:04<07:00,  1.33s/it] 23%|██▎       | 95/411 [02:06<06:59,  1.33s/it] 23%|██▎       | 96/411 [02:07<06:57,  1.33s/it] 24%|██▎       | 97/411 [02:08<06:56,  1.33s/it] 24%|██▍       | 98/411 [02:10<06:54,  1.33s/it] 24%|██▍       | 99/411 [02:11<06:53,  1.33s/it] 24%|██▍       | 100/411 [02:12<06:52,  1.33s/it]                                                  24%|██▍       | 100/411 [02:12<06:52,  1.33s/it] 25%|██▍       | 101/411 [02:14<06:51,  1.33s/it] 25%|██▍       | 102/411 [02:15<06:49,  1.33s/it] 25%|██▌       | 103/411 [02:16<06:48,  1.33s/it] 25%|██▌       | 104/411 [02:18<06:46,  1.33s/it] 26%|██▌       | 105/411 [02:19<06:45,  1.33s/it] 26%|██▌       | 106/411 [02:20<06:44,  1.33s/it] 26%|██▌       | 107/411 [02:22<06:42,  1.33s/it] 26%|██▋       | 108/411 [02:23<06:41,  1.33s/it] 27%|██▋       | 109/411 [02:24<06:40,  1.33s/it] 27%|██▋       | 110/411 [02:26<06:38,  1.33s/it] 27%|██▋       | 111/411 [02:27<06:37,  1.33s/it] 27%|██▋       | 112/411 [02:28<06:36,  1.33s/it] 27%|██▋       | 113/411 [02:30<06:34,  1.33s/it] 28%|██▊       | 114/411 [02:31<06:33,  1.33s/it] 28%|██▊       | 115/411 [02:32<06:32,  1.33s/it] 28%|██▊       | 116/411 [02:34<06:30,  1.33s/it] 28%|██▊       | 117/411 [02:35<06:29,  1.33s/it] 29%|██▊       | 118/411 [02:36<06:28,  1.33s/it] 29%|██▉       | 119/411 [02:38<06:26,  1.33s/it] 29%|██▉       | 120/411 [02:39<06:25,  1.33s/it] 29%|██▉       | 121/411 [02:40<06:24,  1.33s/it] 30%|██▉       | 122/411 [02:42<06:22,  1.33s/it] 30%|██▉       | 123/411 [02:43<06:21,  1.33s/it] 30%|███       | 124/411 [02:44<06:20,  1.33s/it] 30%|███       | 125/411 [02:46<06:18,  1.33s/it] 31%|███       | 126/411 [02:47<06:17,  1.33s/it] 31%|███       | 127/411 [02:48<06:16,  1.33s/it] 31%|███       | 128/411 [02:50<06:14,  1.33s/it] 31%|███▏      | 129/411 [02:51<06:13,  1.33s/it] 32%|███▏      | 130/411 [02:52<06:12,  1.33s/it] 32%|███▏      | 131/411 [02:53<06:11,  1.33s/it] 32%|███▏      | 132/411 [02:55<06:09,  1.33s/it] 32%|███▏      | 133/411 [02:56<06:08,  1.32s/it] 33%|███▎      | 134/411 [02:57<06:07,  1.33s/it] 33%|███▎      | 135/411 [02:59<06:05,  1.32s/it] 33%|███▎      | 136/411 [03:00<06:04,  1.33s/it] 33%|███▎      | 137/411 [03:01<06:03,  1.33s/it] 34%|███▎      | 138/411 [03:03<06:01,  1.33s/it] 34%|███▍      | 139/411 [03:04<06:00,  1.33s/it] 34%|███▍      | 140/411 [03:05<05:59,  1.33s/it] 34%|███▍      | 141/411 [03:07<05:57,  1.33s/it] 35%|███▍      | 142/411 [03:08<05:56,  1.33s/it] 35%|███▍      | 143/411 [03:09<05:55,  1.33s/it] 35%|███▌      | 144/411 [03:11<05:54,  1.33s/it] 35%|███▌      | 145/411 [03:12<05:52,  1.33s/it] 36%|███▌      | 146/411 [03:13<05:51,  1.33s/it] 36%|███▌      | 147/411 [03:15<05:50,  1.33s/it] 36%|███▌      | 148/411 [03:16<05:48,  1.33s/it] 36%|███▋      | 149/411 [03:17<05:47,  1.33s/it] 36%|███▋      | 150/411 [03:19<05:45,  1.33s/it] 37%|███▋      | 151/411 [03:20<05:44,  1.33s/it] 37%|███▋      | 152/411 [03:21<05:43,  1.33s/it] 37%|███▋      | 153/411 [03:23<05:41,  1.33s/it] 37%|███▋      | 154/411 [03:24<05:40,  1.33s/it] 38%|███▊      | 155/411 [03:25<05:39,  1.33s/it] 38%|███▊      | 156/411 [03:27<05:37,  1.32s/it] 38%|███▊      | 157/411 [03:28<05:36,  1.32s/it] 38%|███▊      | 158/411 [03:29<05:35,  1.32s/it] 39%|███▊      | 159/411 [03:31<05:33,  1.32s/it] 39%|███▉      | 160/411 [03:32<05:32,  1.33s/it] 39%|███▉      | 161/411 [03:33<05:31,  1.32s/it] 39%|███▉      | 162/411 [03:35<05:29,  1.32s/it] 40%|███▉      | 163/411 [03:36<05:28,  1.32s/it] 40%|███▉      | 164/411 [03:37<05:27,  1.32s/it] 40%|████      | 165/411 [03:39<05:25,  1.32s/it] 40%|████      | 166/411 [03:40<05:24,  1.32s/it] 41%|████      | 167/411 [03:41<05:23,  1.32s/it] 41%|████      | 168/411 [03:43<05:21,  1.32s/it] 41%|████      | 169/411 [03:44<05:20,  1.32s/it] 41%|████▏     | 170/411 [03:45<05:19,  1.33s/it] 42%|████▏     | 171/411 [03:47<05:18,  1.33s/it] 42%|████▏     | 172/411 [03:48<05:16,  1.33s/it] 42%|████▏     | 173/411 [03:49<05:15,  1.33s/it] 42%|████▏     | 174/411 [03:50<05:14,  1.33s/it] 43%|████▎     | 175/411 [03:52<05:12,  1.33s/it] 43%|████▎     | 176/411 [03:53<05:11,  1.33s/it] 43%|████▎     | 177/411 [03:54<05:10,  1.33s/it] 43%|████▎     | 178/411 [03:56<05:08,  1.33s/it] 44%|████▎     | 179/411 [03:57<05:07,  1.33s/it] 44%|████▍     | 180/411 [03:58<05:06,  1.33s/it] 44%|████▍     | 181/411 [04:00<05:04,  1.33s/it] 44%|████▍     | 182/411 [04:01<05:03,  1.33s/it] 45%|████▍     | 183/411 [04:02<05:02,  1.33s/it] 45%|████▍     | 184/411 [04:04<05:00,  1.33s/it] 45%|████▌     | 185/411 [04:05<04:59,  1.32s/it] 45%|████▌     | 186/411 [04:06<04:58,  1.33s/it] 45%|████▌     | 187/411 [04:08<04:56,  1.33s/it] 46%|████▌     | 188/411 [04:09<04:55,  1.32s/it] 46%|████▌     | 189/411 [04:10<04:55,  1.33s/it] 46%|████▌     | 190/411 [04:12<04:54,  1.33s/it] 46%|████▋     | 191/411 [04:13<04:52,  1.33s/it] 47%|████▋     | 192/411 [04:14<04:50,  1.33s/it] 47%|████▋     | 193/411 [04:16<04:49,  1.33s/it] 47%|████▋     | 194/411 [04:17<04:47,  1.33s/it] 47%|████▋     | 195/411 [04:18<04:46,  1.33s/it] 48%|████▊     | 196/411 [04:20<04:45,  1.33s/it] 48%|████▊     | 197/411 [04:21<04:43,  1.33s/it] 48%|████▊     | 198/411 [04:22<04:42,  1.33s/it] 48%|████▊     | 199/411 [04:24<04:41,  1.33s/it] 49%|████▊     | 200/411 [04:25<04:39,  1.33s/it]                                                  49%|████▊     | 200/411 [04:25<04:39,  1.33s/it] 49%|████▉     | 201/411 [04:26<04:38,  1.33s/it] 49%|████▉     | 202/411 [04:28<04:37,  1.33s/it] 49%|████▉     | 203/411 [04:29<04:35,  1.33s/it] 50%|████▉     | 204/411 [04:30<04:34,  1.33s/it] 50%|████▉     | 205/411 [04:32<04:33,  1.33s/it] 50%|█████     | 206/411 [04:33<04:31,  1.33s/it] 50%|█████     | 207/411 [04:34<04:30,  1.33s/it] 51%|█████     | 208/411 [04:36<04:29,  1.33s/it] 51%|█████     | 209/411 [04:37<04:27,  1.33s/it] 51%|█████     | 210/411 [04:38<04:26,  1.33s/it] 51%|█████▏    | 211/411 [04:40<04:25,  1.33s/it] 52%|█████▏    | 212/411 [04:41<04:23,  1.33s/it] 52%|█████▏    | 213/411 [04:42<04:22,  1.33s/it] 52%|█████▏    | 214/411 [04:44<04:21,  1.33s/it] 52%|█████▏    | 215/411 [04:45<04:19,  1.33s/it] 53%|█████▎    | 216/411 [04:46<04:18,  1.33s/it] 53%|█████▎    | 217/411 [04:47<04:17,  1.33s/it] 53%|█████▎    | 218/411 [04:49<04:15,  1.33s/it] 53%|█████▎    | 219/411 [04:50<04:14,  1.32s/it] 54%|█████▎    | 220/411 [04:51<04:13,  1.33s/it] 54%|█████▍    | 221/411 [04:53<04:11,  1.33s/it] 54%|█████▍    | 222/411 [04:54<04:10,  1.33s/it] 54%|█████▍    | 223/411 [04:55<04:09,  1.33s/it] 55%|█████▍    | 224/411 [04:57<04:07,  1.33s/it] 55%|█████▍    | 225/411 [04:58<04:06,  1.33s/it] 55%|█████▍    | 226/411 [04:59<04:05,  1.33s/it] 55%|█████▌    | 227/411 [05:01<04:03,  1.33s/it] 55%|█████▌    | 228/411 [05:02<04:02,  1.33s/it] 56%|█████▌    | 229/411 [05:03<04:01,  1.33s/it] 56%|█████▌    | 230/411 [05:05<03:59,  1.32s/it] 56%|█████▌    | 231/411 [05:06<03:58,  1.32s/it] 56%|█████▋    | 232/411 [05:07<03:57,  1.33s/it] 57%|█████▋    | 233/411 [05:09<03:55,  1.33s/it] 57%|█████▋    | 234/411 [05:10<03:54,  1.33s/it] 57%|█████▋    | 235/411 [05:11<03:53,  1.33s/it] 57%|█████▋    | 236/411 [05:13<03:51,  1.33s/it] 58%|█████▊    | 237/411 [05:14<03:50,  1.33s/it] 58%|█████▊    | 238/411 [05:15<03:49,  1.33s/it] 58%|█████▊    | 239/411 [05:17<03:47,  1.33s/it] 58%|█████▊    | 240/411 [05:18<03:46,  1.32s/it] 59%|█████▊    | 241/411 [05:19<03:45,  1.32s/it] 59%|█████▉    | 242/411 [05:21<03:44,  1.33s/it] 59%|█████▉    | 243/411 [05:22<03:42,  1.33s/it] 59%|█████▉    | 244/411 [05:23<03:41,  1.33s/it] 60%|█████▉    | 245/411 [05:25<03:39,  1.32s/it] 60%|█████▉    | 246/411 [05:26<03:38,  1.32s/it] 60%|██████    | 247/411 [05:27<03:37,  1.32s/it] 60%|██████    | 248/411 [05:29<03:35,  1.32s/it] 61%|██████    | 249/411 [05:30<03:34,  1.32s/it] 61%|██████    | 250/411 [05:31<03:33,  1.32s/it] 61%|██████    | 251/411 [05:33<03:31,  1.32s/it] 61%|██████▏   | 252/411 [05:34<03:30,  1.32s/it] 62%|██████▏   | 253/411 [05:35<03:29,  1.32s/it] 62%|██████▏   | 254/411 [05:37<03:27,  1.32s/it] 62%|██████▏   | 255/411 [05:38<03:26,  1.32s/it] 62%|██████▏   | 256/411 [05:39<03:25,  1.32s/it] 63%|██████▎   | 257/411 [05:40<03:24,  1.33s/it] 63%|██████▎   | 258/411 [05:42<03:22,  1.33s/it] 63%|██████▎   | 259/411 [05:43<03:21,  1.33s/it] 63%|██████▎   | 260/411 [05:44<03:20,  1.33s/it] 64%|██████▎   | 261/411 [05:46<03:18,  1.32s/it] 64%|██████▎   | 262/411 [05:47<03:17,  1.32s/it] 64%|██████▍   | 263/411 [05:48<03:16,  1.32s/it] 64%|██████▍   | 264/411 [05:50<03:14,  1.32s/it] 64%|██████▍   | 265/411 [05:51<03:13,  1.32s/it] 65%|██████▍   | 266/411 [05:52<03:12,  1.32s/it] 65%|██████▍   | 267/411 [05:54<03:10,  1.32s/it] 65%|██████▌   | 268/411 [05:55<03:09,  1.32s/it] 65%|██████▌   | 269/411 [05:56<03:08,  1.32s/it] 66%|██████▌   | 270/411 [05:58<03:06,  1.32s/it] 66%|██████▌   | 271/411 [05:59<03:05,  1.32s/it] 66%|██████▌   | 272/411 [06:00<03:04,  1.32s/it] 66%|██████▋   | 273/411 [06:02<03:02,  1.32s/it] 67%|██████▋   | 274/411 [06:03<03:01,  1.32s/it] 67%|██████▋   | 275/411 [06:04<03:00,  1.32s/it] 67%|██████▋   | 276/411 [06:06<02:58,  1.32s/it] 67%|██████▋   | 277/411 [06:07<02:57,  1.32s/it] 68%|██████▊   | 278/411 [06:08<02:56,  1.32s/it] 68%|██████▊   | 279/411 [06:10<02:54,  1.32s/it] 68%|██████▊   | 280/411 [06:11<02:53,  1.32s/it] 68%|██████▊   | 281/411 [06:12<02:52,  1.32s/it] 69%|██████▊   | 282/411 [06:14<02:50,  1.32s/it] 69%|██████▉   | 283/411 [06:15<02:49,  1.32s/it] 69%|██████▉   | 284/411 [06:16<02:48,  1.32s/it] 69%|██████▉   | 285/411 [06:18<02:46,  1.32s/it] 70%|██████▉   | 286/411 [06:19<02:45,  1.32s/it] 70%|██████▉   | 287/411 [06:20<02:44,  1.32s/it] 70%|███████   | 288/411 [06:22<02:42,  1.32s/it] 70%|███████   | 289/411 [06:23<02:41,  1.32s/it] 71%|███████   | 290/411 [06:24<02:40,  1.32s/it] 71%|███████   | 291/411 [06:26<02:38,  1.32s/it] 71%|███████   | 292/411 [06:27<02:37,  1.32s/it] 71%|███████▏  | 293/411 [06:28<02:36,  1.32s/it] 72%|███████▏  | 294/411 [06:29<02:34,  1.32s/it] 72%|███████▏  | 295/411 [06:31<02:33,  1.32s/it] 72%|███████▏  | 296/411 [06:32<02:32,  1.32s/it] 72%|███████▏  | 297/411 [06:33<02:30,  1.32s/it] 73%|███████▎  | 298/411 [06:35<02:29,  1.32s/it] 73%|███████▎  | 299/411 [06:36<02:28,  1.32s/it] 73%|███████▎  | 300/411 [06:37<02:27,  1.32s/it]                                                  73%|███████▎  | 300/411 [06:37<02:27,  1.32s/it] 73%|███████▎  | 301/411 [06:39<02:25,  1.32s/it] 73%|███████▎  | 302/411 [06:40<02:24,  1.32s/it] 74%|███████▎  | 303/411 [06:41<02:23,  1.32s/it] 74%|███████▍  | 304/411 [06:43<02:21,  1.32s/it] 74%|███████▍  | 305/411 [06:44<02:20,  1.32s/it] 74%|███████▍  | 306/411 [06:45<02:19,  1.32s/it] 75%|███████▍  | 307/411 [06:47<02:17,  1.32s/it] 75%|███████▍  | 308/411 [06:48<02:16,  1.32s/it] 75%|███████▌  | 309/411 [06:49<02:15,  1.32s/it] 75%|███████▌  | 310/411 [06:51<02:13,  1.32s/it] 76%|███████▌  | 311/411 [06:52<02:12,  1.32s/it] 76%|███████▌  | 312/411 [06:53<02:11,  1.32s/it] 76%|███████▌  | 313/411 [06:55<02:09,  1.32s/it] 76%|███████▋  | 314/411 [06:56<02:08,  1.32s/it] 77%|███████▋  | 315/411 [06:57<02:07,  1.32s/it] 77%|███████▋  | 316/411 [06:59<02:05,  1.32s/it] 77%|███████▋  | 317/411 [07:00<02:04,  1.32s/it] 77%|███████▋  | 318/411 [07:01<02:03,  1.32s/it] 78%|███████▊  | 319/411 [07:03<02:01,  1.32s/it] 78%|███████▊  | 320/411 [07:04<02:00,  1.32s/it] 78%|███████▊  | 321/411 [07:05<01:59,  1.32s/it] 78%|███████▊  | 322/411 [07:07<01:57,  1.32s/it] 79%|███████▊  | 323/411 [07:08<01:56,  1.32s/it] 79%|███████▉  | 324/411 [07:09<01:55,  1.32s/it] 79%|███████▉  | 325/411 [07:11<01:54,  1.33s/it] 79%|███████▉  | 326/411 [07:12<01:52,  1.33s/it] 80%|███████▉  | 327/411 [07:13<01:51,  1.33s/it] 80%|███████▉  | 328/411 [07:15<01:50,  1.33s/it] 80%|████████  | 329/411 [07:16<01:48,  1.33s/it] 80%|████████  | 330/411 [07:17<01:47,  1.32s/it] 81%|████████  | 331/411 [07:19<01:45,  1.32s/it] 81%|████████  | 332/411 [07:20<01:44,  1.32s/it] 81%|████████  | 333/411 [07:21<01:43,  1.32s/it] 81%|████████▏ | 334/411 [07:22<01:41,  1.32s/it] 82%|████████▏ | 335/411 [07:24<01:40,  1.32s/it] 82%|████████▏ | 336/411 [07:25<01:39,  1.32s/it] 82%|████████▏ | 337/411 [07:26<01:37,  1.32s/it] 82%|████████▏ | 338/411 [07:28<01:36,  1.32s/it] 82%|████████▏ | 339/411 [07:29<01:35,  1.32s/it] 83%|████████▎ | 340/411 [07:30<01:34,  1.32s/it] 83%|████████▎ | 341/411 [07:32<01:32,  1.32s/it] 83%|████████▎ | 342/411 [07:33<01:31,  1.32s/it] 83%|████████▎ | 343/411 [07:34<01:30,  1.32s/it] 84%|████████▎ | 344/411 [07:36<01:28,  1.32s/it] 84%|████████▍ | 345/411 [07:37<01:27,  1.32s/it] 84%|████████▍ | 346/411 [07:38<01:26,  1.32s/it] 84%|████████▍ | 347/411 [07:40<01:24,  1.32s/it] 85%|████████▍ | 348/411 [07:41<01:23,  1.32s/it] 85%|████████▍ | 349/411 [07:42<01:22,  1.32s/it] 85%|████████▌ | 350/411 [07:44<01:20,  1.32s/it] 85%|████████▌ | 351/411 [07:45<01:19,  1.32s/it] 86%|████████▌ | 352/411 [07:46<01:18,  1.32s/it] 86%|████████▌ | 353/411 [07:48<01:16,  1.33s/it] 86%|████████▌ | 354/411 [07:49<01:15,  1.33s/it] 86%|████████▋ | 355/411 [07:50<01:14,  1.33s/it] 87%|████████▋ | 356/411 [07:52<01:12,  1.32s/it] 87%|████████▋ | 357/411 [07:53<01:11,  1.32s/it] 87%|████████▋ | 358/411 [07:54<01:10,  1.32s/it] 87%|████████▋ | 359/411 [07:56<01:08,  1.32s/it] 88%|████████▊ | 360/411 [07:57<01:07,  1.32s/it] 88%|████████▊ | 361/411 [07:58<01:06,  1.32s/it] 88%|████████▊ | 362/411 [08:00<01:04,  1.32s/it] 88%|████████▊ | 363/411 [08:01<01:03,  1.32s/it] 89%|████████▊ | 364/411 [08:02<01:02,  1.32s/it] 89%|████████▉ | 365/411 [08:04<01:00,  1.32s/it] 89%|████████▉ | 366/411 [08:05<00:59,  1.32s/it] 89%|████████▉ | 367/411 [08:06<00:58,  1.32s/it] 90%|████████▉ | 368/411 [08:08<00:56,  1.32s/it] 90%|████████▉ | 369/411 [08:09<00:55,  1.32s/it] 90%|█████████ | 370/411 [08:10<00:54,  1.32s/it] 90%|█████████ | 371/411 [08:11<00:52,  1.32s/it] 91%|█████████ | 372/411 [08:13<00:51,  1.32s/it] 91%|█████████ | 373/411 [08:14<00:50,  1.32s/it] 91%|█████████ | 374/411 [08:15<00:48,  1.32s/it] 91%|█████████ | 375/411 [08:17<00:47,  1.32s/it] 91%|█████████▏| 376/411 [08:18<00:46,  1.32s/it] 92%|█████████▏| 377/411 [08:19<00:45,  1.32s/it] 92%|█████████▏| 378/411 [08:21<00:43,  1.32s/it] 92%|█████████▏| 379/411 [08:22<00:42,  1.32s/it] 92%|█████████▏| 380/411 [08:23<00:41,  1.32s/it] 93%|█████████▎| 381/411 [08:25<00:39,  1.32s/it] 93%|█████████▎| 382/411 [08:26<00:38,  1.32s/it] 93%|█████████▎| 383/411 [08:27<00:37,  1.32s/it] 93%|█████████▎| 384/411 [08:29<00:35,  1.32s/it] 94%|█████████▎| 385/411 [08:30<00:34,  1.32s/it] 94%|█████████▍| 386/411 [08:31<00:33,  1.32s/it] 94%|█████████▍| 387/411 [08:33<00:31,  1.32s/it] 94%|█████████▍| 388/411 [08:34<00:30,  1.32s/it] 95%|█████████▍| 389/411 [08:35<00:29,  1.32s/it] 95%|█████████▍| 390/411 [08:37<00:27,  1.32s/it] 95%|█████████▌| 391/411 [08:38<00:26,  1.32s/it] 95%|█████████▌| 392/411 [08:39<00:25,  1.32s/it] 96%|█████████▌| 393/411 [08:41<00:23,  1.33s/it] 96%|█████████▌| 394/411 [08:42<00:22,  1.33s/it] 96%|█████████▌| 395/411 [08:43<00:21,  1.33s/it] 96%|█████████▋| 396/411 [08:45<00:19,  1.33s/it] 97%|█████████▋| 397/411 [08:46<00:18,  1.33s/it] 97%|█████████▋| 398/411 [08:47<00:17,  1.32s/it] 97%|█████████▋| 399/411 [08:49<00:15,  1.32s/it] 97%|█████████▋| 400/411 [08:50<00:14,  1.32s/it]                                                  97%|█████████▋| 400/411 [08:50<00:14,  1.32s/it] 98%|█████████▊| 401/411 [08:51<00:13,  1.33s/it] 98%|█████████▊| 402/411 [08:53<00:11,  1.33s/it] 98%|█████████▊| 403/411 [08:54<00:10,  1.33s/it] 98%|█████████▊| 404/411 [08:55<00:09,  1.32s/it] 99%|█████████▊| 405/411 [08:57<00:07,  1.32s/it] 99%|█████████▉| 406/411 [08:58<00:06,  1.32s/it] 99%|█████████▉| 407/411 [08:59<00:05,  1.32s/it] 99%|█████████▉| 408/411 [09:01<00:03,  1.32s/it]100%|█████████▉| 409/411 [09:02<00:02,  1.32s/it]100%|█████████▉| 410/411 [09:03<00:01,  1.32s/it]100%|██████████| 411/411 [09:04<00:00,  1.15s/it]/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x145ef4788760>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 944a2641-24b8-455c-8dfa-14a934e8fd3d)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                 100%|██████████| 411/411 [09:04<00:00,  1.15s/it]100%|██████████| 411/411 [09:04<00:00,  1.33s/it]
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x145ef475bfd0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 19725974-28f0-40e5-830e-61908c26dacc)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'loss': 2.5283, 'grad_norm': 3.07285737991333, 'learning_rate': 1.51338199513382e-05, 'epoch': 0.24}
{'loss': 0.7003, 'grad_norm': 3.926208019256592, 'learning_rate': 1.0267639902676401e-05, 'epoch': 0.49}
{'loss': 0.3336, 'grad_norm': 3.1677358150482178, 'learning_rate': 5.401459854014599e-06, 'epoch': 0.73}
{'loss': 0.2909, 'grad_norm': 4.661562442779541, 'learning_rate': 5.839416058394161e-07, 'epoch': 0.97}
{'train_runtime': 544.5995, 'train_samples_per_second': 3.015, 'train_steps_per_second': 0.755, 'train_loss': 0.9449954253333619, 'epoch': 1.0}
Saving model to ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_prop_var_prop_rep/meta-llama/Llama-3.2-3B-Instruct_60
Fine-tuning completed successfully!
2025-05-01 18:38:32.903251: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 18:38:32.916757: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746139112.931669  322653 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746139112.936249  322653 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746139112.948887  322653 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746139112.948906  322653 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746139112.948908  322653 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746139112.948909  322653 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 18:38:32.952801: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
=== Fine-tuning Configuration ===
Model: 
Training dataset: 
Random seed: 36
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: 
===========================
CUDA available: True
CUDA device count: 1
CUDA current device: 0
CUDA device name: NVIDIA A100 80GB PCIe MIG 3g.40gb
train_config(model_name='meta-llama/Llama-3.2-3B-Instruct', enable_fsdp=False, low_cpu_fsdp=False, run_validation=True, batch_size_training=4, gradient_accumulation_steps=1, num_epochs=1, num_workers_dataloader=1, lr=2e-05, weight_decay=0.0, gamma=0.85, seed=60, use_fp16=False, mixed_precision=True, val_batch_size=1, peft_method='lora', use_peft=False, output_dir='../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_true_prop_var/meta-llama/Llama-3.2-3B-Instruct_60', freeze_layers=False, num_freeze_layers=1, quantization=True, one_gpu=False, save_model=True, save_every_epoch=True, dist_checkpoint_root_folder='fsdp', dist_checkpoint_folder='fine-tuned', save_optimizer=False, use_fast_kernels=False, use_lora=True, save_full_gradients=False, system_message='You are a helpful assistant. Provide your best guess or estimate given the scenario. Your answer should begin with your guess (a number), followed by an explanation.', ft_dataset_name='no_bias_true_prop_var', dataset='datasets/ft/no_bias_true_prop_var.jsonl', eval_dataset_name='bbq_subset_100', eval_dataset=None, eval_output_file=None, base_output_file=None)
Clearing GPU cache
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:05<00:00,  2.56s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Applying LoRA adapter...
trainable params: 2,293,760 || all params: 3,215,046,656 || trainable%: 0.0713
Loading data from datasets/ft/no_bias_true_prop_var.jsonl...
Using all 2880 examples from dataset
Map:   0%|          | 0/2880 [00:00<?, ? examples/s]Map:  97%|█████████▋| 2801/2880 [00:00<00:00, 27870.82 examples/s]Map: 100%|██████████| 2880/2880 [00:00<00:00, 27349.45 examples/s]
Map:   0%|          | 0/2880 [00:00<?, ? examples/s]Map:  35%|███▍      | 1000/2880 [00:00<00:00, 2332.93 examples/s]Map:  69%|██████▉   | 2000/2880 [00:00<00:00, 2431.52 examples/s]Map: 100%|██████████| 2880/2880 [00:01<00:00, 2477.74 examples/s]Map: 100%|██████████| 2880/2880 [00:01<00:00, 2434.38 examples/s]
/home/janeec/FairTune/finetune_w_eval_llama.py:297: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
=== Fine-tuning Configuration ===
Model: meta-llama/Llama-3.2-3B-Instruct
Training dataset: datasets/ft/no_bias_true_prop_var.jsonl
Random seed: 60
Batch size: 4
Gradient accumulation steps: 1
Effective batch size: 4
Learning rate: 2e-05
Number of epochs: 1
Using LoRA: True
Output directory: ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_true_prop_var/meta-llama/Llama-3.2-3B-Instruct_60
===========================
SEED CHECK:, should be: 60, seed is: 60
Starting fine-tuning...
  0%|          | 0/720 [00:00<?, ?it/s]  0%|          | 1/720 [00:01<18:54,  1.58s/it]  0%|          | 2/720 [00:02<17:12,  1.44s/it]  0%|          | 3/720 [00:04<16:34,  1.39s/it]  1%|          | 4/720 [00:05<16:15,  1.36s/it]  1%|          | 5/720 [00:06<16:05,  1.35s/it]  1%|          | 6/720 [00:08<15:57,  1.34s/it]  1%|          | 7/720 [00:09<15:52,  1.34s/it]  1%|          | 8/720 [00:10<15:49,  1.33s/it]  1%|▏         | 9/720 [00:12<15:46,  1.33s/it]  1%|▏         | 10/720 [00:13<15:44,  1.33s/it]  2%|▏         | 11/720 [00:14<15:43,  1.33s/it]  2%|▏         | 12/720 [00:16<15:42,  1.33s/it]  2%|▏         | 13/720 [00:17<15:41,  1.33s/it]  2%|▏         | 14/720 [00:18<15:39,  1.33s/it]  2%|▏         | 15/720 [00:20<15:37,  1.33s/it]  2%|▏         | 16/720 [00:21<15:35,  1.33s/it]  2%|▏         | 17/720 [00:22<15:33,  1.33s/it]  2%|▎         | 18/720 [00:24<15:32,  1.33s/it]  3%|▎         | 19/720 [00:25<15:30,  1.33s/it]  3%|▎         | 20/720 [00:26<15:29,  1.33s/it]  3%|▎         | 21/720 [00:28<15:27,  1.33s/it]  3%|▎         | 22/720 [00:29<15:26,  1.33s/it]  3%|▎         | 23/720 [00:30<15:25,  1.33s/it]  3%|▎         | 24/720 [00:32<15:23,  1.33s/it]  3%|▎         | 25/720 [00:33<15:22,  1.33s/it]  4%|▎         | 26/720 [00:34<15:20,  1.33s/it]  4%|▍         | 27/720 [00:36<15:19,  1.33s/it]  4%|▍         | 28/720 [00:37<15:17,  1.33s/it]  4%|▍         | 29/720 [00:38<15:16,  1.33s/it]  4%|▍         | 30/720 [00:40<15:15,  1.33s/it]  4%|▍         | 31/720 [00:41<15:14,  1.33s/it]  4%|▍         | 32/720 [00:42<15:12,  1.33s/it]  5%|▍         | 33/720 [00:44<15:11,  1.33s/it]  5%|▍         | 34/720 [00:45<15:09,  1.33s/it]  5%|▍         | 35/720 [00:46<15:08,  1.33s/it]  5%|▌         | 36/720 [00:48<15:07,  1.33s/it]  5%|▌         | 37/720 [00:49<15:05,  1.33s/it]  5%|▌         | 38/720 [00:50<15:04,  1.33s/it]  5%|▌         | 39/720 [00:52<15:03,  1.33s/it]  6%|▌         | 40/720 [00:53<15:01,  1.33s/it]  6%|▌         | 41/720 [00:54<15:00,  1.33s/it]  6%|▌         | 42/720 [00:55<14:59,  1.33s/it]  6%|▌         | 43/720 [00:57<14:58,  1.33s/it]  6%|▌         | 44/720 [00:58<14:56,  1.33s/it]  6%|▋         | 45/720 [00:59<14:55,  1.33s/it]  6%|▋         | 46/720 [01:01<14:54,  1.33s/it]  7%|▋         | 47/720 [01:02<14:52,  1.33s/it]  7%|▋         | 48/720 [01:03<14:51,  1.33s/it]  7%|▋         | 49/720 [01:05<14:50,  1.33s/it]  7%|▋         | 50/720 [01:06<14:48,  1.33s/it]  7%|▋         | 51/720 [01:07<14:47,  1.33s/it]  7%|▋         | 52/720 [01:09<14:45,  1.33s/it]  7%|▋         | 53/720 [01:10<14:44,  1.33s/it]  8%|▊         | 54/720 [01:11<14:43,  1.33s/it]  8%|▊         | 55/720 [01:13<14:41,  1.33s/it]  8%|▊         | 56/720 [01:14<14:40,  1.33s/it]  8%|▊         | 57/720 [01:15<14:39,  1.33s/it]  8%|▊         | 58/720 [01:17<14:40,  1.33s/it]  8%|▊         | 59/720 [01:18<14:38,  1.33s/it]  8%|▊         | 60/720 [01:19<14:36,  1.33s/it]  8%|▊         | 61/720 [01:21<14:35,  1.33s/it]  9%|▊         | 62/720 [01:22<14:33,  1.33s/it]  9%|▉         | 63/720 [01:23<14:32,  1.33s/it]  9%|▉         | 64/720 [01:25<14:30,  1.33s/it]  9%|▉         | 65/720 [01:26<14:29,  1.33s/it]  9%|▉         | 66/720 [01:27<14:27,  1.33s/it]  9%|▉         | 67/720 [01:29<14:26,  1.33s/it]  9%|▉         | 68/720 [01:30<14:24,  1.33s/it] 10%|▉         | 69/720 [01:31<14:23,  1.33s/it] 10%|▉         | 70/720 [01:33<14:22,  1.33s/it] 10%|▉         | 71/720 [01:34<14:21,  1.33s/it] 10%|█         | 72/720 [01:35<14:19,  1.33s/it] 10%|█         | 73/720 [01:37<14:18,  1.33s/it] 10%|█         | 74/720 [01:38<14:16,  1.33s/it] 10%|█         | 75/720 [01:39<14:15,  1.33s/it] 11%|█         | 76/720 [01:41<14:14,  1.33s/it] 11%|█         | 77/720 [01:42<14:13,  1.33s/it] 11%|█         | 78/720 [01:43<14:11,  1.33s/it] 11%|█         | 79/720 [01:45<14:10,  1.33s/it] 11%|█         | 80/720 [01:46<14:08,  1.33s/it] 11%|█▏        | 81/720 [01:47<14:07,  1.33s/it] 11%|█▏        | 82/720 [01:49<14:06,  1.33s/it] 12%|█▏        | 83/720 [01:50<14:04,  1.33s/it] 12%|█▏        | 84/720 [01:51<14:03,  1.33s/it] 12%|█▏        | 85/720 [01:53<14:02,  1.33s/it] 12%|█▏        | 86/720 [01:54<14:00,  1.33s/it] 12%|█▏        | 87/720 [01:55<13:59,  1.33s/it] 12%|█▏        | 88/720 [01:57<13:58,  1.33s/it] 12%|█▏        | 89/720 [01:58<13:56,  1.33s/it] 12%|█▎        | 90/720 [01:59<13:55,  1.33s/it] 13%|█▎        | 91/720 [02:01<13:54,  1.33s/it] 13%|█▎        | 92/720 [02:02<13:52,  1.33s/it] 13%|█▎        | 93/720 [02:03<13:51,  1.33s/it] 13%|█▎        | 94/720 [02:04<13:50,  1.33s/it] 13%|█▎        | 95/720 [02:06<13:48,  1.33s/it] 13%|█▎        | 96/720 [02:07<13:47,  1.33s/it] 13%|█▎        | 97/720 [02:08<13:46,  1.33s/it] 14%|█▎        | 98/720 [02:10<13:44,  1.33s/it] 14%|█▍        | 99/720 [02:11<13:43,  1.33s/it] 14%|█▍        | 100/720 [02:12<13:41,  1.33s/it]                                                  14%|█▍        | 100/720 [02:12<13:41,  1.33s/it] 14%|█▍        | 101/720 [02:14<13:40,  1.33s/it] 14%|█▍        | 102/720 [02:15<13:39,  1.33s/it] 14%|█▍        | 103/720 [02:16<13:38,  1.33s/it] 14%|█▍        | 104/720 [02:18<13:36,  1.33s/it] 15%|█▍        | 105/720 [02:19<13:35,  1.33s/it] 15%|█▍        | 106/720 [02:20<13:34,  1.33s/it] 15%|█▍        | 107/720 [02:22<13:32,  1.33s/it] 15%|█▌        | 108/720 [02:23<13:31,  1.33s/it] 15%|█▌        | 109/720 [02:24<13:29,  1.33s/it] 15%|█▌        | 110/720 [02:26<13:28,  1.33s/it] 15%|█▌        | 111/720 [02:27<13:27,  1.33s/it] 16%|█▌        | 112/720 [02:28<13:25,  1.33s/it] 16%|█▌        | 113/720 [02:30<13:24,  1.33s/it] 16%|█▌        | 114/720 [02:31<13:23,  1.33s/it] 16%|█▌        | 115/720 [02:32<13:21,  1.33s/it] 16%|█▌        | 116/720 [02:34<13:20,  1.33s/it] 16%|█▋        | 117/720 [02:35<13:19,  1.33s/it] 16%|█▋        | 118/720 [02:36<13:18,  1.33s/it] 17%|█▋        | 119/720 [02:38<13:16,  1.33s/it] 17%|█▋        | 120/720 [02:39<13:15,  1.33s/it] 17%|█▋        | 121/720 [02:40<13:14,  1.33s/it] 17%|█▋        | 122/720 [02:42<13:12,  1.33s/it] 17%|█▋        | 123/720 [02:43<13:11,  1.33s/it] 17%|█▋        | 124/720 [02:44<13:10,  1.33s/it] 17%|█▋        | 125/720 [02:46<13:08,  1.33s/it] 18%|█▊        | 126/720 [02:47<13:08,  1.33s/it] 18%|█▊        | 127/720 [02:48<13:07,  1.33s/it] 18%|█▊        | 128/720 [02:50<13:05,  1.33s/it] 18%|█▊        | 129/720 [02:51<13:04,  1.33s/it] 18%|█▊        | 130/720 [02:52<13:02,  1.33s/it] 18%|█▊        | 131/720 [02:54<13:01,  1.33s/it] 18%|█▊        | 132/720 [02:55<12:59,  1.33s/it] 18%|█▊        | 133/720 [02:56<12:58,  1.33s/it] 19%|█▊        | 134/720 [02:58<12:56,  1.33s/it] 19%|█▉        | 135/720 [02:59<12:55,  1.33s/it] 19%|█▉        | 136/720 [03:00<12:54,  1.33s/it] 19%|█▉        | 137/720 [03:02<12:53,  1.33s/it] 19%|█▉        | 138/720 [03:03<12:51,  1.33s/it] 19%|█▉        | 139/720 [03:04<12:50,  1.33s/it] 19%|█▉        | 140/720 [03:05<12:49,  1.33s/it] 20%|█▉        | 141/720 [03:07<12:47,  1.33s/it] 20%|█▉        | 142/720 [03:08<12:46,  1.33s/it] 20%|█▉        | 143/720 [03:09<12:45,  1.33s/it] 20%|██        | 144/720 [03:11<12:43,  1.33s/it] 20%|██        | 145/720 [03:12<12:42,  1.33s/it] 20%|██        | 146/720 [03:13<12:41,  1.33s/it] 20%|██        | 147/720 [03:15<12:39,  1.33s/it] 21%|██        | 148/720 [03:16<12:38,  1.33s/it] 21%|██        | 149/720 [03:17<12:37,  1.33s/it] 21%|██        | 150/720 [03:19<12:35,  1.33s/it] 21%|██        | 151/720 [03:20<12:34,  1.33s/it] 21%|██        | 152/720 [03:21<12:32,  1.33s/it] 21%|██▏       | 153/720 [03:23<12:31,  1.33s/it] 21%|██▏       | 154/720 [03:24<12:30,  1.33s/it] 22%|██▏       | 155/720 [03:25<12:29,  1.33s/it] 22%|██▏       | 156/720 [03:27<12:27,  1.33s/it] 22%|██▏       | 157/720 [03:28<12:26,  1.33s/it] 22%|██▏       | 158/720 [03:29<12:25,  1.33s/it] 22%|██▏       | 159/720 [03:31<12:23,  1.33s/it] 22%|██▏       | 160/720 [03:32<12:22,  1.33s/it] 22%|██▏       | 161/720 [03:33<12:21,  1.33s/it] 22%|██▎       | 162/720 [03:35<12:19,  1.33s/it] 23%|██▎       | 163/720 [03:36<12:18,  1.33s/it] 23%|██▎       | 164/720 [03:37<12:17,  1.33s/it] 23%|██▎       | 165/720 [03:39<12:15,  1.33s/it] 23%|██▎       | 166/720 [03:40<12:14,  1.33s/it] 23%|██▎       | 167/720 [03:41<12:13,  1.33s/it] 23%|██▎       | 168/720 [03:43<12:12,  1.33s/it] 23%|██▎       | 169/720 [03:44<12:10,  1.33s/it] 24%|██▎       | 170/720 [03:45<12:09,  1.33s/it] 24%|██▍       | 171/720 [03:47<12:09,  1.33s/it] 24%|██▍       | 172/720 [03:48<12:08,  1.33s/it] 24%|██▍       | 173/720 [03:49<12:06,  1.33s/it] 24%|██▍       | 174/720 [03:51<12:04,  1.33s/it] 24%|██▍       | 175/720 [03:52<12:03,  1.33s/it] 24%|██▍       | 176/720 [03:53<12:01,  1.33s/it] 25%|██▍       | 177/720 [03:55<12:00,  1.33s/it] 25%|██▍       | 178/720 [03:56<11:58,  1.33s/it] 25%|██▍       | 179/720 [03:57<11:57,  1.33s/it] 25%|██▌       | 180/720 [03:59<11:55,  1.33s/it] 25%|██▌       | 181/720 [04:00<11:54,  1.33s/it] 25%|██▌       | 182/720 [04:01<11:53,  1.33s/it] 25%|██▌       | 183/720 [04:03<11:52,  1.33s/it] 26%|██▌       | 184/720 [04:04<11:50,  1.33s/it] 26%|██▌       | 185/720 [04:05<11:49,  1.33s/it] 26%|██▌       | 186/720 [04:06<11:48,  1.33s/it] 26%|██▌       | 187/720 [04:08<11:46,  1.33s/it] 26%|██▌       | 188/720 [04:09<11:45,  1.33s/it] 26%|██▋       | 189/720 [04:10<11:44,  1.33s/it] 26%|██▋       | 190/720 [04:12<11:42,  1.33s/it] 27%|██▋       | 191/720 [04:13<11:41,  1.33s/it] 27%|██▋       | 192/720 [04:14<11:40,  1.33s/it] 27%|██▋       | 193/720 [04:16<11:38,  1.33s/it] 27%|██▋       | 194/720 [04:17<11:37,  1.33s/it] 27%|██▋       | 195/720 [04:18<11:36,  1.33s/it] 27%|██▋       | 196/720 [04:20<11:34,  1.33s/it] 27%|██▋       | 197/720 [04:21<11:33,  1.33s/it] 28%|██▊       | 198/720 [04:22<11:32,  1.33s/it] 28%|██▊       | 199/720 [04:24<11:30,  1.33s/it] 28%|██▊       | 200/720 [04:25<11:29,  1.33s/it]                                                  28%|██▊       | 200/720 [04:25<11:29,  1.33s/it] 28%|██▊       | 201/720 [04:26<11:28,  1.33s/it] 28%|██▊       | 202/720 [04:28<11:26,  1.33s/it] 28%|██▊       | 203/720 [04:29<11:25,  1.33s/it] 28%|██▊       | 204/720 [04:30<11:24,  1.33s/it] 28%|██▊       | 205/720 [04:32<11:22,  1.33s/it] 29%|██▊       | 206/720 [04:33<11:21,  1.33s/it] 29%|██▉       | 207/720 [04:34<11:20,  1.33s/it] 29%|██▉       | 208/720 [04:36<11:18,  1.33s/it] 29%|██▉       | 209/720 [04:37<11:17,  1.33s/it] 29%|██▉       | 210/720 [04:38<11:16,  1.33s/it] 29%|██▉       | 211/720 [04:40<11:14,  1.33s/it] 29%|██▉       | 212/720 [04:41<11:13,  1.33s/it] 30%|██▉       | 213/720 [04:42<11:12,  1.33s/it] 30%|██▉       | 214/720 [04:44<11:10,  1.33s/it] 30%|██▉       | 215/720 [04:45<11:09,  1.33s/it] 30%|███       | 216/720 [04:46<11:07,  1.33s/it] 30%|███       | 217/720 [04:48<11:06,  1.33s/it] 30%|███       | 218/720 [04:49<11:05,  1.33s/it] 30%|███       | 219/720 [04:50<11:03,  1.33s/it] 31%|███       | 220/720 [04:52<11:02,  1.33s/it] 31%|███       | 221/720 [04:53<11:01,  1.33s/it] 31%|███       | 222/720 [04:54<11:00,  1.33s/it] 31%|███       | 223/720 [04:56<10:58,  1.33s/it] 31%|███       | 224/720 [04:57<10:57,  1.33s/it] 31%|███▏      | 225/720 [04:58<10:56,  1.33s/it] 31%|███▏      | 226/720 [05:00<10:54,  1.33s/it] 32%|███▏      | 227/720 [05:01<10:53,  1.33s/it] 32%|███▏      | 228/720 [05:02<10:51,  1.33s/it] 32%|███▏      | 229/720 [05:03<10:50,  1.33s/it] 32%|███▏      | 230/720 [05:05<10:49,  1.33s/it] 32%|███▏      | 231/720 [05:06<10:48,  1.33s/it] 32%|███▏      | 232/720 [05:07<10:46,  1.33s/it] 32%|███▏      | 233/720 [05:09<10:45,  1.33s/it] 32%|███▎      | 234/720 [05:10<10:44,  1.33s/it] 33%|███▎      | 235/720 [05:11<10:42,  1.33s/it] 33%|███▎      | 236/720 [05:13<10:41,  1.33s/it] 33%|███▎      | 237/720 [05:14<10:40,  1.33s/it] 33%|███▎      | 238/720 [05:15<10:38,  1.33s/it] 33%|███▎      | 239/720 [05:17<10:38,  1.33s/it] 33%|███▎      | 240/720 [05:18<10:36,  1.33s/it] 33%|███▎      | 241/720 [05:19<10:35,  1.33s/it] 34%|███▎      | 242/720 [05:21<10:33,  1.33s/it] 34%|███▍      | 243/720 [05:22<10:32,  1.33s/it] 34%|███▍      | 244/720 [05:23<10:30,  1.33s/it] 34%|███▍      | 245/720 [05:25<10:29,  1.33s/it] 34%|███▍      | 246/720 [05:26<10:28,  1.33s/it] 34%|███▍      | 247/720 [05:27<10:26,  1.33s/it] 34%|███▍      | 248/720 [05:29<10:25,  1.33s/it] 35%|███▍      | 249/720 [05:30<10:24,  1.33s/it] 35%|███▍      | 250/720 [05:31<10:22,  1.33s/it] 35%|███▍      | 251/720 [05:33<10:21,  1.33s/it] 35%|███▌      | 252/720 [05:34<10:20,  1.32s/it] 35%|███▌      | 253/720 [05:35<10:18,  1.32s/it] 35%|███▌      | 254/720 [05:37<10:17,  1.32s/it] 35%|███▌      | 255/720 [05:38<10:16,  1.32s/it] 36%|███▌      | 256/720 [05:39<10:14,  1.32s/it] 36%|███▌      | 257/720 [05:41<10:13,  1.32s/it] 36%|███▌      | 258/720 [05:42<10:12,  1.32s/it] 36%|███▌      | 259/720 [05:43<10:10,  1.32s/it] 36%|███▌      | 260/720 [05:45<10:09,  1.32s/it] 36%|███▋      | 261/720 [05:46<10:08,  1.32s/it] 36%|███▋      | 262/720 [05:47<10:06,  1.33s/it] 37%|███▋      | 263/720 [05:49<10:05,  1.33s/it] 37%|███▋      | 264/720 [05:50<10:04,  1.33s/it] 37%|███▋      | 265/720 [05:51<10:03,  1.33s/it] 37%|███▋      | 266/720 [05:53<10:01,  1.33s/it] 37%|███▋      | 267/720 [05:54<10:00,  1.33s/it] 37%|███▋      | 268/720 [05:55<09:58,  1.33s/it] 37%|███▋      | 269/720 [05:57<09:57,  1.33s/it] 38%|███▊      | 270/720 [05:58<09:56,  1.33s/it] 38%|███▊      | 271/720 [05:59<09:54,  1.33s/it] 38%|███▊      | 272/720 [06:00<09:53,  1.32s/it] 38%|███▊      | 273/720 [06:02<09:52,  1.32s/it] 38%|███▊      | 274/720 [06:03<09:50,  1.32s/it] 38%|███▊      | 275/720 [06:04<09:49,  1.32s/it] 38%|███▊      | 276/720 [06:06<09:48,  1.33s/it] 38%|███▊      | 277/720 [06:07<09:47,  1.33s/it] 39%|███▊      | 278/720 [06:08<09:45,  1.33s/it] 39%|███▉      | 279/720 [06:10<09:44,  1.32s/it] 39%|███▉      | 280/720 [06:11<09:43,  1.33s/it] 39%|███▉      | 281/720 [06:12<09:41,  1.33s/it] 39%|███▉      | 282/720 [06:14<09:40,  1.33s/it] 39%|███▉      | 283/720 [06:15<09:39,  1.33s/it] 39%|███▉      | 284/720 [06:16<09:37,  1.33s/it] 40%|███▉      | 285/720 [06:18<09:36,  1.33s/it] 40%|███▉      | 286/720 [06:19<09:35,  1.33s/it] 40%|███▉      | 287/720 [06:20<09:33,  1.33s/it] 40%|████      | 288/720 [06:22<09:32,  1.33s/it] 40%|████      | 289/720 [06:23<09:31,  1.33s/it] 40%|████      | 290/720 [06:24<09:29,  1.33s/it] 40%|████      | 291/720 [06:26<09:28,  1.33s/it] 41%|████      | 292/720 [06:27<09:27,  1.33s/it] 41%|████      | 293/720 [06:28<09:26,  1.33s/it] 41%|████      | 294/720 [06:30<09:24,  1.33s/it] 41%|████      | 295/720 [06:31<09:23,  1.33s/it] 41%|████      | 296/720 [06:32<09:21,  1.33s/it] 41%|████▏     | 297/720 [06:34<09:20,  1.33s/it] 41%|████▏     | 298/720 [06:35<09:19,  1.33s/it] 42%|████▏     | 299/720 [06:36<09:17,  1.32s/it] 42%|████▏     | 300/720 [06:38<09:16,  1.32s/it]                                                  42%|████▏     | 300/720 [06:38<09:16,  1.32s/it] 42%|████▏     | 301/720 [06:39<09:15,  1.33s/it] 42%|████▏     | 302/720 [06:40<09:13,  1.33s/it] 42%|████▏     | 303/720 [06:42<09:12,  1.33s/it] 42%|████▏     | 304/720 [06:43<09:11,  1.33s/it] 42%|████▏     | 305/720 [06:44<09:09,  1.33s/it] 42%|████▎     | 306/720 [06:46<09:08,  1.33s/it] 43%|████▎     | 307/720 [06:47<09:08,  1.33s/it] 43%|████▎     | 308/720 [06:48<09:06,  1.33s/it] 43%|████▎     | 309/720 [06:50<09:05,  1.33s/it] 43%|████▎     | 310/720 [06:51<09:03,  1.33s/it] 43%|████▎     | 311/720 [06:52<09:02,  1.33s/it] 43%|████▎     | 312/720 [06:53<09:00,  1.33s/it] 43%|████▎     | 313/720 [06:55<08:59,  1.33s/it] 44%|████▎     | 314/720 [06:56<08:58,  1.33s/it] 44%|████▍     | 315/720 [06:57<08:56,  1.33s/it] 44%|████▍     | 316/720 [06:59<08:55,  1.33s/it] 44%|████▍     | 317/720 [07:00<08:54,  1.33s/it] 44%|████▍     | 318/720 [07:01<08:52,  1.33s/it] 44%|████▍     | 319/720 [07:03<08:51,  1.33s/it] 44%|████▍     | 320/720 [07:04<08:50,  1.33s/it] 45%|████▍     | 321/720 [07:05<08:48,  1.33s/it] 45%|████▍     | 322/720 [07:07<08:47,  1.33s/it] 45%|████▍     | 323/720 [07:08<08:46,  1.33s/it] 45%|████▌     | 324/720 [07:09<08:44,  1.33s/it] 45%|████▌     | 325/720 [07:11<08:43,  1.32s/it] 45%|████▌     | 326/720 [07:12<08:42,  1.32s/it] 45%|████▌     | 327/720 [07:13<08:40,  1.33s/it] 46%|████▌     | 328/720 [07:15<08:39,  1.32s/it] 46%|████▌     | 329/720 [07:16<08:38,  1.33s/it] 46%|████▌     | 330/720 [07:17<08:36,  1.33s/it] 46%|████▌     | 331/720 [07:19<08:35,  1.33s/it] 46%|████▌     | 332/720 [07:20<08:34,  1.33s/it] 46%|████▋     | 333/720 [07:21<08:32,  1.33s/it] 46%|████▋     | 334/720 [07:23<08:31,  1.33s/it] 47%|████▋     | 335/720 [07:24<08:30,  1.33s/it] 47%|████▋     | 336/720 [07:25<08:28,  1.32s/it] 47%|████▋     | 337/720 [07:27<08:27,  1.32s/it] 47%|████▋     | 338/720 [07:28<08:26,  1.32s/it] 47%|████▋     | 339/720 [07:29<08:24,  1.32s/it] 47%|████▋     | 340/720 [07:31<08:23,  1.33s/it] 47%|████▋     | 341/720 [07:32<08:22,  1.33s/it] 48%|████▊     | 342/720 [07:33<08:20,  1.32s/it] 48%|████▊     | 343/720 [07:35<08:19,  1.32s/it] 48%|████▊     | 344/720 [07:36<08:18,  1.32s/it] 48%|████▊     | 345/720 [07:37<08:16,  1.32s/it] 48%|████▊     | 346/720 [07:39<08:15,  1.32s/it] 48%|████▊     | 347/720 [07:40<08:14,  1.32s/it] 48%|████▊     | 348/720 [07:41<08:12,  1.32s/it] 48%|████▊     | 349/720 [07:43<08:11,  1.32s/it] 49%|████▊     | 350/720 [07:44<08:10,  1.32s/it] 49%|████▉     | 351/720 [07:45<08:08,  1.32s/it] 49%|████▉     | 352/720 [07:47<08:07,  1.32s/it] 49%|████▉     | 353/720 [07:48<08:06,  1.32s/it] 49%|████▉     | 354/720 [07:49<08:04,  1.33s/it] 49%|████▉     | 355/720 [07:50<08:03,  1.32s/it] 49%|████▉     | 356/720 [07:52<08:02,  1.32s/it] 50%|████▉     | 357/720 [07:53<08:00,  1.32s/it] 50%|████▉     | 358/720 [07:54<07:59,  1.32s/it] 50%|████▉     | 359/720 [07:56<07:58,  1.32s/it] 50%|█████     | 360/720 [07:57<07:57,  1.33s/it] 50%|█████     | 361/720 [07:58<07:55,  1.33s/it] 50%|█████     | 362/720 [08:00<07:54,  1.33s/it] 50%|█████     | 363/720 [08:01<07:53,  1.33s/it] 51%|█████     | 364/720 [08:02<07:51,  1.33s/it] 51%|█████     | 365/720 [08:04<07:50,  1.32s/it] 51%|█████     | 366/720 [08:05<07:49,  1.32s/it] 51%|█████     | 367/720 [08:06<07:47,  1.32s/it] 51%|█████     | 368/720 [08:08<07:46,  1.32s/it] 51%|█████▏    | 369/720 [08:09<07:45,  1.32s/it] 51%|█████▏    | 370/720 [08:10<07:43,  1.33s/it] 52%|█████▏    | 371/720 [08:12<07:42,  1.32s/it] 52%|█████▏    | 372/720 [08:13<07:41,  1.33s/it] 52%|█████▏    | 373/720 [08:14<07:39,  1.33s/it] 52%|█████▏    | 374/720 [08:16<07:38,  1.32s/it] 52%|█████▏    | 375/720 [08:17<07:37,  1.33s/it] 52%|█████▏    | 376/720 [08:18<07:36,  1.33s/it] 52%|█████▏    | 377/720 [08:20<07:34,  1.33s/it] 52%|█████▎    | 378/720 [08:21<07:33,  1.33s/it] 53%|█████▎    | 379/720 [08:22<07:31,  1.33s/it] 53%|█████▎    | 380/720 [08:24<07:30,  1.33s/it] 53%|█████▎    | 381/720 [08:25<07:29,  1.33s/it] 53%|█████▎    | 382/720 [08:26<07:27,  1.33s/it] 53%|█████▎    | 383/720 [08:28<07:26,  1.32s/it] 53%|█████▎    | 384/720 [08:29<07:25,  1.32s/it] 53%|█████▎    | 385/720 [08:30<07:23,  1.32s/it] 54%|█████▎    | 386/720 [08:32<07:22,  1.33s/it] 54%|█████▍    | 387/720 [08:33<07:21,  1.33s/it] 54%|█████▍    | 388/720 [08:34<07:19,  1.33s/it] 54%|█████▍    | 389/720 [08:36<07:18,  1.33s/it] 54%|█████▍    | 390/720 [08:37<07:17,  1.33s/it] 54%|█████▍    | 391/720 [08:38<07:16,  1.33s/it] 54%|█████▍    | 392/720 [08:40<07:14,  1.33s/it] 55%|█████▍    | 393/720 [08:41<07:13,  1.33s/it] 55%|█████▍    | 394/720 [08:42<07:12,  1.33s/it] 55%|█████▍    | 395/720 [08:43<07:10,  1.33s/it] 55%|█████▌    | 396/720 [08:45<07:09,  1.33s/it] 55%|█████▌    | 397/720 [08:46<07:07,  1.32s/it] 55%|█████▌    | 398/720 [08:47<07:06,  1.33s/it] 55%|█████▌    | 399/720 [08:49<07:05,  1.33s/it] 56%|█████▌    | 400/720 [08:50<07:04,  1.33s/it]                                                  56%|█████▌    | 400/720 [08:50<07:04,  1.33s/it] 56%|█████▌    | 401/720 [08:51<07:02,  1.33s/it] 56%|█████▌    | 402/720 [08:53<07:01,  1.33s/it] 56%|█████▌    | 403/720 [08:54<07:00,  1.33s/it] 56%|█████▌    | 404/720 [08:55<06:58,  1.33s/it] 56%|█████▋    | 405/720 [08:57<06:57,  1.33s/it] 56%|█████▋    | 406/720 [08:58<06:56,  1.33s/it] 57%|█████▋    | 407/720 [08:59<06:54,  1.33s/it] 57%|█████▋    | 408/720 [09:01<06:53,  1.33s/it] 57%|█████▋    | 409/720 [09:02<06:52,  1.33s/it] 57%|█████▋    | 410/720 [09:03<06:50,  1.33s/it] 57%|█████▋    | 411/720 [09:05<06:49,  1.33s/it] 57%|█████▋    | 412/720 [09:06<06:48,  1.33s/it] 57%|█████▋    | 413/720 [09:07<06:46,  1.32s/it] 57%|█████▊    | 414/720 [09:09<06:45,  1.33s/it] 58%|█████▊    | 415/720 [09:10<06:44,  1.33s/it] 58%|█████▊    | 416/720 [09:11<06:42,  1.33s/it] 58%|█████▊    | 417/720 [09:13<06:41,  1.33s/it] 58%|█████▊    | 418/720 [09:14<06:40,  1.33s/it] 58%|█████▊    | 419/720 [09:15<06:38,  1.33s/it] 58%|█████▊    | 420/720 [09:17<06:38,  1.33s/it] 58%|█████▊    | 421/720 [09:18<06:36,  1.33s/it] 59%|█████▊    | 422/720 [09:19<06:35,  1.33s/it] 59%|█████▉    | 423/720 [09:21<06:33,  1.33s/it] 59%|█████▉    | 424/720 [09:22<06:32,  1.33s/it] 59%|█████▉    | 425/720 [09:23<06:31,  1.33s/it] 59%|█████▉    | 426/720 [09:25<06:29,  1.33s/it] 59%|█████▉    | 427/720 [09:26<06:28,  1.33s/it] 59%|█████▉    | 428/720 [09:27<06:26,  1.33s/it] 60%|█████▉    | 429/720 [09:29<06:25,  1.33s/it] 60%|█████▉    | 430/720 [09:30<06:24,  1.33s/it] 60%|█████▉    | 431/720 [09:31<06:23,  1.33s/it] 60%|██████    | 432/720 [09:33<06:21,  1.33s/it] 60%|██████    | 433/720 [09:34<06:20,  1.33s/it] 60%|██████    | 434/720 [09:35<06:19,  1.33s/it] 60%|██████    | 435/720 [09:37<06:17,  1.33s/it] 61%|██████    | 436/720 [09:38<06:16,  1.33s/it] 61%|██████    | 437/720 [09:39<06:15,  1.33s/it] 61%|██████    | 438/720 [09:40<06:13,  1.33s/it] 61%|██████    | 439/720 [09:42<06:12,  1.33s/it] 61%|██████    | 440/720 [09:43<06:11,  1.33s/it] 61%|██████▏   | 441/720 [09:44<06:10,  1.33s/it] 61%|██████▏   | 442/720 [09:46<06:08,  1.33s/it] 62%|██████▏   | 443/720 [09:47<06:07,  1.33s/it] 62%|██████▏   | 444/720 [09:48<06:05,  1.33s/it] 62%|██████▏   | 445/720 [09:50<06:04,  1.33s/it] 62%|██████▏   | 446/720 [09:51<06:03,  1.33s/it] 62%|██████▏   | 447/720 [09:52<06:01,  1.33s/it] 62%|██████▏   | 448/720 [09:54<06:00,  1.33s/it] 62%|██████▏   | 449/720 [09:55<05:59,  1.33s/it] 62%|██████▎   | 450/720 [09:56<05:57,  1.33s/it] 63%|██████▎   | 451/720 [09:58<05:56,  1.33s/it] 63%|██████▎   | 452/720 [09:59<05:55,  1.33s/it] 63%|██████▎   | 453/720 [10:00<05:53,  1.33s/it] 63%|██████▎   | 454/720 [10:02<05:52,  1.33s/it] 63%|██████▎   | 455/720 [10:03<05:51,  1.33s/it] 63%|██████▎   | 456/720 [10:04<05:49,  1.33s/it] 63%|██████▎   | 457/720 [10:06<05:48,  1.33s/it] 64%|██████▎   | 458/720 [10:07<05:47,  1.33s/it] 64%|██████▍   | 459/720 [10:08<05:45,  1.33s/it] 64%|██████▍   | 460/720 [10:10<05:44,  1.33s/it] 64%|██████▍   | 461/720 [10:11<05:43,  1.33s/it] 64%|██████▍   | 462/720 [10:12<05:41,  1.33s/it] 64%|██████▍   | 463/720 [10:14<05:40,  1.33s/it] 64%|██████▍   | 464/720 [10:15<05:39,  1.33s/it] 65%|██████▍   | 465/720 [10:16<05:37,  1.33s/it] 65%|██████▍   | 466/720 [10:18<05:36,  1.33s/it] 65%|██████▍   | 467/720 [10:19<05:35,  1.33s/it] 65%|██████▌   | 468/720 [10:20<05:33,  1.33s/it] 65%|██████▌   | 469/720 [10:22<05:32,  1.32s/it] 65%|██████▌   | 470/720 [10:23<05:31,  1.33s/it] 65%|██████▌   | 471/720 [10:24<05:30,  1.33s/it] 66%|██████▌   | 472/720 [10:26<05:28,  1.33s/it] 66%|██████▌   | 473/720 [10:27<05:27,  1.33s/it] 66%|██████▌   | 474/720 [10:28<05:26,  1.33s/it] 66%|██████▌   | 475/720 [10:30<05:24,  1.33s/it] 66%|██████▌   | 476/720 [10:31<05:23,  1.33s/it] 66%|██████▋   | 477/720 [10:32<05:22,  1.33s/it] 66%|██████▋   | 478/720 [10:34<05:20,  1.33s/it] 67%|██████▋   | 479/720 [10:35<05:19,  1.33s/it] 67%|██████▋   | 480/720 [10:36<05:18,  1.33s/it] 67%|██████▋   | 481/720 [10:37<05:16,  1.33s/it] 67%|██████▋   | 482/720 [10:39<05:15,  1.33s/it] 67%|██████▋   | 483/720 [10:40<05:14,  1.33s/it] 67%|██████▋   | 484/720 [10:41<05:12,  1.33s/it] 67%|██████▋   | 485/720 [10:43<05:11,  1.33s/it] 68%|██████▊   | 486/720 [10:44<05:10,  1.33s/it] 68%|██████▊   | 487/720 [10:45<05:08,  1.33s/it] 68%|██████▊   | 488/720 [10:47<05:07,  1.33s/it] 68%|██████▊   | 489/720 [10:48<05:06,  1.33s/it] 68%|██████▊   | 490/720 [10:49<05:05,  1.33s/it] 68%|██████▊   | 491/720 [10:51<05:03,  1.33s/it] 68%|██████▊   | 492/720 [10:52<05:02,  1.33s/it] 68%|██████▊   | 493/720 [10:53<05:00,  1.33s/it] 69%|██████▊   | 494/720 [10:55<04:59,  1.33s/it] 69%|██████▉   | 495/720 [10:56<04:58,  1.33s/it] 69%|██████▉   | 496/720 [10:57<04:56,  1.33s/it] 69%|██████▉   | 497/720 [10:59<04:55,  1.33s/it] 69%|██████▉   | 498/720 [11:00<04:54,  1.33s/it] 69%|██████▉   | 499/720 [11:01<04:52,  1.33s/it] 69%|██████▉   | 500/720 [11:03<04:51,  1.33s/it]                                                  69%|██████▉   | 500/720 [11:03<04:51,  1.33s/it] 70%|██████▉   | 501/720 [11:04<04:50,  1.33s/it] 70%|██████▉   | 502/720 [11:05<04:48,  1.33s/it] 70%|██████▉   | 503/720 [11:07<04:47,  1.33s/it] 70%|███████   | 504/720 [11:08<04:46,  1.33s/it] 70%|███████   | 505/720 [11:09<04:44,  1.33s/it] 70%|███████   | 506/720 [11:11<04:43,  1.33s/it] 70%|███████   | 507/720 [11:12<04:42,  1.33s/it] 71%|███████   | 508/720 [11:13<04:40,  1.32s/it] 71%|███████   | 509/720 [11:15<04:39,  1.32s/it] 71%|███████   | 510/720 [11:16<04:38,  1.32s/it] 71%|███████   | 511/720 [11:17<04:36,  1.32s/it] 71%|███████   | 512/720 [11:19<04:35,  1.32s/it] 71%|███████▏  | 513/720 [11:20<04:34,  1.33s/it] 71%|███████▏  | 514/720 [11:21<04:32,  1.33s/it] 72%|███████▏  | 515/720 [11:23<04:31,  1.33s/it] 72%|███████▏  | 516/720 [11:24<04:30,  1.33s/it] 72%|███████▏  | 517/720 [11:25<04:28,  1.33s/it] 72%|███████▏  | 518/720 [11:27<04:27,  1.32s/it] 72%|███████▏  | 519/720 [11:28<04:26,  1.32s/it] 72%|███████▏  | 520/720 [11:29<04:24,  1.32s/it] 72%|███████▏  | 521/720 [11:30<04:23,  1.32s/it] 72%|███████▎  | 522/720 [11:32<04:22,  1.32s/it] 73%|███████▎  | 523/720 [11:33<04:20,  1.32s/it] 73%|███████▎  | 524/720 [11:34<04:19,  1.33s/it] 73%|███████▎  | 525/720 [11:36<04:18,  1.33s/it] 73%|███████▎  | 526/720 [11:37<04:17,  1.33s/it] 73%|███████▎  | 527/720 [11:38<04:15,  1.33s/it] 73%|███████▎  | 528/720 [11:40<04:14,  1.33s/it] 73%|███████▎  | 529/720 [11:41<04:13,  1.33s/it] 74%|███████▎  | 530/720 [11:42<04:11,  1.33s/it] 74%|███████▍  | 531/720 [11:44<04:10,  1.32s/it] 74%|███████▍  | 532/720 [11:45<04:09,  1.32s/it] 74%|███████▍  | 533/720 [11:46<04:07,  1.32s/it] 74%|███████▍  | 534/720 [11:48<04:06,  1.32s/it] 74%|███████▍  | 535/720 [11:49<04:05,  1.33s/it] 74%|███████▍  | 536/720 [11:50<04:03,  1.33s/it] 75%|███████▍  | 537/720 [11:52<04:02,  1.33s/it] 75%|███████▍  | 538/720 [11:53<04:01,  1.33s/it] 75%|███████▍  | 539/720 [11:54<03:59,  1.33s/it] 75%|███████▌  | 540/720 [11:56<03:58,  1.32s/it] 75%|███████▌  | 541/720 [11:57<03:57,  1.32s/it] 75%|███████▌  | 542/720 [11:58<03:55,  1.32s/it] 75%|███████▌  | 543/720 [12:00<03:54,  1.33s/it] 76%|███████▌  | 544/720 [12:01<03:53,  1.33s/it] 76%|███████▌  | 545/720 [12:02<03:51,  1.33s/it] 76%|███████▌  | 546/720 [12:04<03:50,  1.32s/it] 76%|███████▌  | 547/720 [12:05<03:49,  1.33s/it] 76%|███████▌  | 548/720 [12:06<03:47,  1.33s/it] 76%|███████▋  | 549/720 [12:08<03:46,  1.33s/it] 76%|███████▋  | 550/720 [12:09<03:45,  1.33s/it] 77%|███████▋  | 551/720 [12:10<03:44,  1.33s/it] 77%|███████▋  | 552/720 [12:12<03:42,  1.33s/it] 77%|███████▋  | 553/720 [12:13<03:41,  1.33s/it] 77%|███████▋  | 554/720 [12:14<03:40,  1.33s/it] 77%|███████▋  | 555/720 [12:16<03:38,  1.33s/it] 77%|███████▋  | 556/720 [12:17<03:37,  1.33s/it] 77%|███████▋  | 557/720 [12:18<03:36,  1.33s/it] 78%|███████▊  | 558/720 [12:20<03:34,  1.33s/it] 78%|███████▊  | 559/720 [12:21<03:33,  1.33s/it] 78%|███████▊  | 560/720 [12:22<03:32,  1.33s/it] 78%|███████▊  | 561/720 [12:24<03:30,  1.33s/it] 78%|███████▊  | 562/720 [12:25<03:29,  1.33s/it] 78%|███████▊  | 563/720 [12:26<03:28,  1.33s/it] 78%|███████▊  | 564/720 [12:27<03:26,  1.33s/it] 78%|███████▊  | 565/720 [12:29<03:25,  1.33s/it] 79%|███████▊  | 566/720 [12:30<03:24,  1.33s/it] 79%|███████▉  | 567/720 [12:31<03:22,  1.33s/it] 79%|███████▉  | 568/720 [12:33<03:21,  1.33s/it] 79%|███████▉  | 569/720 [12:34<03:31,  1.40s/it] 79%|███████▉  | 570/720 [12:36<03:26,  1.38s/it] 79%|███████▉  | 571/720 [12:37<03:22,  1.36s/it] 79%|███████▉  | 572/720 [12:38<03:19,  1.35s/it] 80%|███████▉  | 573/720 [12:40<03:17,  1.34s/it] 80%|███████▉  | 574/720 [12:41<03:15,  1.34s/it] 80%|███████▉  | 575/720 [12:42<03:13,  1.33s/it] 80%|████████  | 576/720 [12:44<03:11,  1.33s/it] 80%|████████  | 577/720 [12:45<03:10,  1.33s/it] 80%|████████  | 578/720 [12:46<03:08,  1.33s/it] 80%|████████  | 579/720 [12:48<03:07,  1.33s/it] 81%|████████  | 580/720 [12:49<03:05,  1.33s/it] 81%|████████  | 581/720 [12:50<03:04,  1.33s/it] 81%|████████  | 582/720 [12:52<03:02,  1.33s/it] 81%|████████  | 583/720 [12:53<03:01,  1.33s/it] 81%|████████  | 584/720 [12:54<03:00,  1.33s/it] 81%|████████▏ | 585/720 [12:56<02:58,  1.33s/it] 81%|████████▏ | 586/720 [12:57<02:57,  1.33s/it] 82%|████████▏ | 587/720 [12:58<02:56,  1.33s/it] 82%|████████▏ | 588/720 [13:00<02:54,  1.33s/it] 82%|████████▏ | 589/720 [13:01<02:53,  1.33s/it] 82%|████████▏ | 590/720 [13:02<02:52,  1.33s/it] 82%|████████▏ | 591/720 [13:04<02:50,  1.33s/it] 82%|████████▏ | 592/720 [13:05<02:49,  1.33s/it] 82%|████████▏ | 593/720 [13:06<02:48,  1.33s/it] 82%|████████▎ | 594/720 [13:07<02:46,  1.33s/it] 83%|████████▎ | 595/720 [13:09<02:45,  1.33s/it] 83%|████████▎ | 596/720 [13:10<02:44,  1.33s/it] 83%|████████▎ | 597/720 [13:11<02:43,  1.33s/it] 83%|████████▎ | 598/720 [13:13<02:41,  1.33s/it] 83%|████████▎ | 599/720 [13:14<02:40,  1.33s/it] 83%|████████▎ | 600/720 [13:15<02:39,  1.33s/it]                                                  83%|████████▎ | 600/720 [13:15<02:39,  1.33s/it] 83%|████████▎ | 601/720 [13:17<02:38,  1.33s/it] 84%|████████▎ | 602/720 [13:18<02:36,  1.33s/it] 84%|████████▍ | 603/720 [13:19<02:35,  1.33s/it] 84%|████████▍ | 604/720 [13:21<02:33,  1.33s/it] 84%|████████▍ | 605/720 [13:22<02:32,  1.33s/it] 84%|████████▍ | 606/720 [13:23<02:31,  1.33s/it] 84%|████████▍ | 607/720 [13:25<02:29,  1.33s/it] 84%|████████▍ | 608/720 [13:26<02:28,  1.33s/it] 85%|████████▍ | 609/720 [13:27<02:27,  1.33s/it] 85%|████████▍ | 610/720 [13:29<02:25,  1.33s/it] 85%|████████▍ | 611/720 [13:30<02:24,  1.33s/it] 85%|████████▌ | 612/720 [13:31<02:23,  1.33s/it] 85%|████████▌ | 613/720 [13:33<02:21,  1.33s/it] 85%|████████▌ | 614/720 [13:34<02:20,  1.33s/it] 85%|████████▌ | 615/720 [13:35<02:19,  1.33s/it] 86%|████████▌ | 616/720 [13:37<02:17,  1.33s/it] 86%|████████▌ | 617/720 [13:38<02:16,  1.32s/it] 86%|████████▌ | 618/720 [13:39<02:15,  1.32s/it] 86%|████████▌ | 619/720 [13:41<02:13,  1.32s/it] 86%|████████▌ | 620/720 [13:42<02:12,  1.32s/it] 86%|████████▋ | 621/720 [13:43<02:11,  1.32s/it] 86%|████████▋ | 622/720 [13:45<02:09,  1.33s/it] 87%|████████▋ | 623/720 [13:46<02:08,  1.33s/it] 87%|████████▋ | 624/720 [13:47<02:07,  1.33s/it] 87%|████████▋ | 625/720 [13:49<02:05,  1.33s/it] 87%|████████▋ | 626/720 [13:50<02:04,  1.33s/it] 87%|████████▋ | 627/720 [13:51<02:03,  1.33s/it] 87%|████████▋ | 628/720 [13:53<02:01,  1.33s/it] 87%|████████▋ | 629/720 [13:54<02:00,  1.33s/it] 88%|████████▊ | 630/720 [13:55<01:59,  1.33s/it] 88%|████████▊ | 631/720 [13:57<01:57,  1.33s/it] 88%|████████▊ | 632/720 [13:58<01:56,  1.33s/it] 88%|████████▊ | 633/720 [13:59<01:55,  1.33s/it] 88%|████████▊ | 634/720 [14:01<01:53,  1.33s/it] 88%|████████▊ | 635/720 [14:02<01:52,  1.33s/it] 88%|████████▊ | 636/720 [14:03<01:51,  1.33s/it] 88%|████████▊ | 637/720 [14:04<01:49,  1.33s/it] 89%|████████▊ | 638/720 [14:06<01:48,  1.33s/it] 89%|████████▉ | 639/720 [14:07<01:47,  1.33s/it] 89%|████████▉ | 640/720 [14:08<01:46,  1.33s/it] 89%|████████▉ | 641/720 [14:10<01:44,  1.33s/it] 89%|████████▉ | 642/720 [14:11<01:43,  1.33s/it] 89%|████████▉ | 643/720 [14:12<01:42,  1.33s/it] 89%|████████▉ | 644/720 [14:14<01:40,  1.33s/it] 90%|████████▉ | 645/720 [14:15<01:39,  1.33s/it] 90%|████████▉ | 646/720 [14:16<01:38,  1.33s/it] 90%|████████▉ | 647/720 [14:18<01:36,  1.33s/it] 90%|█████████ | 648/720 [14:19<01:35,  1.33s/it] 90%|█████████ | 649/720 [14:20<01:34,  1.33s/it] 90%|█████████ | 650/720 [14:22<01:32,  1.32s/it] 90%|█████████ | 651/720 [14:23<01:31,  1.33s/it] 91%|█████████ | 652/720 [14:24<01:30,  1.32s/it] 91%|█████████ | 653/720 [14:26<01:28,  1.33s/it] 91%|█████████ | 654/720 [14:27<01:27,  1.33s/it] 91%|█████████ | 655/720 [14:28<01:26,  1.33s/it] 91%|█████████ | 656/720 [14:30<01:24,  1.33s/it] 91%|█████████▏| 657/720 [14:31<01:23,  1.33s/it] 91%|█████████▏| 658/720 [14:32<01:22,  1.33s/it] 92%|█████████▏| 659/720 [14:34<01:20,  1.33s/it] 92%|█████████▏| 660/720 [14:35<01:19,  1.33s/it] 92%|█████████▏| 661/720 [14:36<01:18,  1.33s/it] 92%|█████████▏| 662/720 [14:38<01:16,  1.33s/it] 92%|█████████▏| 663/720 [14:39<01:15,  1.33s/it] 92%|█████████▏| 664/720 [14:40<01:14,  1.33s/it] 92%|█████████▏| 665/720 [14:42<01:12,  1.33s/it] 92%|█████████▎| 666/720 [14:43<01:11,  1.33s/it] 93%|█████████▎| 667/720 [14:44<01:10,  1.33s/it] 93%|█████████▎| 668/720 [14:46<01:08,  1.33s/it] 93%|█████████▎| 669/720 [14:47<01:07,  1.33s/it] 93%|█████████▎| 670/720 [14:48<01:06,  1.33s/it] 93%|█████████▎| 671/720 [14:50<01:04,  1.33s/it] 93%|█████████▎| 672/720 [14:51<01:03,  1.33s/it] 93%|█████████▎| 673/720 [14:52<01:02,  1.33s/it] 94%|█████████▎| 674/720 [14:54<01:00,  1.33s/it] 94%|█████████▍| 675/720 [14:55<00:59,  1.33s/it] 94%|█████████▍| 676/720 [14:56<00:58,  1.33s/it] 94%|█████████▍| 677/720 [14:58<00:56,  1.33s/it] 94%|█████████▍| 678/720 [14:59<00:55,  1.33s/it] 94%|█████████▍| 679/720 [15:00<00:54,  1.33s/it] 94%|█████████▍| 680/720 [15:01<00:53,  1.33s/it] 95%|█████████▍| 681/720 [15:03<00:51,  1.33s/it] 95%|█████████▍| 682/720 [15:04<00:50,  1.33s/it] 95%|█████████▍| 683/720 [15:05<00:49,  1.33s/it] 95%|█████████▌| 684/720 [15:07<00:47,  1.33s/it] 95%|█████████▌| 685/720 [15:08<00:46,  1.33s/it] 95%|█████████▌| 686/720 [15:09<00:45,  1.33s/it] 95%|█████████▌| 687/720 [15:11<00:43,  1.32s/it] 96%|█████████▌| 688/720 [15:12<00:42,  1.33s/it] 96%|█████████▌| 689/720 [15:13<00:41,  1.33s/it] 96%|█████████▌| 690/720 [15:15<00:39,  1.33s/it] 96%|█████████▌| 691/720 [15:16<00:38,  1.33s/it] 96%|█████████▌| 692/720 [15:17<00:37,  1.33s/it] 96%|█████████▋| 693/720 [15:19<00:35,  1.33s/it] 96%|█████████▋| 694/720 [15:20<00:34,  1.33s/it] 97%|█████████▋| 695/720 [15:21<00:33,  1.33s/it] 97%|█████████▋| 696/720 [15:23<00:31,  1.33s/it] 97%|█████████▋| 697/720 [15:24<00:30,  1.33s/it] 97%|█████████▋| 698/720 [15:25<00:29,  1.33s/it] 97%|█████████▋| 699/720 [15:27<00:27,  1.33s/it] 97%|█████████▋| 700/720 [15:28<00:26,  1.33s/it]                                                  97%|█████████▋| 700/720 [15:28<00:26,  1.33s/it] 97%|█████████▋| 701/720 [15:29<00:25,  1.33s/it] 98%|█████████▊| 702/720 [15:31<00:23,  1.33s/it] 98%|█████████▊| 703/720 [15:32<00:22,  1.33s/it] 98%|█████████▊| 704/720 [15:33<00:21,  1.33s/it] 98%|█████████▊| 705/720 [15:35<00:19,  1.32s/it] 98%|█████████▊| 706/720 [15:36<00:18,  1.32s/it] 98%|█████████▊| 707/720 [15:37<00:17,  1.32s/it] 98%|█████████▊| 708/720 [15:39<00:15,  1.32s/it] 98%|█████████▊| 709/720 [15:40<00:14,  1.32s/it] 99%|█████████▊| 710/720 [15:41<00:13,  1.32s/it] 99%|█████████▉| 711/720 [15:43<00:11,  1.32s/it] 99%|█████████▉| 712/720 [15:44<00:10,  1.32s/it] 99%|█████████▉| 713/720 [15:45<00:09,  1.32s/it] 99%|█████████▉| 714/720 [15:47<00:07,  1.32s/it] 99%|█████████▉| 715/720 [15:48<00:06,  1.32s/it] 99%|█████████▉| 716/720 [15:49<00:05,  1.32s/it]100%|█████████▉| 717/720 [15:51<00:03,  1.32s/it]100%|█████████▉| 718/720 [15:52<00:02,  1.33s/it]100%|█████████▉| 719/720 [15:53<00:01,  1.33s/it]100%|██████████| 720/720 [15:54<00:00,  1.32s/it]/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x147c7244c3d0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 1b113beb-d0a6-4122-8728-7853d4c206b0)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                 100%|██████████| 720/720 [15:55<00:00,  1.32s/it]100%|██████████| 720/720 [15:55<00:00,  1.33s/it]
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /meta-llama/Llama-3.2-3B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x147c70c5bcd0>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 219aa485-5ae9-42f3-b184-62f3cc69469c)') - silently ignoring the lookup for the file config.json in meta-llama/Llama-3.2-3B-Instruct.
  warnings.warn(
/home/janeec/.conda/envs/FairTune/lib/python3.10/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in meta-llama/Llama-3.2-3B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
{'loss': 2.5183, 'grad_norm': 2.9308841228485107, 'learning_rate': 1.7222222222222224e-05, 'epoch': 0.14}
{'loss': 0.6509, 'grad_norm': 2.612095594406128, 'learning_rate': 1.4444444444444446e-05, 'epoch': 0.28}
{'loss': 0.3775, 'grad_norm': 2.448314666748047, 'learning_rate': 1.1666666666666668e-05, 'epoch': 0.42}
{'loss': 0.3486, 'grad_norm': 3.7729647159576416, 'learning_rate': 8.888888888888888e-06, 'epoch': 0.56}
{'loss': 0.3331, 'grad_norm': 2.961839437484741, 'learning_rate': 6.111111111111112e-06, 'epoch': 0.69}
{'loss': 0.3224, 'grad_norm': 2.256385564804077, 'learning_rate': 3.3333333333333333e-06, 'epoch': 0.83}
{'loss': 0.3201, 'grad_norm': 2.362758159637451, 'learning_rate': 5.555555555555555e-07, 'epoch': 0.97}
{'train_runtime': 955.1927, 'train_samples_per_second': 3.015, 'train_steps_per_second': 0.754, 'train_loss': 0.6853096922238667, 'epoch': 1.0}
Saving model to ../../../scratch/gpfs/janeec/FairTune/finetuned_models/no_bias_true_prop_var/meta-llama/Llama-3.2-3B-Instruct_60
Fine-tuning completed successfully!
end finetuning 60
start evaling: seed  60
2025-05-01 18:54:50.144451: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 18:54:50.159292: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746140090.174896  325294 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746140090.179707  325294 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746140090.192770  325294 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746140090.192794  325294 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746140090.192796  325294 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746140090.192798  325294 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 18:54:50.196882: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.09s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  7.73s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  7.03s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Model type: llama
Tokenizer type: PreTrainedTokenizerFast
CWD at runtime: /home/janeec/FairTune
Loading from FTing on: no_bias_constant_var_prop_rep
Model loaded.
Collecting responses:
Generating sample 1/1
Sample 1:   0%|          | 0/45 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   2%|▏         | 1/45 [00:21<15:35, 21.26s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   4%|▍         | 2/45 [00:42<15:09, 21.14s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   7%|▋         | 3/45 [01:03<14:41, 20.99s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   9%|▉         | 4/45 [01:23<14:16, 20.89s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  11%|█         | 5/45 [01:44<13:58, 20.95s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  13%|█▎        | 6/45 [02:05<13:35, 20.90s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  16%|█▌        | 7/45 [02:26<13:12, 20.87s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  18%|█▊        | 8/45 [02:47<12:50, 20.83s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  20%|██        | 9/45 [03:07<12:28, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  22%|██▏       | 10/45 [03:28<12:07, 20.80s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  24%|██▍       | 11/45 [03:49<11:46, 20.78s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  27%|██▋       | 12/45 [04:09<11:22, 20.68s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  29%|██▉       | 13/45 [04:30<11:02, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  31%|███       | 14/45 [04:51<10:42, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  33%|███▎      | 15/45 [05:11<10:19, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  36%|███▌      | 16/45 [05:32<09:58, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  38%|███▊      | 17/45 [05:53<09:38, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  40%|████      | 18/45 [06:13<09:17, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  42%|████▏     | 19/45 [06:34<08:55, 20.60s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  44%|████▍     | 20/45 [06:55<08:35, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  47%|████▋     | 21/45 [07:15<08:15, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  49%|████▉     | 22/45 [07:36<07:54, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  51%|█████     | 23/45 [07:57<07:33, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  53%|█████▎    | 24/45 [08:17<07:13, 20.64s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  56%|█████▌    | 25/45 [08:38<06:53, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  58%|█████▊    | 26/45 [08:58<06:32, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  60%|██████    | 27/45 [09:19<06:10, 20.60s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  62%|██████▏   | 28/45 [09:40<05:50, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  64%|██████▍   | 29/45 [10:00<05:30, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  67%|██████▋   | 30/45 [10:21<05:08, 20.58s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  69%|██████▉   | 31/45 [10:41<04:48, 20.62s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  71%|███████   | 32/45 [11:02<04:29, 20.72s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  73%|███████▎  | 33/45 [11:23<04:08, 20.71s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  76%|███████▌  | 34/45 [11:44<03:47, 20.69s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  78%|███████▊  | 35/45 [12:05<03:27, 20.77s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  80%|████████  | 36/45 [12:25<03:06, 20.75s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  82%|████████▏ | 37/45 [12:46<02:45, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  84%|████████▍ | 38/45 [13:07<02:25, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  87%|████████▋ | 39/45 [13:28<02:04, 20.73s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  89%|████████▉ | 40/45 [13:48<01:43, 20.75s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  91%|█████████ | 41/45 [14:09<01:22, 20.74s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  93%|█████████▎| 42/45 [14:30<01:01, 20.66s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  96%|█████████▌| 43/45 [14:50<00:41, 20.70s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  98%|█████████▊| 44/45 [15:11<00:20, 20.70s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.63s/it]Sample 1: 100%|██████████| 45/45 [15:32<00:00, 20.71s/it]
  scenario  ... prompt_id
0   hiring  ...         1
1   hiring  ...         1
2   hiring  ...         1
3   hiring  ...         1
4   hiring  ...         1

[5 rows x 9 columns]
Responses saved to: results/no_bias_constant_var_prop_rep/Llama-3.2-3B-Instruct_salinas_expanded_context_60.csv
2025-05-01 19:10:49.377175: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-01 19:10:49.392672: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746141049.409039  327816 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746141049.414092  327816 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1746141049.427596  327816 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746141049.427617  327816 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746141049.427619  327816 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1746141049.427624  327816 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-05-01 19:10:49.431766: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading model: meta-llama/Llama-3.2-3B-Instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.80s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.99s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Model type: llama
Tokenizer type: PreTrainedTokenizerFast
CWD at runtime: /home/janeec/FairTune
Loading from FTing on: no_bias_prop_var_prop_rep
Model loaded.
Collecting responses:
Generating sample 1/1
Sample 1:   0%|          | 0/45 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   2%|▏         | 1/45 [00:21<15:33, 21.22s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   4%|▍         | 2/45 [00:42<15:08, 21.13s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   7%|▋         | 3/45 [01:03<14:40, 20.98s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:   9%|▉         | 4/45 [01:23<14:16, 20.88s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  11%|█         | 5/45 [01:44<13:57, 20.94s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  13%|█▎        | 6/45 [02:05<13:34, 20.89s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  16%|█▌        | 7/45 [02:26<13:12, 20.86s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  18%|█▊        | 8/45 [02:47<12:50, 20.82s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  20%|██        | 9/45 [03:07<12:28, 20.79s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  22%|██▏       | 10/45 [03:28<12:07, 20.79s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  24%|██▍       | 11/45 [03:49<11:46, 20.77s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  27%|██▋       | 12/45 [04:09<11:22, 20.67s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  29%|██▉       | 13/45 [04:30<11:02, 20.71s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  31%|███       | 14/45 [04:51<10:42, 20.71s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  33%|███▎      | 15/45 [05:11<10:18, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  36%|███▌      | 16/45 [05:32<09:58, 20.63s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  38%|███▊      | 17/45 [05:53<09:38, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  40%|████      | 18/45 [06:13<09:17, 20.65s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Sample 1:  42%|████▏     | 19/45 [06:34<08:55, 20.60s/it]Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
